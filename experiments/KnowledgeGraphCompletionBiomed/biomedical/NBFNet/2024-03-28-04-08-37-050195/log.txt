04:08:37   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-28-04-08-37-050195
04:08:37   Input Seed: 1238
04:08:37   Set Seed: 1238
04:08:37   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_020_09.yaml
04:08:37   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
04:08:37   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 416172
)
04:08:37   #train: 9617, #valid: 3447, #test: 6887
04:08:37   Preprocess training set
04:08:38   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(409285, 416172)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(396221, 405838)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(405838, 409285)}}
04:08:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:08:38   Epoch 0 begin
04:08:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:08:41   binary cross entropy: 0.70762
04:11:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:29   binary cross entropy: 0.620691
04:12:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:12:53   Epoch 0 end
04:12:53   duration: 4.25 mins
04:12:53   speed: 0.59 batch / sec
04:12:53   ETA: 4.25 mins
04:12:53   max GPU memory: 47436.2 MiB
04:12:53   ------------------------------
04:12:53   average binary cross entropy: 0.581822
04:12:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:12:53   Epoch 1 begin
04:14:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:14:18   binary cross entropy: 0.589115
04:17:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:06   binary cross entropy: 0.582165
04:17:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:07   Epoch 1 end
04:17:07   duration: 4.23 mins
04:17:07   speed: 0.59 batch / sec
04:17:07   ETA: 0.00 secs
04:17:07   max GPU memory: 47436.2 MiB
04:17:07   ------------------------------
04:17:07   average binary cross entropy: 0.538987
04:17:07   Save checkpoint to model_epoch_2.pth
04:17:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:07   Evaluate on valid
04:17:53   ------------------------------
04:17:53   ap: 0.984164
04:17:53   auroc: 0.978992
04:17:53   hits@1: 0.252248
04:17:53   hits@10: 0.443139
04:17:53   hits@100: 0.631564
04:17:53   hits@20: 0.499855
04:17:53   hits@3: 0.340151
04:17:53   hits@50: 0.576733
04:17:53   mr: 812.937
04:17:53   mrr: 0.316195
04:17:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:17:53   Epoch 2 begin
04:20:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:20:41   binary cross entropy: 0.564807
04:22:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:22:08   Epoch 2 end
04:22:08   duration: 5.01 mins
04:22:08   speed: 0.50 batch / sec
04:22:08   ETA: 5.01 mins
04:22:08   max GPU memory: 47458.5 MiB
04:22:08   ------------------------------
04:22:08   average binary cross entropy: 0.527382
04:22:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:22:08   Epoch 3 begin
04:23:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:23:29   binary cross entropy: 0.556689
04:26:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:26:19   binary cross entropy: 0.543367
04:26:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:26:23   Epoch 3 end
04:26:23   duration: 4.25 mins
04:26:23   speed: 0.59 batch / sec
04:26:23   ETA: 0.00 secs
04:26:23   max GPU memory: 47458.5 MiB
04:26:23   ------------------------------
04:26:23   average binary cross entropy: 0.520962
04:26:23   Save checkpoint to model_epoch_4.pth
04:26:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:26:23   Evaluate on valid
04:27:09   ------------------------------
04:27:09   ap: 0.982163
04:27:09   auroc: 0.973334
04:27:09   hits@1: 0.272701
04:27:09   hits@10: 0.45924
04:27:09   hits@100: 0.642733
04:27:09   hits@20: 0.515956
04:27:09   hits@3: 0.3519
04:27:09   hits@50: 0.591674
04:27:09   mr: 765.608
04:27:09   mrr: 0.333713
04:27:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:27:09   Epoch 4 begin
04:29:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:29:53   binary cross entropy: 0.533418
04:31:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:31:24   Epoch 4 end
04:31:24   duration: 5.02 mins
04:31:24   speed: 0.50 batch / sec
04:31:24   ETA: 5.02 mins
04:31:24   max GPU memory: 47458.5 MiB
04:31:24   ------------------------------
04:31:24   average binary cross entropy: 0.525965
04:31:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:31:24   Epoch 5 begin
04:32:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:32:43   binary cross entropy: 0.5086
04:35:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:35:32   binary cross entropy: 0.535865
04:35:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:35:40   Epoch 5 end
04:35:40   duration: 4.26 mins
04:35:40   speed: 0.59 batch / sec
04:35:40   ETA: 0.00 secs
04:35:40   max GPU memory: 47458.5 MiB
04:35:40   ------------------------------
04:35:40   average binary cross entropy: 0.512792
04:35:40   Save checkpoint to model_epoch_6.pth
04:35:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:35:40   Evaluate on valid
04:36:25   ------------------------------
04:36:25   ap: 0.975299
04:36:25   auroc: 0.962524
04:36:25   hits@1: 0.279954
04:36:25   hits@10: 0.45895
04:36:25   hits@100: 0.644038
04:36:25   hits@20: 0.514215
04:36:25   hits@3: 0.361329
04:36:25   hits@50: 0.586597
04:36:25   mr: 759.221
04:36:25   mrr: 0.340029
04:36:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:36:25   Epoch 6 begin
04:39:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:39:06   binary cross entropy: 0.568697
04:40:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:40:40   Epoch 6 end
04:40:40   duration: 5.01 mins
04:40:40   speed: 0.50 batch / sec
04:40:40   ETA: 5.01 mins
04:40:40   max GPU memory: 47458.5 MiB
04:40:40   ------------------------------
04:40:40   average binary cross entropy: 0.512463
04:40:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:40:40   Epoch 7 begin
04:41:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:41:55   binary cross entropy: 0.569547
04:44:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:44:45   binary cross entropy: 0.450513
04:44:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:44:55   Epoch 7 end
04:44:55   duration: 4.25 mins
04:44:55   speed: 0.59 batch / sec
04:44:55   ETA: 0.00 secs
04:44:55   max GPU memory: 47458.5 MiB
04:44:55   ------------------------------
04:44:55   average binary cross entropy: 0.510025
04:44:55   Save checkpoint to model_epoch_8.pth
04:44:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:44:55   Evaluate on valid
04:45:41   ------------------------------
04:45:41   ap: 0.975414
04:45:41   auroc: 0.963921
04:45:41   hits@1: 0.288947
04:45:41   hits@10: 0.459965
04:45:41   hits@100: 0.64868
04:45:41   hits@20: 0.514215
04:45:41   hits@3: 0.36365
04:45:41   hits@50: 0.588483
04:45:41   mr: 752.997
04:45:41   mrr: 0.346396
04:45:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:45:41   Epoch 8 begin
04:48:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:48:19   binary cross entropy: 0.436047
04:49:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:49:56   Epoch 8 end
04:49:56   duration: 5.01 mins
04:49:56   speed: 0.50 batch / sec
04:49:56   ETA: 5.01 mins
04:49:56   max GPU memory: 47458.5 MiB
04:49:56   ------------------------------
04:49:56   average binary cross entropy: 0.509858
04:49:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:49:56   Epoch 9 begin
04:51:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:51:08   binary cross entropy: 0.465048
04:53:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:53:57   binary cross entropy: 0.557521
04:54:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:54:11   Epoch 9 end
04:54:11   duration: 4.25 mins
04:54:11   speed: 0.59 batch / sec
04:54:11   ETA: 0.00 secs
04:54:11   max GPU memory: 47458.5 MiB
04:54:11   ------------------------------
04:54:11   average binary cross entropy: 0.50729
04:54:11   Save checkpoint to model_epoch_10.pth
04:54:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:54:11   Evaluate on valid
04:54:57   ------------------------------
04:54:57   ap: 0.951492
04:54:57   auroc: 0.927051
04:54:57   hits@1: 0.302292
04:54:57   hits@10: 0.467073
04:54:57   hits@100: 0.6481
04:54:57   hits@20: 0.518567
04:54:57   hits@3: 0.373658
04:54:57   hits@50: 0.59385
04:54:57   mr: 763.104
04:54:57   mrr: 0.35671
04:54:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:54:57   Epoch 10 begin
04:57:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:57:31   binary cross entropy: 0.606435
04:59:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:59:12   Epoch 10 end
04:59:12   duration: 5.01 mins
04:59:12   speed: 0.50 batch / sec
04:59:12   ETA: 5.01 mins
04:59:12   max GPU memory: 47458.5 MiB
04:59:12   ------------------------------
04:59:12   average binary cross entropy: 0.508733
04:59:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:59:12   Epoch 11 begin
05:00:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:00:20   binary cross entropy: 0.538007
05:03:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:03:09   binary cross entropy: 0.443947
05:03:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:03:27   Epoch 11 end
05:03:27   duration: 4.25 mins
05:03:27   speed: 0.59 batch / sec
05:03:27   ETA: 0.00 secs
05:03:27   max GPU memory: 47458.5 MiB
05:03:27   ------------------------------
05:03:27   average binary cross entropy: 0.502399
05:03:27   Save checkpoint to model_epoch_12.pth
05:03:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:03:27   Evaluate on valid
05:04:13   ------------------------------
05:04:13   ap: 0.975925
05:04:13   auroc: 0.965702
05:04:13   hits@1: 0.293008
05:04:13   hits@10: 0.461416
05:04:13   hits@100: 0.651436
05:04:13   hits@20: 0.518132
05:04:13   hits@3: 0.364955
05:04:13   hits@50: 0.592254
05:04:13   mr: 731.357
05:04:13   mrr: 0.348817
05:04:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:04:13   Epoch 12 begin
05:06:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:06:44   binary cross entropy: 0.500807
05:08:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:08:28   Epoch 12 end
05:08:28   duration: 5.01 mins
05:08:28   speed: 0.50 batch / sec
05:08:28   ETA: 5.01 mins
05:08:28   max GPU memory: 47458.5 MiB
05:08:28   ------------------------------
05:08:28   average binary cross entropy: 0.497208
05:08:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:08:28   Epoch 13 begin
05:09:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:09:32   binary cross entropy: 0.4499
05:12:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:12:22   binary cross entropy: 0.58987
05:12:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:12:43   Epoch 13 end
05:12:43   duration: 4.26 mins
05:12:43   speed: 0.59 batch / sec
05:12:43   ETA: 0.00 secs
05:12:43   max GPU memory: 47458.5 MiB
05:12:43   ------------------------------
05:12:43   average binary cross entropy: 0.502279
05:12:43   Save checkpoint to model_epoch_14.pth
05:12:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:12:43   Evaluate on valid
05:13:29   ------------------------------
05:13:29   ap: 0.977018
05:13:29   auroc: 0.967828
05:13:29   hits@1: 0.296345
05:13:29   hits@10: 0.464752
05:13:29   hits@100: 0.653032
05:13:29   hits@20: 0.521033
05:13:29   hits@3: 0.368871
05:13:29   hits@50: 0.596751
05:13:29   mr: 747.297
05:13:29   mrr: 0.352657
05:13:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:13:29   Epoch 14 begin
05:15:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:15:56   binary cross entropy: 0.438519
05:17:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:17:44   Epoch 14 end
05:17:44   duration: 5.01 mins
05:17:44   speed: 0.50 batch / sec
05:17:44   ETA: 0.00 secs
05:17:44   max GPU memory: 47458.5 MiB
05:17:44   ------------------------------
05:17:44   average binary cross entropy: 0.50022
05:17:44   Save checkpoint to model_epoch_15.pth
05:17:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:17:44   Evaluate on valid
05:18:30   ------------------------------
05:18:30   ap: 0.977189
05:18:30   auroc: 0.966026
05:18:30   hits@1: 0.295184
05:18:30   hits@10: 0.466057
05:18:30   hits@100: 0.653612
05:18:30   hits@20: 0.521178
05:18:30   hits@3: 0.369017
05:18:30   hits@50: 0.597911
05:18:30   mr: 724.172
05:18:30   mrr: 0.351625
05:18:30   Load checkpoint from model_epoch_10.pth
05:18:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:18:30   Evaluate on valid
05:19:16   ------------------------------
05:19:16   ap: 0.951664
05:19:16   auroc: 0.9268
05:19:16   hits@1: 0.302292
05:19:16   hits@10: 0.467073
05:19:16   hits@100: 0.6481
05:19:16   hits@20: 0.518567
05:19:16   hits@3: 0.373658
05:19:16   hits@50: 0.59385
05:19:16   mr: 763.104
05:19:16   mrr: 0.35671
05:19:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:19:16   Evaluate on test
05:20:47   ------------------------------
05:20:47   ap: 0.950971
05:20:47   auroc: 0.92676
05:20:47   hits@1: 0.293814
05:20:47   hits@10: 0.461522
05:20:47   hits@100: 0.651735
05:20:47   hits@20: 0.519602
05:20:47   hits@3: 0.363511
05:20:47   hits@50: 0.595107
05:20:47   mr: 771.013
05:20:47   mrr: 0.348924
