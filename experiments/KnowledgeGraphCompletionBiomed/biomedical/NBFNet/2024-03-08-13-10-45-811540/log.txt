13:10:45   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-08-13-10-45-811540
13:10:45   Input Seed: 1234
13:10:45   Set Seed: 1234
13:10:45   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
13:10:45   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr080/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
13:10:46   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 389102
)
13:10:46   #train: 2015, #valid: 721, #test: 1466
13:10:46   Preprocess training set
13:10:46   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr080/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(387636, 389102)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr080/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(384900, 386915)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr080/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(386915, 387636)}}
13:10:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:10:46   Epoch 0 begin
13:10:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:10:49   binary cross entropy: 0.722833
13:11:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:11:37   Epoch 0 end
13:11:37   duration: 51.01 secs
13:11:37   speed: 0.63 batch / sec
13:11:37   ETA: 51.01 secs
13:11:37   max GPU memory: 47412.0 MiB
13:11:37   ------------------------------
13:11:37   average binary cross entropy: 0.604725
13:11:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:11:37   Epoch 1 begin
13:12:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:12:27   Epoch 1 end
13:12:27   duration: 49.81 secs
13:12:27   speed: 0.64 batch / sec
13:12:27   ETA: 0.00 secs
13:12:27   max GPU memory: 47412.0 MiB
13:12:27   ------------------------------
13:12:27   average binary cross entropy: 0.576519
13:12:27   Save checkpoint to model_epoch_2.pth
13:12:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:12:27   Evaluate on valid
13:12:37   ------------------------------
13:12:37   ap: 0.988361
13:12:37   auroc: 0.98268
13:12:37   hits@1: 0.0880721
13:12:37   hits@10: 0.309986
13:12:37   hits@100: 0.78294
13:12:37   hits@20: 0.441054
13:12:37   hits@3: 0.166436
13:12:37   hits@50: 0.648405
13:12:37   mr: 161.879
13:12:37   mrr: 0.163111
13:12:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:12:37   Epoch 2 begin
13:13:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:13:27   Epoch 2 end
13:13:27   duration: 1.00 mins
13:13:27   speed: 0.53 batch / sec
13:13:27   ETA: 1.00 mins
13:13:27   max GPU memory: 47435.8 MiB
13:13:27   ------------------------------
13:13:27   average binary cross entropy: 0.56391
13:13:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:13:27   Epoch 3 begin
13:13:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:13:35   binary cross entropy: 0.547773
13:14:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:14:18   Epoch 3 end
13:14:18   duration: 50.32 secs
13:14:18   speed: 0.64 batch / sec
13:14:18   ETA: 0.00 secs
13:14:18   max GPU memory: 47435.8 MiB
13:14:18   ------------------------------
13:14:18   average binary cross entropy: 0.565812
13:14:18   Save checkpoint to model_epoch_4.pth
13:14:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:14:18   Evaluate on valid
13:14:27   ------------------------------
13:14:27   ap: 0.991792
13:14:27   auroc: 0.989697
13:14:27   hits@1: 0.074896
13:14:27   hits@10: 0.319695
13:14:27   hits@100: 0.807906
13:14:27   hits@20: 0.45215
13:14:27   hits@3: 0.163662
13:14:27   hits@50: 0.652566
13:14:27   mr: 157.727
13:14:27   mrr: 0.157493
13:14:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:14:27   Epoch 4 begin
13:15:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:15:18   Epoch 4 end
13:15:18   duration: 1.00 mins
13:15:18   speed: 0.53 batch / sec
13:15:18   ETA: 1.00 mins
13:15:18   max GPU memory: 47435.8 MiB
13:15:18   ------------------------------
13:15:18   average binary cross entropy: 0.547815
13:15:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:15:18   Epoch 5 begin
13:16:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:16:08   Epoch 5 end
13:16:08   duration: 50.55 secs
13:16:08   speed: 0.63 batch / sec
13:16:08   ETA: 0.00 secs
13:16:08   max GPU memory: 47435.8 MiB
13:16:08   ------------------------------
13:16:08   average binary cross entropy: 0.54551
13:16:08   Save checkpoint to model_epoch_6.pth
13:16:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:16:08   Evaluate on valid
13:16:18   ------------------------------
13:16:18   ap: 0.991875
13:16:18   auroc: 0.989128
13:16:18   hits@1: 0.0880721
13:16:18   hits@10: 0.339112
13:16:18   hits@100: 0.808599
13:16:18   hits@20: 0.479889
13:16:18   hits@3: 0.175451
13:16:18   hits@50: 0.674064
13:16:18   mr: 151.301
13:16:18   mrr: 0.171987
13:16:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:16:18   Epoch 6 begin
13:16:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:16:32   binary cross entropy: 0.539749
13:17:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:17:08   Epoch 6 end
13:17:08   duration: 1.00 mins
13:17:08   speed: 0.53 batch / sec
13:17:08   ETA: 1.00 mins
13:17:08   max GPU memory: 47435.8 MiB
13:17:08   ------------------------------
13:17:08   average binary cross entropy: 0.538525
13:17:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:17:08   Epoch 7 begin
13:17:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:17:59   Epoch 7 end
13:17:59   duration: 50.46 secs
13:17:59   speed: 0.63 batch / sec
13:17:59   ETA: 0.00 secs
13:17:59   max GPU memory: 47435.8 MiB
13:17:59   ------------------------------
13:17:59   average binary cross entropy: 0.541523
13:17:59   Save checkpoint to model_epoch_8.pth
13:18:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:18:00   Evaluate on valid
13:18:10   ------------------------------
13:18:10   ap: 0.995685
13:18:10   auroc: 0.994312
13:18:10   hits@1: 0.0957004
13:18:10   hits@10: 0.340499
13:18:10   hits@100: 0.81484
13:18:10   hits@20: 0.468793
13:18:10   hits@3: 0.18516
13:18:10   hits@50: 0.675451
13:18:10   mr: 156.496
13:18:10   mrr: 0.178273
13:18:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:18:10   Epoch 8 begin
13:19:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:19:00   Epoch 8 end
13:19:00   duration: 1.02 mins
13:19:00   speed: 0.52 batch / sec
13:19:00   ETA: 1.02 mins
13:19:00   max GPU memory: 47435.8 MiB
13:19:00   ------------------------------
13:19:00   average binary cross entropy: 0.549758
13:19:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:19:00   Epoch 9 begin
13:19:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:19:21   binary cross entropy: 0.525912
13:19:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:19:51   Epoch 9 end
13:19:51   duration: 50.33 secs
13:19:51   speed: 0.64 batch / sec
13:19:51   ETA: 0.00 secs
13:19:51   max GPU memory: 47435.8 MiB
13:19:51   ------------------------------
13:19:51   average binary cross entropy: 0.540001
13:19:51   Save checkpoint to model_epoch_10.pth
13:19:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:19:51   Evaluate on valid
13:20:00   ------------------------------
13:20:00   ap: 0.997496
13:20:00   auroc: 0.99613
13:20:00   hits@1: 0.100555
13:20:00   hits@10: 0.341193
13:20:00   hits@100: 0.807212
13:20:00   hits@20: 0.479196
13:20:00   hits@3: 0.192788
13:20:00   hits@50: 0.660194
13:20:00   mr: 158.468
13:20:00   mrr: 0.184153
13:20:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:20:00   Epoch 10 begin
13:20:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:20:51   Epoch 10 end
13:20:51   duration: 1.00 mins
13:20:51   speed: 0.53 batch / sec
13:20:51   ETA: 1.00 mins
13:20:51   max GPU memory: 47435.8 MiB
13:20:51   ------------------------------
13:20:51   average binary cross entropy: 0.528601
13:20:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:20:51   Epoch 11 begin
13:21:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:21:41   Epoch 11 end
13:21:41   duration: 50.35 secs
13:21:41   speed: 0.64 batch / sec
13:21:41   ETA: 0.00 secs
13:21:41   max GPU memory: 47435.8 MiB
13:21:41   ------------------------------
13:21:41   average binary cross entropy: 0.53782
13:21:41   Save checkpoint to model_epoch_12.pth
13:21:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:21:41   Evaluate on valid
13:21:51   ------------------------------
13:21:51   ap: 0.997057
13:21:51   auroc: 0.995281
13:21:51   hits@1: 0.100555
13:21:51   hits@10: 0.359917
13:21:51   hits@100: 0.818308
13:21:51   hits@20: 0.493759
13:21:51   hits@3: 0.194868
13:21:51   hits@50: 0.672677
13:21:51   mr: 154.393
13:21:51   mrr: 0.185312
13:21:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:21:51   Epoch 12 begin
13:22:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:22:18   binary cross entropy: 0.513521
13:22:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:22:41   Epoch 12 end
13:22:41   duration: 1.00 mins
13:22:41   speed: 0.53 batch / sec
13:22:41   ETA: 1.00 mins
13:22:41   max GPU memory: 47435.8 MiB
13:22:41   ------------------------------
13:22:41   average binary cross entropy: 0.536895
13:22:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:22:41   Epoch 13 begin
13:23:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:23:32   Epoch 13 end
13:23:32   duration: 50.52 secs
13:23:32   speed: 0.63 batch / sec
13:23:32   ETA: 0.00 secs
13:23:32   max GPU memory: 47435.8 MiB
13:23:32   ------------------------------
13:23:32   average binary cross entropy: 0.531578
13:23:32   Save checkpoint to model_epoch_14.pth
13:23:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:23:32   Evaluate on valid
13:23:42   ------------------------------
13:23:42   ap: 0.994911
13:23:42   auroc: 0.992396
13:23:42   hits@1: 0.10957
13:23:42   hits@10: 0.355756
13:23:42   hits@100: 0.822469
13:23:42   hits@20: 0.483356
13:23:42   hits@3: 0.20111
13:23:42   hits@50: 0.680999
13:23:42   mr: 153.94
13:23:42   mrr: 0.19358
13:23:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:23:42   Epoch 14 begin
13:24:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:24:32   Epoch 14 end
13:24:32   duration: 1.00 mins
13:24:32   speed: 0.53 batch / sec
13:24:32   ETA: 0.00 secs
13:24:32   max GPU memory: 47435.8 MiB
13:24:32   ------------------------------
13:24:32   average binary cross entropy: 0.532861
13:24:32   Save checkpoint to model_epoch_15.pth
13:24:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:24:32   Evaluate on valid
13:24:42   ------------------------------
13:24:42   ap: 0.995677
13:24:42   auroc: 0.9941
13:24:42   hits@1: 0.102635
13:24:42   hits@10: 0.363384
13:24:42   hits@100: 0.822469
13:24:42   hits@20: 0.488904
13:24:42   hits@3: 0.199029
13:24:42   hits@50: 0.680305
13:24:42   mr: 157.843
13:24:42   mrr: 0.188846
13:24:42   Load checkpoint from model_epoch_14.pth
13:24:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:24:42   Evaluate on valid
13:24:51   ------------------------------
13:24:51   ap: 0.994797
13:24:51   auroc: 0.992794
13:24:51   hits@1: 0.10957
13:24:51   hits@10: 0.355756
13:24:51   hits@100: 0.822469
13:24:51   hits@20: 0.483356
13:24:51   hits@3: 0.20111
13:24:51   hits@50: 0.680999
13:24:51   mr: 153.94
13:24:51   mrr: 0.19358
13:24:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
13:24:51   Evaluate on test
13:25:11   ------------------------------
13:25:11   ap: 0.994177
13:25:11   auroc: 0.990393
13:25:11   hits@1: 0.0999318
13:25:11   hits@10: 0.360505
13:25:11   hits@100: 0.834243
13:25:11   hits@20: 0.498295
13:25:11   hits@3: 0.197135
13:25:11   hits@50: 0.690314
13:25:11   mr: 171.823
13:25:11   mrr: 0.1865
