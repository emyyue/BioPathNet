16:12:00   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-26-16-12-00-450142
16:12:00   Input Seed: 1234
16:12:00   Set Seed: 1234
16:12:00   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
16:12:00   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
16:12:01   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 401604
)
16:12:01   #train: 5540, #valid: 2004, #test: 3909
16:12:01   Preprocess training set
16:12:02   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(397695, 401604)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(390151, 395691)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(395691, 397695)}}
16:12:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:12:02   Epoch 0 begin
16:12:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:12:07   binary cross entropy: 0.722557
16:14:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:14:27   Epoch 0 end
16:14:27   duration: 2.41 mins
16:14:27   speed: 0.60 batch / sec
16:14:27   ETA: 2.41 mins
16:14:27   max GPU memory: 47423.8 MiB
16:14:27   ------------------------------
16:14:27   average binary cross entropy: 0.534094
16:14:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:14:27   Epoch 1 begin
16:14:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:14:50   binary cross entropy: 0.493022
16:16:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:16:48   Epoch 1 end
16:16:48   duration: 2.35 mins
16:16:48   speed: 0.62 batch / sec
16:16:48   ETA: 0.00 secs
16:16:48   max GPU memory: 47423.8 MiB
16:16:48   ------------------------------
16:16:48   average binary cross entropy: 0.470828
16:16:48   Save checkpoint to model_epoch_2.pth
16:16:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:16:48   Evaluate on valid
16:17:16   ------------------------------
16:17:16   ap: 0.99652
16:17:16   auroc: 0.996057
16:17:16   hits@1: 0.293663
16:17:16   hits@10: 0.568114
16:17:16   hits@100: 0.75524
16:17:16   hits@20: 0.623503
16:17:16   hits@3: 0.426896
16:17:16   hits@50: 0.696856
16:17:16   mr: 615.234
16:17:16   mrr: 0.38528
16:17:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:17:16   Epoch 2 begin
16:17:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:18:00   binary cross entropy: 0.453432
16:19:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:19:38   Epoch 2 end
16:19:38   duration: 2.83 mins
16:19:38   speed: 0.51 batch / sec
16:19:38   ETA: 2.83 mins
16:19:38   max GPU memory: 47445.8 MiB
16:19:38   ------------------------------
16:19:38   average binary cross entropy: 0.461627
16:19:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:19:38   Epoch 3 begin
16:20:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:20:44   binary cross entropy: 0.399852
16:22:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:01   Epoch 3 end
16:22:01   duration: 2.38 mins
16:22:01   speed: 0.61 batch / sec
16:22:01   ETA: 0.00 secs
16:22:01   max GPU memory: 47445.8 MiB
16:22:01   ------------------------------
16:22:01   average binary cross entropy: 0.441072
16:22:01   Save checkpoint to model_epoch_4.pth
16:22:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:01   Evaluate on valid
16:22:27   ------------------------------
16:22:27   ap: 0.998519
16:22:27   auroc: 0.998357
16:22:27   hits@1: 0.328094
16:22:27   hits@10: 0.5751
16:22:27   hits@100: 0.764222
16:22:27   hits@20: 0.628992
16:22:27   hits@3: 0.448104
16:22:27   hits@50: 0.703842
16:22:27   mr: 602.942
16:22:27   mrr: 0.410441
16:22:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:27   Epoch 4 begin
16:23:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:23:55   binary cross entropy: 0.461973
16:24:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:24:50   Epoch 4 end
16:24:50   duration: 2.83 mins
16:24:50   speed: 0.51 batch / sec
16:24:50   ETA: 2.83 mins
16:24:50   max GPU memory: 47445.8 MiB
16:24:50   ------------------------------
16:24:50   average binary cross entropy: 0.433295
16:24:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:24:50   Epoch 5 begin
16:26:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:26:39   binary cross entropy: 0.44648
16:27:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:27:12   Epoch 5 end
16:27:12   duration: 2.37 mins
16:27:12   speed: 0.61 batch / sec
16:27:12   ETA: 0.00 secs
16:27:13   max GPU memory: 47445.8 MiB
16:27:13   ------------------------------
16:27:13   average binary cross entropy: 0.438411
16:27:13   Save checkpoint to model_epoch_6.pth
16:27:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:27:13   Evaluate on valid
16:27:40   ------------------------------
16:27:40   ap: 0.997583
16:27:40   auroc: 0.996699
16:27:40   hits@1: 0.331337
16:27:40   hits@10: 0.576597
16:27:40   hits@100: 0.768713
16:27:40   hits@20: 0.634232
16:27:40   hits@3: 0.452844
16:27:40   hits@50: 0.713822
16:27:40   mr: 557.668
16:27:40   mrr: 0.41515
16:27:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:27:40   Epoch 6 begin
16:29:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:29:49   binary cross entropy: 0.380114
16:30:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:30:02   Epoch 6 end
16:30:02   duration: 2.82 mins
16:30:02   speed: 0.51 batch / sec
16:30:02   ETA: 2.82 mins
16:30:02   max GPU memory: 47445.8 MiB
16:30:02   ------------------------------
16:30:02   average binary cross entropy: 0.428472
16:30:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:30:02   Epoch 7 begin
16:32:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:32:24   Epoch 7 end
16:32:24   duration: 2.37 mins
16:32:24   speed: 0.61 batch / sec
16:32:24   ETA: 0.00 secs
16:32:24   max GPU memory: 47445.8 MiB
16:32:24   ------------------------------
16:32:24   average binary cross entropy: 0.425023
16:32:24   Save checkpoint to model_epoch_8.pth
16:32:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:32:24   Evaluate on valid
16:32:51   ------------------------------
16:32:51   ap: 0.995843
16:32:51   auroc: 0.99463
16:32:51   hits@1: 0.336826
16:32:51   hits@10: 0.573104
16:32:51   hits@100: 0.771208
16:32:51   hits@20: 0.634232
16:32:51   hits@3: 0.45484
16:32:51   hits@50: 0.713323
16:32:51   mr: 576.068
16:32:51   mrr: 0.418153
16:32:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:32:51   Epoch 8 begin
16:32:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:32:59   binary cross entropy: 0.504077
16:35:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:35:13   Epoch 8 end
16:35:13   duration: 2.82 mins
16:35:13   speed: 0.51 batch / sec
16:35:13   ETA: 2.82 mins
16:35:13   max GPU memory: 47445.8 MiB
16:35:13   ------------------------------
16:35:13   average binary cross entropy: 0.41916
16:35:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:35:13   Epoch 9 begin
16:35:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:35:43   binary cross entropy: 0.440045
16:37:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:35   Epoch 9 end
16:37:35   duration: 2.37 mins
16:37:35   speed: 0.61 batch / sec
16:37:35   ETA: 0.00 secs
16:37:35   max GPU memory: 47445.8 MiB
16:37:35   ------------------------------
16:37:35   average binary cross entropy: 0.417915
16:37:35   Save checkpoint to model_epoch_10.pth
16:37:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:36   Evaluate on valid
16:38:02   ------------------------------
16:38:02   ap: 0.994792
16:38:02   auroc: 0.993754
16:38:02   hits@1: 0.341317
16:38:02   hits@10: 0.578343
16:38:02   hits@100: 0.772206
16:38:02   hits@20: 0.63498
16:38:02   hits@3: 0.45509
16:38:02   hits@50: 0.711327
16:38:02   mr: 570.824
16:38:02   mrr: 0.421081
16:38:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:38:02   Epoch 10 begin
16:38:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:38:53   binary cross entropy: 0.388663
16:40:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:40:25   Epoch 10 end
16:40:25   duration: 2.82 mins
16:40:25   speed: 0.51 batch / sec
16:40:25   ETA: 2.82 mins
16:40:25   max GPU memory: 47445.8 MiB
16:40:25   ------------------------------
16:40:25   average binary cross entropy: 0.422458
16:40:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:40:25   Epoch 11 begin
16:41:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:37   binary cross entropy: 0.4194
16:42:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:42:47   Epoch 11 end
16:42:47   duration: 2.37 mins
16:42:47   speed: 0.61 batch / sec
16:42:47   ETA: 0.00 secs
16:42:47   max GPU memory: 47445.8 MiB
16:42:47   ------------------------------
16:42:47   average binary cross entropy: 0.415537
16:42:47   Save checkpoint to model_epoch_12.pth
16:42:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:42:47   Evaluate on valid
16:43:14   ------------------------------
16:43:14   ap: 0.995346
16:43:14   auroc: 0.993721
16:43:14   hits@1: 0.345808
16:43:14   hits@10: 0.583333
16:43:14   hits@100: 0.771208
16:43:14   hits@20: 0.636976
16:43:14   hits@3: 0.46507
16:43:14   hits@50: 0.716317
16:43:14   mr: 558.406
16:43:14   mrr: 0.426855
16:43:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:43:14   Epoch 12 begin
16:44:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:44:48   binary cross entropy: 0.38859
16:45:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:36   Epoch 12 end
16:45:36   duration: 2.82 mins
16:45:36   speed: 0.51 batch / sec
16:45:36   ETA: 2.82 mins
16:45:36   max GPU memory: 47445.8 MiB
16:45:36   ------------------------------
16:45:36   average binary cross entropy: 0.412292
16:45:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:36   Epoch 13 begin
16:47:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:31   binary cross entropy: 0.409213
16:47:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:58   Epoch 13 end
16:47:58   duration: 2.37 mins
16:47:58   speed: 0.61 batch / sec
16:47:58   ETA: 0.00 secs
16:47:58   max GPU memory: 47445.8 MiB
16:47:58   ------------------------------
16:47:58   average binary cross entropy: 0.411388
16:47:58   Save checkpoint to model_epoch_14.pth
16:47:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:59   Evaluate on valid
16:48:25   ------------------------------
16:48:25   ap: 0.997344
16:48:25   auroc: 0.996812
16:48:25   hits@1: 0.336577
16:48:25   hits@10: 0.577844
16:48:25   hits@100: 0.770709
16:48:25   hits@20: 0.639222
16:48:25   hits@3: 0.456587
16:48:25   hits@50: 0.714321
16:48:25   mr: 564.051
16:48:25   mrr: 0.419381
16:48:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:48:25   Epoch 14 begin
16:50:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:50:42   binary cross entropy: 0.426867
16:50:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:50:48   Epoch 14 end
16:50:48   duration: 2.82 mins
16:50:48   speed: 0.51 batch / sec
16:50:48   ETA: 0.00 secs
16:50:48   max GPU memory: 47445.8 MiB
16:50:48   ------------------------------
16:50:48   average binary cross entropy: 0.405628
16:50:48   Save checkpoint to model_epoch_15.pth
16:50:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:50:48   Evaluate on valid
16:51:14   ------------------------------
16:51:14   ap: 0.995885
16:51:14   auroc: 0.994087
16:51:14   hits@1: 0.342814
16:51:14   hits@10: 0.582335
16:51:14   hits@100: 0.773952
16:51:14   hits@20: 0.637974
16:51:14   hits@3: 0.458084
16:51:14   hits@50: 0.718064
16:51:14   mr: 552.601
16:51:14   mrr: 0.423256
16:51:15   Load checkpoint from model_epoch_12.pth
16:51:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:16   Evaluate on valid
16:51:42   ------------------------------
16:51:42   ap: 0.99485
16:51:42   auroc: 0.99332
16:51:42   hits@1: 0.345808
16:51:42   hits@10: 0.583333
16:51:42   hits@100: 0.771208
16:51:42   hits@20: 0.636976
16:51:42   hits@3: 0.46507
16:51:42   hits@50: 0.716317
16:51:42   mr: 558.406
16:51:42   mrr: 0.426855
16:51:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:42   Evaluate on test
16:52:35   ------------------------------
16:52:35   ap: 0.995139
16:52:35   auroc: 0.993198
16:52:35   hits@1: 0.354311
16:52:35   hits@10: 0.589921
16:52:35   hits@100: 0.788309
16:52:35   hits@20: 0.650166
16:52:35   hits@3: 0.468023
16:52:35   hits@50: 0.731389
16:52:35   mr: 542.94
16:52:35   mrr: 0.43356
