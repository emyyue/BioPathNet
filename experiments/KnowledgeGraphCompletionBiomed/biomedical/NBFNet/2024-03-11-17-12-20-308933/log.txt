17:12:20   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-11-17-12-20-308933
17:12:20   Input Seed: 1235
17:12:20   Set Seed: 1235
17:12:20   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
17:12:20   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr040/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
17:12:21   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 407064
)
17:12:21   #train: 7038, #valid: 2568, #test: 5029
17:12:21   Preprocess training set
17:12:23   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr040/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(402035, 407064)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr040/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(392429, 399467)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr040/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(399467, 402035)}}
17:12:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:23   Epoch 0 begin
17:12:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:12:31   binary cross entropy: 0.719514
17:15:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:15   binary cross entropy: 0.42191
17:15:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:30   Epoch 0 end
17:15:30   duration: 3.11 mins
17:15:30   speed: 0.59 batch / sec
17:15:30   ETA: 3.11 mins
17:15:30   max GPU memory: 47430.0 MiB
17:15:30   ------------------------------
17:15:30   average binary cross entropy: 0.519681
17:15:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:15:30   Epoch 1 begin
17:17:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:18:00   binary cross entropy: 0.466536
17:18:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:18:31   Epoch 1 end
17:18:31   duration: 3.01 mins
17:18:31   speed: 0.61 batch / sec
17:18:31   ETA: 0.00 secs
17:18:31   max GPU memory: 47430.0 MiB
17:18:31   ------------------------------
17:18:31   average binary cross entropy: 0.443249
17:18:31   Save checkpoint to model_epoch_2.pth
17:18:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:18:31   Evaluate on valid
17:19:06   ------------------------------
17:19:06   ap: 0.994846
17:19:06   auroc: 0.99416
17:19:06   hits@1: 0.34229
17:19:06   hits@10: 0.594237
17:19:06   hits@100: 0.788551
17:19:06   hits@20: 0.653816
17:19:06   hits@3: 0.463785
17:19:06   hits@50: 0.738123
17:19:06   mr: 483.765
17:19:06   mrr: 0.427243
17:19:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:19:06   Epoch 2 begin
17:21:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:21:20   binary cross entropy: 0.432012
17:22:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:22:07   Epoch 2 end
17:22:07   duration: 3.61 mins
17:22:07   speed: 0.51 batch / sec
17:22:07   ETA: 3.61 mins
17:22:07   max GPU memory: 47452.7 MiB
17:22:07   ------------------------------
17:22:07   average binary cross entropy: 0.436479
17:22:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:22:07   Epoch 3 begin
17:24:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:24:06   binary cross entropy: 0.377649
17:25:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:25:11   Epoch 3 end
17:25:11   duration: 3.06 mins
17:25:11   speed: 0.60 batch / sec
17:25:11   ETA: 0.00 secs
17:25:11   max GPU memory: 47452.7 MiB
17:25:11   ------------------------------
17:25:11   average binary cross entropy: 0.435368
17:25:11   Save checkpoint to model_epoch_4.pth
17:25:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:25:11   Evaluate on valid
17:25:45   ------------------------------
17:25:45   ap: 0.996368
17:25:45   auroc: 0.995875
17:25:45   hits@1: 0.388824
17:25:45   hits@10: 0.600467
17:25:45   hits@100: 0.797702
17:25:45   hits@20: 0.660241
17:25:45   hits@3: 0.484618
17:25:45   hits@50: 0.742991
17:25:45   mr: 462.257
17:25:45   mrr: 0.457866
17:25:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:25:45   Epoch 4 begin
17:27:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:27:26   binary cross entropy: 0.405819
17:28:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:28:47   Epoch 4 end
17:28:47   duration: 3.59 mins
17:28:47   speed: 0.51 batch / sec
17:28:47   ETA: 3.59 mins
17:28:47   max GPU memory: 47452.7 MiB
17:28:47   ------------------------------
17:28:47   average binary cross entropy: 0.41878
17:28:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:28:47   Epoch 5 begin
17:30:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:30:12   binary cross entropy: 0.363846
17:31:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:31:49   Epoch 5 end
17:31:49   duration: 3.05 mins
17:31:49   speed: 0.60 batch / sec
17:31:49   ETA: 0.00 secs
17:31:49   max GPU memory: 47452.7 MiB
17:31:50   ------------------------------
17:31:50   average binary cross entropy: 0.420015
17:31:50   Save checkpoint to model_epoch_6.pth
17:31:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:31:50   Evaluate on valid
17:32:24   ------------------------------
17:32:24   ap: 0.995897
17:32:24   auroc: 0.995561
17:32:24   hits@1: 0.371885
17:32:24   hits@10: 0.594431
17:32:24   hits@100: 0.794587
17:32:24   hits@20: 0.660241
17:32:24   hits@3: 0.480724
17:32:24   hits@50: 0.740265
17:32:24   mr: 444.12
17:32:24   mrr: 0.447505
17:32:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:32:24   Epoch 6 begin
17:33:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:33:31   binary cross entropy: 0.423965
17:35:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:35:25   Epoch 6 end
17:35:25   duration: 3.59 mins
17:35:25   speed: 0.51 batch / sec
17:35:25   ETA: 3.59 mins
17:35:25   max GPU memory: 47452.7 MiB
17:35:25   ------------------------------
17:35:25   average binary cross entropy: 0.416953
17:35:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:35:25   Epoch 7 begin
17:36:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:36:16   binary cross entropy: 0.407975
17:38:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:38:27   Epoch 7 end
17:38:27   duration: 3.03 mins
17:38:27   speed: 0.61 batch / sec
17:38:27   ETA: 0.00 secs
17:38:27   max GPU memory: 47452.7 MiB
17:38:27   ------------------------------
17:38:27   average binary cross entropy: 0.410315
17:38:27   Save checkpoint to model_epoch_8.pth
17:38:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:38:27   Evaluate on valid
17:39:01   ------------------------------
17:39:01   ap: 0.995871
17:39:01   auroc: 0.995301
17:39:01   hits@1: 0.392913
17:39:01   hits@10: 0.597741
17:39:01   hits@100: 0.795366
17:39:01   hits@20: 0.653816
17:39:01   hits@3: 0.490654
17:39:01   hits@50: 0.738707
17:39:01   mr: 452.171
17:39:01   mrr: 0.462006
17:39:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:39:01   Epoch 8 begin
17:39:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:39:36   binary cross entropy: 0.392251
17:42:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:02   Epoch 8 end
17:42:02   duration: 3.59 mins
17:42:02   speed: 0.51 batch / sec
17:42:02   ETA: 3.59 mins
17:42:02   max GPU memory: 47452.7 MiB
17:42:02   ------------------------------
17:42:02   average binary cross entropy: 0.408676
17:42:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:02   Epoch 9 begin
17:42:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:42:21   binary cross entropy: 0.343204
17:45:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:45:06   Epoch 9 end
17:45:06   duration: 3.05 mins
17:45:06   speed: 0.60 batch / sec
17:45:06   ETA: 0.00 secs
17:45:06   max GPU memory: 47452.7 MiB
17:45:06   ------------------------------
17:45:06   average binary cross entropy: 0.408483
17:45:06   Save checkpoint to model_epoch_10.pth
17:45:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:45:06   Evaluate on valid
17:45:40   ------------------------------
17:45:40   ap: 0.994957
17:45:40   auroc: 0.994283
17:45:40   hits@1: 0.397586
17:45:40   hits@10: 0.600078
17:45:40   hits@100: 0.796729
17:45:40   hits@20: 0.662188
17:45:40   hits@3: 0.489291
17:45:40   hits@50: 0.745522
17:45:40   mr: 461.512
17:45:40   mrr: 0.464583
17:45:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:45:40   Epoch 10 begin
17:45:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:45:42   binary cross entropy: 0.375333
17:48:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:48:26   binary cross entropy: 0.427635
17:48:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:48:41   Epoch 10 end
17:48:41   duration: 3.59 mins
17:48:41   speed: 0.51 batch / sec
17:48:41   ETA: 3.59 mins
17:48:41   max GPU memory: 47452.7 MiB
17:48:41   ------------------------------
17:48:41   average binary cross entropy: 0.400576
17:48:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:48:41   Epoch 11 begin
17:51:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:51:12   binary cross entropy: 0.402033
17:51:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:51:44   Epoch 11 end
17:51:44   duration: 3.04 mins
17:51:44   speed: 0.60 batch / sec
17:51:44   ETA: 0.00 secs
17:51:44   max GPU memory: 47452.7 MiB
17:51:44   ------------------------------
17:51:44   average binary cross entropy: 0.40749
17:51:44   Save checkpoint to model_epoch_12.pth
17:51:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:51:44   Evaluate on valid
17:52:18   ------------------------------
17:52:18   ap: 0.995228
17:52:18   auroc: 0.993981
17:52:18   hits@1: 0.397196
17:52:18   hits@10: 0.599104
17:52:18   hits@100: 0.801012
17:52:18   hits@20: 0.661799
17:52:18   hits@3: 0.48384
17:52:18   hits@50: 0.741822
17:52:18   mr: 429.864
17:52:18   mrr: 0.464055
17:52:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:52:18   Epoch 12 begin
17:54:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:54:31   binary cross entropy: 0.384154
17:55:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:55:19   Epoch 12 end
17:55:19   duration: 3.59 mins
17:55:19   speed: 0.51 batch / sec
17:55:19   ETA: 3.59 mins
17:55:19   max GPU memory: 47452.7 MiB
17:55:19   ------------------------------
17:55:19   average binary cross entropy: 0.401861
17:55:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:55:19   Epoch 13 begin
17:57:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:57:16   binary cross entropy: 0.414641
17:58:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:58:21   Epoch 13 end
17:58:21   duration: 3.03 mins
17:58:21   speed: 0.61 batch / sec
17:58:21   ETA: 0.00 secs
17:58:21   max GPU memory: 47452.7 MiB
17:58:21   ------------------------------
17:58:21   average binary cross entropy: 0.405398
17:58:21   Save checkpoint to model_epoch_14.pth
17:58:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:58:21   Evaluate on valid
17:58:55   ------------------------------
17:58:55   ap: 0.993962
17:58:55   auroc: 0.993332
17:58:55   hits@1: 0.395639
17:58:55   hits@10: 0.610397
17:58:55   hits@100: 0.801012
17:58:55   hits@20: 0.662578
17:58:55   hits@3: 0.492407
17:58:55   hits@50: 0.742601
17:58:55   mr: 430.055
17:58:55   mrr: 0.466217
17:58:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
17:58:55   Epoch 14 begin
18:00:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:00:36   binary cross entropy: 0.408886
18:01:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:01:56   Epoch 14 end
18:01:56   duration: 3.59 mins
18:01:56   speed: 0.51 batch / sec
18:01:56   ETA: 0.00 secs
18:01:56   max GPU memory: 47452.7 MiB
18:01:56   ------------------------------
18:01:56   average binary cross entropy: 0.404604
18:01:56   Save checkpoint to model_epoch_15.pth
18:01:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:01:56   Evaluate on valid
18:02:30   ------------------------------
18:02:30   ap: 0.996476
18:02:30   auroc: 0.996146
18:02:30   hits@1: 0.393302
18:02:30   hits@10: 0.609424
18:02:30   hits@100: 0.800818
18:02:30   hits@20: 0.668224
18:02:30   hits@3: 0.502336
18:02:30   hits@50: 0.745717
18:02:30   mr: 429.398
18:02:30   mrr: 0.467401
18:02:30   Load checkpoint from model_epoch_15.pth
18:02:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:02:31   Evaluate on valid
18:03:07   ------------------------------
18:03:07   ap: 0.996548
18:03:07   auroc: 0.996158
18:03:07   hits@1: 0.393302
18:03:07   hits@10: 0.609424
18:03:07   hits@100: 0.800818
18:03:07   hits@20: 0.668224
18:03:07   hits@3: 0.502336
18:03:07   hits@50: 0.745717
18:03:07   mr: 429.398
18:03:07   mrr: 0.467401
18:03:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
18:03:07   Evaluate on test
18:04:13   ------------------------------
18:04:13   ap: 0.99686
18:04:13   auroc: 0.996134
18:04:13   hits@1: 0.40177
18:04:13   hits@10: 0.61553
18:04:13   hits@100: 0.816365
18:04:13   hits@20: 0.675184
18:04:13   hits@3: 0.498708
18:04:13   hits@50: 0.758103
18:04:13   mr: 424.138
18:04:13   mrr: 0.472234
