01:20:42   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-28-01-20-42-605152
01:20:42   Input Seed: 1238
01:20:42   Set Seed: 1238
01:20:42   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
01:20:42   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
01:20:43   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 413118
)
01:20:43   #train: 8770, #valid: 3172, #test: 6254
01:20:43   Preprocess training set
01:20:43   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(406864, 413118)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(394922, 403692)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(403692, 406864)}}
01:20:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:20:43   Epoch 0 begin
01:20:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:20:47   binary cross entropy: 0.70621
01:23:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:23:34   binary cross entropy: 0.527617
01:24:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:24:35   Epoch 0 end
01:24:35   duration: 3.86 mins
01:24:35   speed: 0.60 batch / sec
01:24:35   ETA: 3.86 mins
01:24:35   max GPU memory: 47433.9 MiB
01:24:35   ------------------------------
01:24:35   average binary cross entropy: 0.565562
01:24:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:24:35   Epoch 1 begin
01:26:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:26:21   binary cross entropy: 0.454647
01:28:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:26   Epoch 1 end
01:28:26   duration: 3.84 mins
01:28:26   speed: 0.60 batch / sec
01:28:26   ETA: 0.00 secs
01:28:26   max GPU memory: 47433.9 MiB
01:28:26   ------------------------------
01:28:26   average binary cross entropy: 0.532439
01:28:26   Save checkpoint to model_epoch_2.pth
01:28:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:26   Evaluate on valid
01:29:08   ------------------------------
01:29:08   ap: 0.975201
01:29:08   auroc: 0.967917
01:29:08   hits@1: 0.251419
01:29:08   hits@10: 0.474779
01:29:08   hits@100: 0.66819
01:29:08   hits@20: 0.539407
01:29:08   hits@3: 0.351198
01:29:08   hits@50: 0.611129
01:29:08   mr: 773.353
01:29:08   mrr: 0.324454
01:29:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:29:08   Epoch 2 begin
01:29:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:29:51   binary cross entropy: 0.467978
01:32:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:32:41   binary cross entropy: 0.481525
01:33:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:01   Epoch 2 end
01:33:01   duration: 4.59 mins
01:33:01   speed: 0.50 batch / sec
01:33:01   ETA: 4.59 mins
01:33:01   max GPU memory: 47457.8 MiB
01:33:01   ------------------------------
01:33:01   average binary cross entropy: 0.518854
01:33:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:01   Epoch 3 begin
01:35:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:35:28   binary cross entropy: 0.503923
01:36:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:36:53   Epoch 3 end
01:36:53   duration: 3.86 mins
01:36:53   speed: 0.60 batch / sec
01:36:53   ETA: 0.00 secs
01:36:53   max GPU memory: 47457.8 MiB
01:36:53   ------------------------------
01:36:53   average binary cross entropy: 0.504139
01:36:53   Save checkpoint to model_epoch_4.pth
01:36:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:36:53   Evaluate on valid
01:37:35   ------------------------------
01:37:35   ap: 0.980885
01:37:35   auroc: 0.972476
01:37:35   hits@1: 0.275694
01:37:35   hits@10: 0.485183
01:37:35   hits@100: 0.675599
01:37:35   hits@20: 0.53657
01:37:35   hits@3: 0.369798
01:37:35   hits@50: 0.615542
01:37:35   mr: 725.437
01:37:35   mrr: 0.343798
01:37:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:37:35   Epoch 4 begin
01:38:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:38:58   binary cross entropy: 0.532895
01:41:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:41:27   Epoch 4 end
01:41:27   duration: 4.57 mins
01:41:27   speed: 0.50 batch / sec
01:41:27   ETA: 4.57 mins
01:41:27   max GPU memory: 47457.8 MiB
01:41:27   ------------------------------
01:41:27   average binary cross entropy: 0.501193
01:41:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:41:27   Epoch 5 begin
01:41:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:41:46   binary cross entropy: 0.411227
01:44:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:44:35   binary cross entropy: 0.492513
01:45:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:45:19   Epoch 5 end
01:45:19   duration: 3.86 mins
01:45:19   speed: 0.60 batch / sec
01:45:19   ETA: 0.00 secs
01:45:19   max GPU memory: 47457.8 MiB
01:45:19   ------------------------------
01:45:19   average binary cross entropy: 0.494681
01:45:19   Save checkpoint to model_epoch_6.pth
01:45:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:45:19   Evaluate on valid
01:46:02   ------------------------------
01:46:02   ap: 0.989731
01:46:02   auroc: 0.985294
01:46:02   hits@1: 0.307535
01:46:02   hits@10: 0.495113
01:46:02   hits@100: 0.685214
01:46:02   hits@20: 0.549653
01:46:02   hits@3: 0.394231
01:46:02   hits@50: 0.627995
01:46:02   mr: 697.297
01:46:02   mrr: 0.369807
01:46:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:46:02   Epoch 6 begin
01:48:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:48:05   binary cross entropy: 0.491256
01:49:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:49:54   Epoch 6 end
01:49:54   duration: 4.57 mins
01:49:54   speed: 0.50 batch / sec
01:49:54   ETA: 4.57 mins
01:49:54   max GPU memory: 47457.8 MiB
01:49:54   ------------------------------
01:49:54   average binary cross entropy: 0.500431
01:49:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:49:54   Epoch 7 begin
01:50:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:50:53   binary cross entropy: 0.528696
01:53:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:53:42   binary cross entropy: 0.511905
01:53:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:53:46   Epoch 7 end
01:53:46   duration: 3.87 mins
01:53:46   speed: 0.59 batch / sec
01:53:46   ETA: 0.00 secs
01:53:46   max GPU memory: 47457.8 MiB
01:53:46   ------------------------------
01:53:46   average binary cross entropy: 0.503762
01:53:46   Save checkpoint to model_epoch_8.pth
01:53:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:53:46   Evaluate on valid
01:54:28   ------------------------------
01:54:28   ap: 0.982359
01:54:28   auroc: 0.974566
01:54:28   hits@1: 0.318096
01:54:28   hits@10: 0.496375
01:54:28   hits@100: 0.688998
01:54:28   hits@20: 0.556431
01:54:28   hits@3: 0.398014
01:54:28   hits@50: 0.63099
01:54:28   mr: 695.928
01:54:28   mrr: 0.377745
01:54:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:54:28   Epoch 8 begin
01:57:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:57:12   binary cross entropy: 0.447212
01:58:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:58:20   Epoch 8 end
01:58:20   duration: 4.57 mins
01:58:20   speed: 0.50 batch / sec
01:58:20   ETA: 4.57 mins
01:58:20   max GPU memory: 47457.8 MiB
01:58:20   ------------------------------
01:58:20   average binary cross entropy: 0.491319
01:58:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:58:20   Epoch 9 begin
01:59:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:00:00   binary cross entropy: 0.484598
02:02:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:02:12   Epoch 9 end
02:02:12   duration: 3.87 mins
02:02:12   speed: 0.59 batch / sec
02:02:12   ETA: 0.00 secs
02:02:12   max GPU memory: 47457.8 MiB
02:02:12   ------------------------------
02:02:12   average binary cross entropy: 0.479869
02:02:12   Save checkpoint to model_epoch_10.pth
02:02:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:02:12   Evaluate on valid
02:02:54   ------------------------------
02:02:54   ap: 0.965528
02:02:54   auroc: 0.951635
02:02:54   hits@1: 0.317938
02:02:54   hits@10: 0.502207
02:02:54   hits@100: 0.687894
02:02:54   hits@20: 0.557535
02:02:54   hits@3: 0.39691
02:02:54   hits@50: 0.633039
02:02:54   mr: 692.553
02:02:54   mrr: 0.378042
02:02:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:02:54   Epoch 10 begin
02:03:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:03:30   binary cross entropy: 0.537867
02:06:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:06:19   binary cross entropy: 0.558368
02:06:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:06:46   Epoch 10 end
02:06:46   duration: 4.57 mins
02:06:46   speed: 0.50 batch / sec
02:06:46   ETA: 4.57 mins
02:06:46   max GPU memory: 47457.8 MiB
02:06:46   ------------------------------
02:06:46   average binary cross entropy: 0.479515
02:06:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:06:46   Epoch 11 begin
02:09:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:09:07   binary cross entropy: 0.523813
02:10:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:10:38   Epoch 11 end
02:10:38   duration: 3.87 mins
02:10:38   speed: 0.59 batch / sec
02:10:38   ETA: 0.00 secs
02:10:38   max GPU memory: 47457.8 MiB
02:10:38   ------------------------------
02:10:38   average binary cross entropy: 0.484034
02:10:38   Save checkpoint to model_epoch_12.pth
02:10:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:10:38   Evaluate on valid
02:11:21   ------------------------------
02:11:21   ap: 0.986578
02:11:21   auroc: 0.980274
02:11:21   hits@1: 0.319199
02:11:21   hits@10: 0.507409
02:11:21   hits@100: 0.692938
02:11:21   hits@20: 0.560687
02:11:21   hits@3: 0.398487
02:11:21   hits@50: 0.639975
02:11:21   mr: 680.083
02:11:21   mrr: 0.380135
02:11:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:11:21   Epoch 12 begin
02:12:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:12:37   binary cross entropy: 0.447037
02:15:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:15:13   Epoch 12 end
02:15:13   duration: 4.57 mins
02:15:13   speed: 0.50 batch / sec
02:15:13   ETA: 4.57 mins
02:15:13   max GPU memory: 47457.8 MiB
02:15:13   ------------------------------
02:15:13   average binary cross entropy: 0.485132
02:15:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:15:13   Epoch 13 begin
02:15:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:15:24   binary cross entropy: 0.475571
02:18:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:18:13   binary cross entropy: 0.518384
02:19:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:19:05   Epoch 13 end
02:19:05   duration: 3.87 mins
02:19:05   speed: 0.60 batch / sec
02:19:05   ETA: 0.00 secs
02:19:05   max GPU memory: 47457.8 MiB
02:19:05   ------------------------------
02:19:05   average binary cross entropy: 0.485624
02:19:05   Save checkpoint to model_epoch_14.pth
02:19:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:19:05   Evaluate on valid
02:19:47   ------------------------------
02:19:47   ap: 0.97668
02:19:47   auroc: 0.967324
02:19:47   hits@1: 0.317308
02:19:47   hits@10: 0.502995
02:19:47   hits@100: 0.694672
02:19:47   hits@20: 0.55848
02:19:47   hits@3: 0.401324
02:19:47   hits@50: 0.636192
02:19:47   mr: 665.725
02:19:47   mrr: 0.378715
02:19:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:19:47   Epoch 14 begin
02:21:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:21:44   binary cross entropy: 0.391861
02:23:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:23:39   Epoch 14 end
02:23:39   duration: 4.57 mins
02:23:39   speed: 0.50 batch / sec
02:23:39   ETA: 0.00 secs
02:23:39   max GPU memory: 47457.8 MiB
02:23:39   ------------------------------
02:23:39   average binary cross entropy: 0.479432
02:23:39   Save checkpoint to model_epoch_15.pth
02:23:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:23:39   Evaluate on valid
02:24:22   ------------------------------
02:24:22   ap: 0.977471
02:24:22   auroc: 0.967941
02:24:22   hits@1: 0.328657
02:24:22   hits@10: 0.510246
02:24:22   hits@100: 0.691835
02:24:22   hits@20: 0.560845
02:24:22   hits@3: 0.405422
02:24:22   hits@50: 0.637453
02:24:22   mr: 678.492
02:24:22   mrr: 0.387552
02:24:22   Load checkpoint from model_epoch_15.pth
02:24:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:24:22   Evaluate on valid
02:25:04   ------------------------------
02:25:04   ap: 0.977667
02:25:04   auroc: 0.968064
02:25:04   hits@1: 0.328657
02:25:04   hits@10: 0.510246
02:25:04   hits@100: 0.691835
02:25:04   hits@20: 0.560845
02:25:04   hits@3: 0.405422
02:25:04   hits@50: 0.637453
02:25:04   mr: 678.492
02:25:04   mrr: 0.387552
02:25:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
02:25:04   Evaluate on test
02:26:27   ------------------------------
02:26:27   ap: 0.976228
02:26:27   auroc: 0.967526
02:26:27   hits@1: 0.324512
02:26:27   hits@10: 0.509514
02:26:27   hits@100: 0.700032
02:26:27   hits@20: 0.569076
02:26:27   hits@3: 0.401183
02:26:27   hits@50: 0.643588
02:26:27   mr: 689.587
02:26:27   mrr: 0.384674
