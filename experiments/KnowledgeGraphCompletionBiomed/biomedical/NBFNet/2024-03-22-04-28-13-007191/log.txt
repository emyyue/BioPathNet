04:28:13   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-22-04-28-13-007191
04:28:13   Input Seed: 1234
04:28:13   Set Seed: 1234
04:28:13   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
04:28:13   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
04:28:13   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 417079
)
04:28:13   #train: 9878, #valid: 3533, #test: 7049
04:28:13   Preprocess training set
04:28:14   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(410030, 417079)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(396619, 406497)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(406497, 410030)}}
04:28:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:28:14   Epoch 0 begin
04:28:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:28:16   binary cross entropy: 0.719481
04:31:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:31:05   binary cross entropy: 0.622153
04:32:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:32:35   Epoch 0 end
04:32:35   duration: 4.36 mins
04:32:35   speed: 0.59 batch / sec
04:32:35   ETA: 4.36 mins
04:32:35   max GPU memory: 47436.6 MiB
04:32:35   ------------------------------
04:32:35   average binary cross entropy: 0.575827
04:32:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:32:35   Epoch 1 begin
04:33:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:33:54   binary cross entropy: 0.544113
04:36:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:36:43   binary cross entropy: 0.584107
04:36:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:36:57   Epoch 1 end
04:36:57   duration: 4.37 mins
04:36:57   speed: 0.59 batch / sec
04:36:57   ETA: 0.00 secs
04:36:57   max GPU memory: 47436.6 MiB
04:36:57   ------------------------------
04:36:57   average binary cross entropy: 0.533969
04:36:57   Save checkpoint to model_epoch_2.pth
04:36:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:36:57   Evaluate on valid
04:37:45   ------------------------------
04:37:45   ap: 0.963188
04:37:45   auroc: 0.942962
04:37:45   hits@1: 0.251769
04:37:45   hits@10: 0.447354
04:37:45   hits@100: 0.636994
04:37:45   hits@20: 0.506793
04:37:45   hits@3: 0.33456
04:37:45   hits@50: 0.581942
04:37:45   mr: 809.421
04:37:45   mrr: 0.315755
04:37:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:37:45   Epoch 2 begin
04:40:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:40:19   binary cross entropy: 0.583053
04:42:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:42:07   Epoch 2 end
04:42:07   duration: 5.16 mins
04:42:07   speed: 0.50 batch / sec
04:42:07   ETA: 5.16 mins
04:42:07   max GPU memory: 47459.7 MiB
04:42:07   ------------------------------
04:42:07   average binary cross entropy: 0.525615
04:42:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:42:07   Epoch 3 begin
04:43:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:43:08   binary cross entropy: 0.49391
04:45:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:45:57   binary cross entropy: 0.518853
04:46:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:46:29   Epoch 3 end
04:46:29   duration: 4.36 mins
04:46:29   speed: 0.59 batch / sec
04:46:29   ETA: 0.00 secs
04:46:29   max GPU memory: 47459.7 MiB
04:46:29   ------------------------------
04:46:29   average binary cross entropy: 0.521882
04:46:29   Save checkpoint to model_epoch_4.pth
04:46:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:46:29   Evaluate on valid
04:47:16   ------------------------------
04:47:16   ap: 0.947944
04:47:16   auroc: 0.923562
04:47:16   hits@1: 0.269884
04:47:16   hits@10: 0.460232
04:47:16   hits@100: 0.646193
04:47:16   hits@20: 0.515851
04:47:16   hits@3: 0.354515
04:47:16   hits@50: 0.59199
04:47:16   mr: 760.158
04:47:16   mrr: 0.332408
04:47:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:47:16   Epoch 4 begin
04:49:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:49:33   binary cross entropy: 0.565365
04:51:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:51:38   Epoch 4 end
04:51:38   duration: 5.15 mins
04:51:38   speed: 0.50 batch / sec
04:51:38   ETA: 5.15 mins
04:51:38   max GPU memory: 47459.7 MiB
04:51:38   ------------------------------
04:51:38   average binary cross entropy: 0.521677
04:51:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:51:38   Epoch 5 begin
04:52:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:52:22   binary cross entropy: 0.584185
04:55:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:55:12   binary cross entropy: 0.492702
04:56:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:56:00   Epoch 5 end
04:56:00   duration: 4.37 mins
04:56:00   speed: 0.59 batch / sec
04:56:00   ETA: 0.00 secs
04:56:00   max GPU memory: 47459.7 MiB
04:56:00   ------------------------------
04:56:00   average binary cross entropy: 0.51173
04:56:00   Save checkpoint to model_epoch_6.pth
04:56:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:56:00   Evaluate on valid
04:56:47   ------------------------------
04:56:47   ap: 0.94588
04:56:47   auroc: 0.920927
04:56:47   hits@1: 0.287008
04:56:47   hits@10: 0.466459
04:56:47   hits@100: 0.653835
04:56:47   hits@20: 0.518398
04:56:47   hits@3: 0.36527
04:56:47   hits@50: 0.595811
04:56:47   mr: 734.32
04:56:47   mrr: 0.34627
04:56:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:56:47   Epoch 6 begin
04:58:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:58:47   binary cross entropy: 0.435117
05:01:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:01:09   Epoch 6 end
05:01:09   duration: 5.15 mins
05:01:09   speed: 0.50 batch / sec
05:01:09   ETA: 5.15 mins
05:01:09   max GPU memory: 47459.7 MiB
05:01:09   ------------------------------
05:01:09   average binary cross entropy: 0.512046
05:01:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:01:09   Epoch 7 begin
05:01:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:01:37   binary cross entropy: 0.476849
05:04:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:04:26   binary cross entropy: 0.534204
05:05:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:05:31   Epoch 7 end
05:05:31   duration: 4.37 mins
05:05:31   speed: 0.59 batch / sec
05:05:31   ETA: 0.00 secs
05:05:31   max GPU memory: 47459.7 MiB
05:05:31   ------------------------------
05:05:31   average binary cross entropy: 0.512745
05:05:31   Save checkpoint to model_epoch_8.pth
05:05:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:05:31   Evaluate on valid
05:06:18   ------------------------------
05:06:18   ap: 0.949177
05:06:18   auroc: 0.924414
05:06:18   hits@1: 0.287999
05:06:18   hits@10: 0.464902
05:06:18   hits@100: 0.653128
05:06:18   hits@20: 0.520662
05:06:18   hits@3: 0.360317
05:06:18   hits@50: 0.598358
05:06:18   mr: 720.189
05:06:18   mrr: 0.345678
05:06:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:06:18   Epoch 8 begin
05:08:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:08:01   binary cross entropy: 0.542848
05:10:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:10:40   Epoch 8 end
05:10:40   duration: 5.15 mins
05:10:40   speed: 0.50 batch / sec
05:10:40   ETA: 5.15 mins
05:10:40   max GPU memory: 47459.7 MiB
05:10:40   ------------------------------
05:10:40   average binary cross entropy: 0.50557
05:10:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:10:40   Epoch 9 begin
05:10:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:10:50   binary cross entropy: 0.589817
05:13:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:13:40   binary cross entropy: 0.467657
05:15:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:15:02   Epoch 9 end
05:15:02   duration: 4.37 mins
05:15:02   speed: 0.59 batch / sec
05:15:02   ETA: 0.00 secs
05:15:02   max GPU memory: 47459.7 MiB
05:15:02   ------------------------------
05:15:02   average binary cross entropy: 0.506609
05:15:02   Save checkpoint to model_epoch_10.pth
05:15:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:15:02   Evaluate on valid
05:15:49   ------------------------------
05:15:49   ap: 0.953176
05:15:49   auroc: 0.932171
05:15:49   hits@1: 0.286159
05:15:49   hits@10: 0.468299
05:15:49   hits@100: 0.656524
05:15:49   hits@20: 0.526606
05:15:49   hits@3: 0.363431
05:15:49   hits@50: 0.598217
05:15:49   mr: 706.652
05:15:49   mrr: 0.346371
05:15:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:15:49   Epoch 10 begin
05:17:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:17:15   binary cross entropy: 0.488944
05:20:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:20:05   binary cross entropy: 0.528953
05:20:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:20:11   Epoch 10 end
05:20:11   duration: 5.15 mins
05:20:11   speed: 0.50 batch / sec
05:20:11   ETA: 5.15 mins
05:20:11   max GPU memory: 47459.7 MiB
05:20:11   ------------------------------
05:20:11   average binary cross entropy: 0.507687
05:20:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:20:11   Epoch 11 begin
05:22:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:22:53   binary cross entropy: 0.488885
05:24:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:24:32   Epoch 11 end
05:24:32   duration: 4.36 mins
05:24:32   speed: 0.59 batch / sec
05:24:32   ETA: 0.00 secs
05:24:32   max GPU memory: 47459.7 MiB
05:24:32   ------------------------------
05:24:32   average binary cross entropy: 0.508772
05:24:32   Save checkpoint to model_epoch_12.pth
05:24:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:24:32   Evaluate on valid
05:25:19   ------------------------------
05:25:19   ap: 0.955226
05:25:19   auroc: 0.933574
05:25:19   hits@1: 0.282763
05:25:19   hits@10: 0.468582
05:25:19   hits@100: 0.654118
05:25:19   hits@20: 0.526465
05:25:19   hits@3: 0.357204
05:25:19   hits@50: 0.601472
05:25:19   mr: 721.694
05:25:19   mrr: 0.342458
05:25:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:25:19   Epoch 12 begin
05:26:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:26:29   binary cross entropy: 0.496642
05:29:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:29:18   binary cross entropy: 0.460623
05:29:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:29:41   Epoch 12 end
05:29:41   duration: 5.14 mins
05:29:41   speed: 0.50 batch / sec
05:29:41   ETA: 5.14 mins
05:29:41   max GPU memory: 47459.7 MiB
05:29:41   ------------------------------
05:29:41   average binary cross entropy: 0.507121
05:29:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:29:41   Epoch 13 begin
05:32:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:32:07   binary cross entropy: 0.536523
05:34:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:34:02   Epoch 13 end
05:34:02   duration: 4.36 mins
05:34:02   speed: 0.59 batch / sec
05:34:02   ETA: 0.00 secs
05:34:02   max GPU memory: 47459.7 MiB
05:34:02   ------------------------------
05:34:02   average binary cross entropy: 0.500395
05:34:02   Save checkpoint to model_epoch_14.pth
05:34:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:34:03   Evaluate on valid
05:34:50   ------------------------------
05:34:50   ap: 0.962292
05:34:50   auroc: 0.947812
05:34:50   hits@1: 0.289414
05:34:50   hits@10: 0.468016
05:34:50   hits@100: 0.660345
05:34:50   hits@20: 0.523917
05:34:50   hits@3: 0.369374
05:34:50   hits@50: 0.603878
05:34:50   mr: 709.331
05:34:50   mrr: 0.349239
05:34:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:34:50   Epoch 14 begin
05:35:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:35:42   binary cross entropy: 0.524102
05:38:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:38:32   binary cross entropy: 0.481199
05:39:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:39:11   Epoch 14 end
05:39:11   duration: 5.15 mins
05:39:11   speed: 0.50 batch / sec
05:39:11   ETA: 0.00 secs
05:39:11   max GPU memory: 47459.7 MiB
05:39:11   ------------------------------
05:39:11   average binary cross entropy: 0.502798
05:39:11   Save checkpoint to model_epoch_15.pth
05:39:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:39:11   Evaluate on valid
05:39:58   ------------------------------
05:39:58   ap: 0.958612
05:39:58   auroc: 0.939554
05:39:58   hits@1: 0.292952
05:39:58   hits@10: 0.468723
05:39:58   hits@100: 0.659213
05:39:58   hits@20: 0.524625
05:39:58   hits@3: 0.366544
05:39:58   hits@50: 0.601613
05:39:58   mr: 719.437
05:39:58   mrr: 0.350697
05:39:58   Load checkpoint from model_epoch_15.pth
05:39:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:39:59   Evaluate on valid
05:40:46   ------------------------------
05:40:46   ap: 0.958356
05:40:46   auroc: 0.939597
05:40:46   hits@1: 0.292952
05:40:46   hits@10: 0.468723
05:40:46   hits@100: 0.659213
05:40:46   hits@20: 0.524625
05:40:46   hits@3: 0.366544
05:40:46   hits@50: 0.601613
05:40:46   mr: 719.437
05:40:46   mrr: 0.350697
05:40:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:40:46   Evaluate on test
05:42:21   ------------------------------
05:42:21   ap: 0.959694
05:42:21   auroc: 0.942439
05:42:21   hits@1: 0.292807
05:42:21   hits@10: 0.467868
05:42:21   hits@100: 0.662363
05:42:21   hits@20: 0.52738
05:42:21   hits@3: 0.360477
05:42:21   hits@50: 0.606114
05:42:21   mr: 714.216
05:42:21   mrr: 0.349205
