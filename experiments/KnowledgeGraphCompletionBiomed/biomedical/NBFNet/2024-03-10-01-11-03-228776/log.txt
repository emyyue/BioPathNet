01:11:03   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-10-01-11-03-228776
01:11:03   Input Seed: 1234
01:11:03   Set Seed: 1234
01:11:03   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
01:11:03   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
01:11:03   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 393442
)
01:11:03   #train: 3274, #valid: 1184, #test: 2279
01:11:03   Preprocess training set
01:11:04   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(391163, 393442)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(386705, 389979)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(389979, 391163)}}
01:11:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:11:04   Epoch 0 begin
01:11:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:11:10   binary cross entropy: 0.724485
01:12:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:12:30   Epoch 0 end
01:12:30   duration: 1.44 mins
01:12:30   speed: 0.60 batch / sec
01:12:30   ETA: 1.44 mins
01:12:30   max GPU memory: 47415.3 MiB
01:12:30   ------------------------------
01:12:30   average binary cross entropy: 0.581771
01:12:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:12:30   Epoch 1 begin
01:13:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:49   binary cross entropy: 0.517781
01:13:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:52   Epoch 1 end
01:13:52   duration: 1.36 mins
01:13:52   speed: 0.64 batch / sec
01:13:52   ETA: 0.00 secs
01:13:52   max GPU memory: 47415.3 MiB
01:13:52   ------------------------------
01:13:52   average binary cross entropy: 0.531501
01:13:52   Save checkpoint to model_epoch_2.pth
01:13:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:52   Evaluate on valid
01:14:08   ------------------------------
01:14:08   ap: 0.996471
01:14:08   auroc: 0.995395
01:14:08   hits@1: 0.0777027
01:14:08   hits@10: 0.360642
01:14:08   hits@100: 0.691723
01:14:08   hits@20: 0.458193
01:14:08   hits@3: 0.189611
01:14:08   hits@50: 0.59924
01:14:08   mr: 676.389
01:14:08   mrr: 0.167213
01:14:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:14:08   Epoch 2 begin
01:15:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:15:30   Epoch 2 end
01:15:30   duration: 1.64 mins
01:15:30   speed: 0.53 batch / sec
01:15:30   ETA: 1.64 mins
01:15:30   max GPU memory: 47438.0 MiB
01:15:30   ------------------------------
01:15:30   average binary cross entropy: 0.529353
01:15:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:15:30   Epoch 3 begin
01:16:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:43   binary cross entropy: 0.445382
01:16:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:53   Epoch 3 end
01:16:53   duration: 1.37 mins
01:16:53   speed: 0.63 batch / sec
01:16:53   ETA: 0.00 secs
01:16:53   max GPU memory: 47438.0 MiB
01:16:53   ------------------------------
01:16:53   average binary cross entropy: 0.519183
01:16:53   Save checkpoint to model_epoch_4.pth
01:16:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:53   Evaluate on valid
01:17:09   ------------------------------
01:17:09   ap: 0.994872
01:17:09   auroc: 0.994331
01:17:09   hits@1: 0.0950169
01:17:09   hits@10: 0.35853
01:17:09   hits@100: 0.693834
01:17:09   hits@20: 0.455236
01:17:09   hits@3: 0.208193
01:17:09   hits@50: 0.593328
01:17:09   mr: 664.8
01:17:09   mrr: 0.182918
01:17:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:17:09   Epoch 4 begin
01:18:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:18:32   Epoch 4 end
01:18:32   duration: 1.65 mins
01:18:32   speed: 0.52 batch / sec
01:18:32   ETA: 1.65 mins
01:18:32   max GPU memory: 47438.0 MiB
01:18:32   ------------------------------
01:18:32   average binary cross entropy: 0.515166
01:18:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:18:32   Epoch 5 begin
01:19:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:19:38   binary cross entropy: 0.565829
01:19:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:19:54   Epoch 5 end
01:19:54   duration: 1.37 mins
01:19:54   speed: 0.63 batch / sec
01:19:54   ETA: 0.00 secs
01:19:54   max GPU memory: 47438.0 MiB
01:19:54   ------------------------------
01:19:54   average binary cross entropy: 0.510361
01:19:54   Save checkpoint to model_epoch_6.pth
01:19:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:19:54   Evaluate on valid
01:20:10   ------------------------------
01:20:10   ap: 0.994713
01:20:10   auroc: 0.993701
01:20:10   hits@1: 0.117399
01:20:10   hits@10: 0.388936
01:20:10   hits@100: 0.701436
01:20:10   hits@20: 0.472973
01:20:10   hits@3: 0.23902
01:20:10   hits@50: 0.61022
01:20:10   mr: 661.315
01:20:10   mrr: 0.209882
01:20:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:20:10   Epoch 6 begin
01:21:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:21:32   Epoch 6 end
01:21:32   duration: 1.63 mins
01:21:32   speed: 0.53 batch / sec
01:21:32   ETA: 1.63 mins
01:21:32   max GPU memory: 47438.0 MiB
01:21:32   ------------------------------
01:21:32   average binary cross entropy: 0.507115
01:21:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:21:32   Epoch 7 begin
01:22:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:22:32   binary cross entropy: 0.490488
01:22:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:22:55   Epoch 7 end
01:22:55   duration: 1.37 mins
01:22:55   speed: 0.63 batch / sec
01:22:55   ETA: 0.00 secs
01:22:55   max GPU memory: 47438.0 MiB
01:22:55   ------------------------------
01:22:55   average binary cross entropy: 0.507452
01:22:55   Save checkpoint to model_epoch_8.pth
01:22:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:22:55   Evaluate on valid
01:23:10   ------------------------------
01:23:10   ap: 0.995343
01:23:10   auroc: 0.994578
01:23:10   hits@1: 0.112331
01:23:10   hits@10: 0.382601
01:23:10   hits@100: 0.701436
01:23:10   hits@20: 0.467483
01:23:10   hits@3: 0.220861
01:23:10   hits@50: 0.603885
01:23:10   mr: 666.621
01:23:10   mrr: 0.200264
01:23:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:23:10   Epoch 8 begin
01:24:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:24:33   Epoch 8 end
01:24:33   duration: 1.64 mins
01:24:33   speed: 0.53 batch / sec
01:24:33   ETA: 1.64 mins
01:24:33   max GPU memory: 47438.0 MiB
01:24:33   ------------------------------
01:24:33   average binary cross entropy: 0.493097
01:24:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:24:33   Epoch 9 begin
01:25:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:25:26   binary cross entropy: 0.50793
01:25:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:25:55   Epoch 9 end
01:25:55   duration: 1.37 mins
01:25:55   speed: 0.63 batch / sec
01:25:55   ETA: 0.00 secs
01:25:55   max GPU memory: 47438.0 MiB
01:25:55   ------------------------------
01:25:55   average binary cross entropy: 0.50006
01:25:55   Save checkpoint to model_epoch_10.pth
01:25:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:25:55   Evaluate on valid
01:26:11   ------------------------------
01:26:11   ap: 0.996205
01:26:11   auroc: 0.995264
01:26:11   hits@1: 0.118666
01:26:11   hits@10: 0.386824
01:26:11   hits@100: 0.700591
01:26:11   hits@20: 0.47424
01:26:11   hits@3: 0.245355
01:26:11   hits@50: 0.603041
01:26:11   mr: 674.374
01:26:11   mrr: 0.210428
01:26:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:26:11   Epoch 10 begin
01:27:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:27:33   Epoch 10 end
01:27:33   duration: 1.63 mins
01:27:33   speed: 0.53 batch / sec
01:27:33   ETA: 1.63 mins
01:27:33   max GPU memory: 47438.0 MiB
01:27:33   ------------------------------
01:27:33   average binary cross entropy: 0.506196
01:27:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:27:33   Epoch 11 begin
01:28:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:20   binary cross entropy: 0.510668
01:28:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:56   Epoch 11 end
01:28:56   duration: 1.37 mins
01:28:56   speed: 0.63 batch / sec
01:28:56   ETA: 0.00 secs
01:28:56   max GPU memory: 47438.0 MiB
01:28:56   ------------------------------
01:28:56   average binary cross entropy: 0.495638
01:28:56   Save checkpoint to model_epoch_12.pth
01:28:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:56   Evaluate on valid
01:29:11   ------------------------------
01:29:11   ap: 0.995283
01:29:11   auroc: 0.993901
01:29:11   hits@1: 0.0865709
01:29:11   hits@10: 0.379645
01:29:11   hits@100: 0.706081
01:29:11   hits@20: 0.477196
01:29:11   hits@3: 0.216216
01:29:11   hits@50: 0.608108
01:29:11   mr: 676.24
01:29:11   mrr: 0.185249
01:29:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:29:11   Epoch 12 begin
01:30:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:30:35   Epoch 12 end
01:30:35   duration: 1.65 mins
01:30:35   speed: 0.52 batch / sec
01:30:35   ETA: 1.65 mins
01:30:35   max GPU memory: 47438.0 MiB
01:30:35   ------------------------------
01:30:35   average binary cross entropy: 0.499531
01:30:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:30:35   Epoch 13 begin
01:31:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:31:15   binary cross entropy: 0.491779
01:31:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:31:57   Epoch 13 end
01:31:57   duration: 1.37 mins
01:31:57   speed: 0.63 batch / sec
01:31:57   ETA: 0.00 secs
01:31:57   max GPU memory: 47438.0 MiB
01:31:57   ------------------------------
01:31:57   average binary cross entropy: 0.503813
01:31:57   Save checkpoint to model_epoch_14.pth
01:31:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:31:57   Evaluate on valid
01:32:13   ------------------------------
01:32:13   ap: 0.995588
01:32:13   auroc: 0.994624
01:32:13   hits@1: 0.109797
01:32:13   hits@10: 0.394003
01:32:13   hits@100: 0.710304
01:32:13   hits@20: 0.486064
01:32:13   hits@3: 0.235642
01:32:13   hits@50: 0.61022
01:32:13   mr: 670.622
01:32:13   mrr: 0.204614
01:32:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:32:13   Epoch 14 begin
01:33:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:35   Epoch 14 end
01:33:35   duration: 1.63 mins
01:33:35   speed: 0.53 batch / sec
01:33:35   ETA: 0.00 secs
01:33:35   max GPU memory: 47438.0 MiB
01:33:35   ------------------------------
01:33:35   average binary cross entropy: 0.486865
01:33:35   Save checkpoint to model_epoch_15.pth
01:33:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:35   Evaluate on valid
01:33:51   ------------------------------
01:33:51   ap: 0.994934
01:33:51   auroc: 0.994101
01:33:51   hits@1: 0.11951
01:33:51   hits@10: 0.398649
01:33:51   hits@100: 0.709882
01:33:51   hits@20: 0.486064
01:33:51   hits@3: 0.243666
01:33:51   hits@50: 0.608953
01:33:51   mr: 672.161
01:33:51   mrr: 0.213107
01:33:51   Load checkpoint from model_epoch_15.pth
01:33:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:51   Evaluate on valid
01:34:06   ------------------------------
01:34:06   ap: 0.993252
01:34:06   auroc: 0.992762
01:34:06   hits@1: 0.11951
01:34:06   hits@10: 0.398649
01:34:06   hits@100: 0.709882
01:34:06   hits@20: 0.486064
01:34:06   hits@3: 0.243666
01:34:06   hits@50: 0.608953
01:34:06   mr: 672.161
01:34:06   mrr: 0.213107
01:34:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:34:06   Evaluate on test
01:34:36   ------------------------------
01:34:36   ap: 0.993831
01:34:36   auroc: 0.992816
01:34:36   hits@1: 0.101141
01:34:36   hits@10: 0.390961
01:34:36   hits@100: 0.726635
01:34:36   hits@20: 0.491224
01:34:36   hits@3: 0.222685
01:34:36   hits@50: 0.629662
01:34:36   mr: 630.219
01:34:36   mrr: 0.197978
