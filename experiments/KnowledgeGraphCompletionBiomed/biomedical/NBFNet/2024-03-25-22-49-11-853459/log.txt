22:49:11   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-25-22-49-11-853459
22:49:11   Input Seed: 1237
22:49:11   Set Seed: 1237
22:49:11   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
22:49:11   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr070/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
22:49:12   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 389547
)
22:49:12   #train: 2137, #valid: 764, #test: 1556
22:49:12   Preprocess training set
22:49:12   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr070/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(387991, 389547)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr070/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(385090, 387227)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr070/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(387227, 387991)}}
22:49:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:49:12   Epoch 0 begin
22:49:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:49:15   binary cross entropy: 0.678934
22:50:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:50:06   Epoch 0 end
22:50:06   duration: 53.89 secs
22:50:06   speed: 0.63 batch / sec
22:50:06   ETA: 53.89 secs
22:50:06   max GPU memory: 47413.6 MiB
22:50:06   ------------------------------
22:50:06   average binary cross entropy: 0.603217
22:50:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:50:06   Epoch 1 begin
22:50:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:50:59   Epoch 1 end
22:50:59   duration: 53.22 secs
22:50:59   speed: 0.64 batch / sec
22:50:59   ETA: 0.00 secs
22:50:59   max GPU memory: 47413.6 MiB
22:50:59   ------------------------------
22:50:59   average binary cross entropy: 0.566686
22:50:59   Save checkpoint to model_epoch_2.pth
22:51:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:51:00   Evaluate on valid
22:51:10   ------------------------------
22:51:10   ap: 0.994288
22:51:10   auroc: 0.992488
22:51:10   hits@1: 0.0772251
22:51:10   hits@10: 0.313482
22:51:10   hits@100: 0.782068
22:51:10   hits@20: 0.44699
22:51:10   hits@3: 0.16623
22:51:10   hits@50: 0.640052
22:51:10   mr: 201.698
22:51:10   mrr: 0.15822
22:51:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:51:10   Epoch 2 begin
22:52:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:52:03   binary cross entropy: 0.568858
22:52:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:52:04   Epoch 2 end
22:52:04   duration: 1.08 mins
22:52:04   speed: 0.53 batch / sec
22:52:04   ETA: 1.08 mins
22:52:04   max GPU memory: 47436.0 MiB
22:52:04   ------------------------------
22:52:04   average binary cross entropy: 0.564272
22:52:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:52:04   Epoch 3 begin
22:52:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:52:59   Epoch 3 end
22:52:59   duration: 55.05 secs
22:52:59   speed: 0.62 batch / sec
22:52:59   ETA: 0.00 secs
22:52:59   max GPU memory: 47436.0 MiB
22:52:59   ------------------------------
22:52:59   average binary cross entropy: 0.553772
22:52:59   Save checkpoint to model_epoch_4.pth
22:52:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:52:59   Evaluate on valid
22:53:09   ------------------------------
22:53:09   ap: 0.994183
22:53:09   auroc: 0.991565
22:53:09   hits@1: 0.0942408
22:53:09   hits@10: 0.342932
22:53:09   hits@100: 0.792539
22:53:09   hits@20: 0.464005
22:53:09   hits@3: 0.191754
22:53:09   hits@50: 0.657068
22:53:09   mr: 190.508
22:53:09   mrr: 0.178777
22:53:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:53:09   Epoch 4 begin
22:54:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:54:04   Epoch 4 end
22:54:04   duration: 1.08 mins
22:54:04   speed: 0.53 batch / sec
22:54:04   ETA: 1.08 mins
22:54:04   max GPU memory: 47436.0 MiB
22:54:04   ------------------------------
22:54:04   average binary cross entropy: 0.545895
22:54:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:54:04   Epoch 5 begin
22:54:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:54:54   binary cross entropy: 0.550812
22:54:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:54:58   Epoch 5 end
22:54:58   duration: 54.48 secs
22:54:58   speed: 0.62 batch / sec
22:54:58   ETA: 0.00 secs
22:54:58   max GPU memory: 47436.0 MiB
22:54:58   ------------------------------
22:54:58   average binary cross entropy: 0.54392
22:54:58   Save checkpoint to model_epoch_6.pth
22:54:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:54:58   Evaluate on valid
22:55:08   ------------------------------
22:55:08   ap: 0.994604
22:55:08   auroc: 0.991831
22:55:08   hits@1: 0.0948953
22:55:08   hits@10: 0.356675
22:55:08   hits@100: 0.80301
22:55:08   hits@20: 0.479712
22:55:08   hits@3: 0.189136
22:55:08   hits@50: 0.666885
22:55:08   mr: 182.416
22:55:08   mrr: 0.178617
22:55:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:55:08   Epoch 6 begin
22:56:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:56:03   Epoch 6 end
22:56:03   duration: 1.08 mins
22:56:03   speed: 0.53 batch / sec
22:56:03   ETA: 1.08 mins
22:56:03   max GPU memory: 47436.0 MiB
22:56:03   ------------------------------
22:56:03   average binary cross entropy: 0.537892
22:56:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:56:03   Epoch 7 begin
22:56:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:56:57   Epoch 7 end
22:56:57   duration: 54.46 secs
22:56:57   speed: 0.62 batch / sec
22:56:57   ETA: 0.00 secs
22:56:57   max GPU memory: 47436.0 MiB
22:56:57   ------------------------------
22:56:57   average binary cross entropy: 0.54114
22:56:57   Save checkpoint to model_epoch_8.pth
22:56:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:56:57   Evaluate on valid
22:57:07   ------------------------------
22:57:07   ap: 0.994456
22:57:07   auroc: 0.991287
22:57:07   hits@1: 0.0922775
22:57:07   hits@10: 0.354058
22:57:07   hits@100: 0.808246
22:57:07   hits@20: 0.484293
22:57:07   hits@3: 0.196335
22:57:07   hits@50: 0.655105
22:57:07   mr: 177.859
22:57:07   mrr: 0.181279
22:57:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:57:07   Epoch 8 begin
22:57:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:57:55   binary cross entropy: 0.600969
22:58:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:58:02   Epoch 8 end
22:58:02   duration: 1.08 mins
22:58:02   speed: 0.53 batch / sec
22:58:02   ETA: 1.08 mins
22:58:02   max GPU memory: 47436.0 MiB
22:58:02   ------------------------------
22:58:02   average binary cross entropy: 0.540333
22:58:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:58:02   Epoch 9 begin
22:58:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:58:56   Epoch 9 end
22:58:56   duration: 54.39 secs
22:58:56   speed: 0.63 batch / sec
22:58:56   ETA: 0.00 secs
22:58:56   max GPU memory: 47436.0 MiB
22:58:56   ------------------------------
22:58:56   average binary cross entropy: 0.526077
22:58:56   Save checkpoint to model_epoch_10.pth
22:58:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:58:56   Evaluate on valid
22:59:06   ------------------------------
22:59:06   ap: 0.996384
22:59:06   auroc: 0.994332
22:59:06   hits@1: 0.100785
22:59:06   hits@10: 0.366492
22:59:06   hits@100: 0.799084
22:59:06   hits@20: 0.493455
22:59:06   hits@3: 0.196335
22:59:06   hits@50: 0.668194
22:59:06   mr: 181.093
22:59:06   mrr: 0.187008
22:59:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:59:06   Epoch 10 begin
23:00:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:00:01   Epoch 10 end
23:00:01   duration: 1.08 mins
23:00:01   speed: 0.53 batch / sec
23:00:01   ETA: 1.08 mins
23:00:01   max GPU memory: 47436.0 MiB
23:00:01   ------------------------------
23:00:01   average binary cross entropy: 0.533217
23:00:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:00:01   Epoch 11 begin
23:00:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:00:45   binary cross entropy: 0.592866
23:00:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:00:55   Epoch 11 end
23:00:55   duration: 54.40 secs
23:00:55   speed: 0.63 batch / sec
23:00:55   ETA: 0.00 secs
23:00:55   max GPU memory: 47436.0 MiB
23:00:55   ------------------------------
23:00:55   average binary cross entropy: 0.54023
23:00:55   Save checkpoint to model_epoch_12.pth
23:00:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:00:55   Evaluate on valid
23:01:05   ------------------------------
23:01:05   ap: 0.994837
23:01:05   auroc: 0.992302
23:01:05   hits@1: 0.102749
23:01:05   hits@10: 0.364529
23:01:05   hits@100: 0.812173
23:01:05   hits@20: 0.492147
23:01:05   hits@3: 0.192408
23:01:05   hits@50: 0.670812
23:01:05   mr: 176.272
23:01:05   mrr: 0.184963
23:01:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:01:05   Epoch 12 begin
23:02:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:02:00   Epoch 12 end
23:02:00   duration: 1.08 mins
23:02:00   speed: 0.53 batch / sec
23:02:00   ETA: 1.08 mins
23:02:00   max GPU memory: 47436.0 MiB
23:02:00   ------------------------------
23:02:00   average binary cross entropy: 0.536062
23:02:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:02:00   Epoch 13 begin
23:02:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:02:54   Epoch 13 end
23:02:54   duration: 54.37 secs
23:02:54   speed: 0.63 batch / sec
23:02:54   ETA: 0.00 secs
23:02:54   max GPU memory: 47436.0 MiB
23:02:54   ------------------------------
23:02:54   average binary cross entropy: 0.525646
23:02:54   Save checkpoint to model_epoch_14.pth
23:02:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:02:54   Evaluate on valid
23:03:04   ------------------------------
23:03:04   ap: 0.992259
23:03:04   auroc: 0.99037
23:03:04   hits@1: 0.102094
23:03:04   hits@10: 0.354058
23:03:04   hits@100: 0.806937
23:03:04   hits@20: 0.486257
23:03:04   hits@3: 0.194372
23:03:04   hits@50: 0.670812
23:03:04   mr: 174.274
23:03:04   mrr: 0.185944
23:03:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:03:04   Epoch 14 begin
23:03:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:03:45   binary cross entropy: 0.54889
23:03:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:03:59   Epoch 14 end
23:03:59   duration: 1.08 mins
23:03:59   speed: 0.53 batch / sec
23:03:59   ETA: 0.00 secs
23:03:59   max GPU memory: 47436.0 MiB
23:03:59   ------------------------------
23:03:59   average binary cross entropy: 0.520826
23:03:59   Save checkpoint to model_epoch_15.pth
23:03:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:03:59   Evaluate on valid
23:04:09   ------------------------------
23:04:09   ap: 0.989732
23:04:09   auroc: 0.985776
23:04:09   hits@1: 0.114529
23:04:09   hits@10: 0.368455
23:04:09   hits@100: 0.815445
23:04:09   hits@20: 0.496728
23:04:09   hits@3: 0.20288
23:04:09   hits@50: 0.674738
23:04:09   mr: 175.557
23:04:09   mrr: 0.197433
23:04:09   Load checkpoint from model_epoch_15.pth
23:04:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:04:09   Evaluate on valid
23:04:19   ------------------------------
23:04:19   ap: 0.989054
23:04:19   auroc: 0.98525
23:04:19   hits@1: 0.114529
23:04:19   hits@10: 0.368455
23:04:19   hits@100: 0.815445
23:04:19   hits@20: 0.496728
23:04:19   hits@3: 0.20288
23:04:19   hits@50: 0.674738
23:04:19   mr: 175.557
23:04:19   mrr: 0.197433
23:04:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:04:19   Evaluate on test
23:04:40   ------------------------------
23:04:40   ap: 0.988232
23:04:40   auroc: 0.983217
23:04:40   hits@1: 0.107648
23:04:40   hits@10: 0.364717
23:04:40   hits@100: 0.81973
23:04:40   hits@20: 0.496144
23:04:40   hits@3: 0.205977
23:04:40   hits@50: 0.682841
23:04:40   mr: 202.665
23:04:40   mrr: 0.193562
