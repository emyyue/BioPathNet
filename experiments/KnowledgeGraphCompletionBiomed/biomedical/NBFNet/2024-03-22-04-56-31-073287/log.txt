04:56:31   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-22-04-56-31-073287
04:56:31   Input Seed: 1237
04:56:31   Set Seed: 1237
04:56:31   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
04:56:31   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
04:56:31   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 417079
)
04:56:31   #train: 9878, #valid: 3533, #test: 7049
04:56:31   Preprocess training set
04:56:32   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(410030, 417079)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(396619, 406497)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(406497, 410030)}}
04:56:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:56:32   Epoch 0 begin
04:56:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:56:34   binary cross entropy: 0.686124
04:59:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:59:23   binary cross entropy: 0.629184
05:00:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:00:53   Epoch 0 end
05:00:53   duration: 4.35 mins
05:00:53   speed: 0.59 batch / sec
05:00:53   ETA: 4.35 mins
05:00:53   max GPU memory: 47438.5 MiB
05:00:53   ------------------------------
05:00:53   average binary cross entropy: 0.576817
05:00:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:00:53   Epoch 1 begin
05:02:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:02:10   binary cross entropy: 0.535864
05:04:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:04:59   binary cross entropy: 0.497118
05:05:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:05:13   Epoch 1 end
05:05:13   duration: 4.34 mins
05:05:13   speed: 0.60 batch / sec
05:05:13   ETA: 0.00 secs
05:05:13   max GPU memory: 47438.5 MiB
05:05:13   ------------------------------
05:05:13   average binary cross entropy: 0.536097
05:05:13   Save checkpoint to model_epoch_2.pth
05:05:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:05:13   Evaluate on valid
05:06:00   ------------------------------
05:06:00   ap: 0.978399
05:06:00   auroc: 0.969024
05:06:00   hits@1: 0.262949
05:06:00   hits@10: 0.452024
05:06:00   hits@100: 0.640674
05:06:00   hits@20: 0.505095
05:06:00   hits@3: 0.340079
05:06:00   hits@50: 0.583923
05:06:00   mr: 812.968
05:06:00   mrr: 0.323234
05:06:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:06:00   Epoch 2 begin
05:08:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:08:34   binary cross entropy: 0.523907
05:10:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:10:22   Epoch 2 end
05:10:22   duration: 5.14 mins
05:10:22   speed: 0.50 batch / sec
05:10:22   ETA: 5.14 mins
05:10:22   max GPU memory: 47461.3 MiB
05:10:22   ------------------------------
05:10:22   average binary cross entropy: 0.523773
05:10:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:10:22   Epoch 3 begin
05:11:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:11:23   binary cross entropy: 0.503126
05:14:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:14:12   binary cross entropy: 0.492996
05:14:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:14:43   Epoch 3 end
05:14:43   duration: 4.36 mins
05:14:43   speed: 0.59 batch / sec
05:14:43   ETA: 0.00 secs
05:14:43   max GPU memory: 47461.3 MiB
05:14:43   ------------------------------
05:14:43   average binary cross entropy: 0.520687
05:14:43   Save checkpoint to model_epoch_4.pth
05:14:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:14:43   Evaluate on valid
05:15:30   ------------------------------
05:15:30   ap: 0.982666
05:15:30   auroc: 0.974892
05:15:30   hits@1: 0.27512
05:15:30   hits@10: 0.456977
05:15:30   hits@100: 0.651995
05:15:30   hits@20: 0.513303
05:15:30   hits@3: 0.35593
05:15:30   hits@50: 0.59199
05:15:30   mr: 770.746
05:15:30   mrr: 0.335766
05:15:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:15:30   Epoch 4 begin
05:17:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:17:47   binary cross entropy: 0.530633
05:19:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:19:51   Epoch 4 end
05:19:51   duration: 5.14 mins
05:19:51   speed: 0.50 batch / sec
05:19:51   ETA: 5.14 mins
05:19:51   max GPU memory: 47461.3 MiB
05:19:52   ------------------------------
05:19:52   average binary cross entropy: 0.517016
05:19:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:19:52   Epoch 5 begin
05:20:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:20:36   binary cross entropy: 0.624396
05:23:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:23:25   binary cross entropy: 0.494783
05:24:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:24:13   Epoch 5 end
05:24:13   duration: 4.36 mins
05:24:13   speed: 0.59 batch / sec
05:24:13   ETA: 0.00 secs
05:24:13   max GPU memory: 47461.3 MiB
05:24:13   ------------------------------
05:24:13   average binary cross entropy: 0.516815
05:24:13   Save checkpoint to model_epoch_6.pth
05:24:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:24:13   Evaluate on valid
05:25:00   ------------------------------
05:25:00   ap: 0.988017
05:25:00   auroc: 0.983575
05:25:00   hits@1: 0.282763
05:25:00   hits@10: 0.461223
05:25:00   hits@100: 0.650156
05:25:00   hits@20: 0.516134
05:25:00   hits@3: 0.358053
05:25:00   hits@50: 0.594113
05:25:00   mr: 753.09
05:25:00   mrr: 0.341466
05:25:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:25:00   Epoch 6 begin
05:26:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:27:00   binary cross entropy: 0.482354
05:29:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:29:21   Epoch 6 end
05:29:21   duration: 5.14 mins
05:29:21   speed: 0.50 batch / sec
05:29:21   ETA: 5.14 mins
05:29:21   max GPU memory: 47461.3 MiB
05:29:21   ------------------------------
05:29:21   average binary cross entropy: 0.511755
05:29:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:29:21   Epoch 7 begin
05:29:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:29:48   binary cross entropy: 0.451868
05:32:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:32:38   binary cross entropy: 0.532595
05:33:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:33:43   Epoch 7 end
05:33:43   duration: 4.36 mins
05:33:43   speed: 0.59 batch / sec
05:33:43   ETA: 0.00 secs
05:33:43   max GPU memory: 47461.3 MiB
05:33:43   ------------------------------
05:33:43   average binary cross entropy: 0.511594
05:33:43   Save checkpoint to model_epoch_8.pth
05:33:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:33:43   Evaluate on valid
05:34:30   ------------------------------
05:34:30   ap: 0.982185
05:34:30   auroc: 0.973151
05:34:30   hits@1: 0.284036
05:34:30   hits@10: 0.464478
05:34:30   hits@100: 0.655109
05:34:30   hits@20: 0.51953
05:34:30   hits@3: 0.360317
05:34:30   hits@50: 0.594962
05:34:30   mr: 738.602
05:34:30   mrr: 0.343374
05:34:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:34:30   Epoch 8 begin
05:36:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:36:13   binary cross entropy: 0.499732
05:38:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:38:51   Epoch 8 end
05:38:51   duration: 5.14 mins
05:38:51   speed: 0.50 batch / sec
05:38:51   ETA: 5.14 mins
05:38:51   max GPU memory: 47461.3 MiB
05:38:51   ------------------------------
05:38:51   average binary cross entropy: 0.508679
05:38:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:38:51   Epoch 9 begin
05:39:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:39:01   binary cross entropy: 0.613356
05:41:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:41:50   binary cross entropy: 0.529646
05:43:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:43:12   Epoch 9 end
05:43:12   duration: 4.35 mins
05:43:12   speed: 0.59 batch / sec
05:43:12   ETA: 0.00 secs
05:43:12   max GPU memory: 47461.3 MiB
05:43:12   ------------------------------
05:43:12   average binary cross entropy: 0.511151
05:43:12   Save checkpoint to model_epoch_10.pth
05:43:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:43:12   Evaluate on valid
05:43:59   ------------------------------
05:43:59   ap: 0.978425
05:43:59   auroc: 0.967112
05:43:59   hits@1: 0.290829
05:43:59   hits@10: 0.466601
05:43:59   hits@100: 0.654826
05:43:59   hits@20: 0.521087
05:43:59   hits@3: 0.367818
05:43:59   hits@50: 0.597085
05:43:59   mr: 738.665
05:43:59   mrr: 0.349313
05:43:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:43:59   Epoch 10 begin
05:45:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:45:26   binary cross entropy: 0.541332
05:48:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:48:15   binary cross entropy: 0.539705
05:48:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:48:21   Epoch 10 end
05:48:21   duration: 5.14 mins
05:48:21   speed: 0.50 batch / sec
05:48:21   ETA: 5.14 mins
05:48:21   max GPU memory: 47461.3 MiB
05:48:21   ------------------------------
05:48:21   average binary cross entropy: 0.510798
05:48:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:48:21   Epoch 11 begin
05:51:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:51:03   binary cross entropy: 0.458413
05:52:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:52:42   Epoch 11 end
05:52:42   duration: 4.36 mins
05:52:42   speed: 0.59 batch / sec
05:52:42   ETA: 0.00 secs
05:52:42   max GPU memory: 47461.3 MiB
05:52:42   ------------------------------
05:52:42   average binary cross entropy: 0.504127
05:52:42   Save checkpoint to model_epoch_12.pth
05:52:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:52:42   Evaluate on valid
05:53:29   ------------------------------
05:53:29   ap: 0.978359
05:53:29   auroc: 0.967793
05:53:29   hits@1: 0.284885
05:53:29   hits@10: 0.467874
05:53:29   hits@100: 0.656383
05:53:29   hits@20: 0.523634
05:53:29   hits@3: 0.365836
05:53:29   hits@50: 0.597368
05:53:29   mr: 733.195
05:53:29   mrr: 0.345653
05:53:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:53:29   Epoch 12 begin
05:54:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:54:38   binary cross entropy: 0.46993
05:57:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:57:27   binary cross entropy: 0.426385
05:57:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:57:50   Epoch 12 end
05:57:50   duration: 5.14 mins
05:57:50   speed: 0.50 batch / sec
05:57:50   ETA: 5.14 mins
05:57:50   max GPU memory: 47461.3 MiB
05:57:50   ------------------------------
05:57:50   average binary cross entropy: 0.505176
05:57:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:57:50   Epoch 13 begin
06:00:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:00:16   binary cross entropy: 0.532878
06:02:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:02:13   Epoch 13 end
06:02:13   duration: 4.37 mins
06:02:13   speed: 0.59 batch / sec
06:02:13   ETA: 0.00 secs
06:02:13   max GPU memory: 47461.3 MiB
06:02:13   ------------------------------
06:02:13   average binary cross entropy: 0.500756
06:02:13   Save checkpoint to model_epoch_14.pth
06:02:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:02:14   Evaluate on valid
06:03:00   ------------------------------
06:03:00   ap: 0.980359
06:03:00   auroc: 0.970156
06:03:00   hits@1: 0.289556
06:03:00   hits@10: 0.468723
06:03:00   hits@100: 0.660204
06:03:00   hits@20: 0.522078
06:03:00   hits@3: 0.363431
06:03:00   hits@50: 0.599632
06:03:00   mr: 729.878
06:03:00   mrr: 0.34738
06:03:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:03:00   Epoch 14 begin
06:03:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:03:53   binary cross entropy: 0.482798
06:06:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:06:42   binary cross entropy: 0.466087
06:07:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:07:22   Epoch 14 end
06:07:22   duration: 5.16 mins
06:07:22   speed: 0.50 batch / sec
06:07:22   ETA: 0.00 secs
06:07:22   max GPU memory: 47461.3 MiB
06:07:22   ------------------------------
06:07:22   average binary cross entropy: 0.502491
06:07:22   Save checkpoint to model_epoch_15.pth
06:07:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:07:22   Evaluate on valid
06:08:09   ------------------------------
06:08:09   ap: 0.979868
06:08:09   auroc: 0.969544
06:08:09   hits@1: 0.287433
06:08:09   hits@10: 0.461647
06:08:09   hits@100: 0.65525
06:08:09   hits@20: 0.518964
06:08:09   hits@3: 0.361732
06:08:09   hits@50: 0.595103
06:08:09   mr: 734.854
06:08:09   mrr: 0.345388
06:08:09   Load checkpoint from model_epoch_10.pth
06:08:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:08:09   Evaluate on valid
06:08:56   ------------------------------
06:08:56   ap: 0.978598
06:08:56   auroc: 0.967116
06:08:56   hits@1: 0.290829
06:08:56   hits@10: 0.466601
06:08:56   hits@100: 0.654826
06:08:56   hits@20: 0.521087
06:08:56   hits@3: 0.367818
06:08:56   hits@50: 0.597085
06:08:56   mr: 738.665
06:08:56   mrr: 0.349313
06:08:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:08:56   Evaluate on test
06:10:30   ------------------------------
06:10:30   ap: 0.979855
06:10:30   auroc: 0.970024
06:10:30   hits@1: 0.291602
06:10:30   hits@10: 0.467442
06:10:30   hits@100: 0.657611
06:10:30   hits@20: 0.522202
06:10:30   hits@3: 0.366861
06:10:30   hits@50: 0.599943
06:10:30   mr: 740.41
06:10:30   mrr: 0.349548
