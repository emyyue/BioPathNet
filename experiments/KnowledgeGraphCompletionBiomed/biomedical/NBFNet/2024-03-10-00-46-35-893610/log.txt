00:46:35   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-10-00-46-35-893610
00:46:36   Input Seed: 1237
00:46:36   Set Seed: 1237
00:46:36   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
00:46:36   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
00:46:36   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 393442
)
00:46:36   #train: 3274, #valid: 1184, #test: 2279
00:46:36   Preprocess training set
00:46:37   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(391163, 393442)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(386705, 389979)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(389979, 391163)}}
00:46:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:46:37   Epoch 0 begin
00:46:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:46:39   binary cross entropy: 0.680438
00:47:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:47:59   Epoch 0 end
00:47:59   duration: 1.38 mins
00:47:59   speed: 0.63 batch / sec
00:47:59   ETA: 1.38 mins
00:47:59   max GPU memory: 47416.4 MiB
00:47:59   ------------------------------
00:47:59   average binary cross entropy: 0.577568
00:47:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:47:59   Epoch 1 begin
00:49:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:49:18   binary cross entropy: 0.543474
00:49:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:49:21   Epoch 1 end
00:49:21   duration: 1.37 mins
00:49:21   speed: 0.63 batch / sec
00:49:21   ETA: 0.00 secs
00:49:21   max GPU memory: 47416.4 MiB
00:49:21   ------------------------------
00:49:21   average binary cross entropy: 0.525153
00:49:21   Save checkpoint to model_epoch_2.pth
00:49:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:49:22   Evaluate on valid
00:49:37   ------------------------------
00:49:37   ap: 0.990682
00:49:37   auroc: 0.990174
00:49:37   hits@1: 0.0625
00:49:37   hits@10: 0.339949
00:49:37   hits@100: 0.689611
00:49:37   hits@20: 0.44299
00:49:37   hits@3: 0.179054
00:49:37   hits@50: 0.584459
00:49:37   mr: 718.634
00:49:37   mrr: 0.153227
00:49:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:49:37   Epoch 2 begin
00:51:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:51:00   Epoch 2 end
00:51:00   duration: 1.65 mins
00:51:00   speed: 0.52 batch / sec
00:51:00   ETA: 1.65 mins
00:51:00   max GPU memory: 47438.6 MiB
00:51:00   ------------------------------
00:51:00   average binary cross entropy: 0.528942
00:51:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:51:00   Epoch 3 begin
00:52:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:52:13   binary cross entropy: 0.445804
00:52:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:52:24   Epoch 3 end
00:52:24   duration: 1.38 mins
00:52:24   speed: 0.63 batch / sec
00:52:24   ETA: 0.00 secs
00:52:24   max GPU memory: 47438.6 MiB
00:52:24   ------------------------------
00:52:24   average binary cross entropy: 0.516493
00:52:24   Save checkpoint to model_epoch_4.pth
00:52:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:52:24   Evaluate on valid
00:52:39   ------------------------------
00:52:39   ap: 0.995079
00:52:39   auroc: 0.993955
00:52:39   hits@1: 0.0912162
00:52:39   hits@10: 0.376267
00:52:39   hits@100: 0.695101
00:52:39   hits@20: 0.462838
00:52:39   hits@3: 0.210726
00:52:39   hits@50: 0.594172
00:52:39   mr: 701.29
00:52:39   mrr: 0.186161
00:52:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:52:39   Epoch 4 begin
00:54:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:54:03   Epoch 4 end
00:54:03   duration: 1.65 mins
00:54:03   speed: 0.53 batch / sec
00:54:03   ETA: 1.65 mins
00:54:03   max GPU memory: 47438.6 MiB
00:54:03   ------------------------------
00:54:03   average binary cross entropy: 0.507416
00:54:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:54:03   Epoch 5 begin
00:55:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:55:09   binary cross entropy: 0.491814
00:55:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:55:26   Epoch 5 end
00:55:26   duration: 1.38 mins
00:55:26   speed: 0.63 batch / sec
00:55:26   ETA: 0.00 secs
00:55:26   max GPU memory: 47438.6 MiB
00:55:26   ------------------------------
00:55:26   average binary cross entropy: 0.508944
00:55:26   Save checkpoint to model_epoch_6.pth
00:55:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:55:26   Evaluate on valid
00:55:42   ------------------------------
00:55:42   ap: 0.995881
00:55:42   auroc: 0.994742
00:55:42   hits@1: 0.0886824
00:55:42   hits@10: 0.383868
00:55:42   hits@100: 0.696368
00:55:42   hits@20: 0.465372
00:55:42   hits@3: 0.208615
00:55:42   hits@50: 0.595439
00:55:42   mr: 680.392
00:55:42   mrr: 0.182653
00:55:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:55:42   Epoch 6 begin
00:57:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:57:05   Epoch 6 end
00:57:05   duration: 1.66 mins
00:57:05   speed: 0.52 batch / sec
00:57:05   ETA: 1.66 mins
00:57:05   max GPU memory: 47438.6 MiB
00:57:05   ------------------------------
00:57:05   average binary cross entropy: 0.50876
00:57:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:57:05   Epoch 7 begin
00:58:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:58:05   binary cross entropy: 0.452568
00:58:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:58:28   Epoch 7 end
00:58:28   duration: 1.38 mins
00:58:28   speed: 0.63 batch / sec
00:58:28   ETA: 0.00 secs
00:58:28   max GPU memory: 47438.6 MiB
00:58:28   ------------------------------
00:58:28   average binary cross entropy: 0.498945
00:58:28   Save checkpoint to model_epoch_8.pth
00:58:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:58:28   Evaluate on valid
00:58:44   ------------------------------
00:58:44   ap: 0.996436
00:58:44   auroc: 0.995091
00:58:44   hits@1: 0.109375
00:58:44   hits@10: 0.39147
00:58:44   hits@100: 0.688767
00:58:44   hits@20: 0.478463
00:58:44   hits@3: 0.236064
00:58:44   hits@50: 0.601351
00:58:44   mr: 666.228
00:58:44   mrr: 0.204014
00:58:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:58:44   Epoch 8 begin
01:00:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:00:07   Epoch 8 end
01:00:07   duration: 1.65 mins
01:00:07   speed: 0.53 batch / sec
01:00:07   ETA: 1.65 mins
01:00:07   max GPU memory: 47438.6 MiB
01:00:07   ------------------------------
01:00:07   average binary cross entropy: 0.494147
01:00:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:00:07   Epoch 9 begin
01:00:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:01:01   binary cross entropy: 0.466495
01:01:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:01:30   Epoch 9 end
01:01:30   duration: 1.38 mins
01:01:30   speed: 0.63 batch / sec
01:01:30   ETA: 0.00 secs
01:01:30   max GPU memory: 47438.6 MiB
01:01:30   ------------------------------
01:01:30   average binary cross entropy: 0.499639
01:01:30   Save checkpoint to model_epoch_10.pth
01:01:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:01:30   Evaluate on valid
01:01:46   ------------------------------
01:01:46   ap: 0.996086
01:01:46   auroc: 0.995111
01:01:46   hits@1: 0.110642
01:01:46   hits@10: 0.38598
01:01:46   hits@100: 0.698902
01:01:46   hits@20: 0.469595
01:01:46   hits@3: 0.214105
01:01:46   hits@50: 0.592483
01:01:46   mr: 660.77
01:01:46   mrr: 0.197938
01:01:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:01:46   Epoch 10 begin
01:03:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:03:09   Epoch 10 end
01:03:09   duration: 1.65 mins
01:03:09   speed: 0.52 batch / sec
01:03:09   ETA: 1.65 mins
01:03:09   max GPU memory: 47438.6 MiB
01:03:09   ------------------------------
01:03:09   average binary cross entropy: 0.497952
01:03:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:03:09   Epoch 11 begin
01:03:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:03:56   binary cross entropy: 0.514573
01:04:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:04:32   Epoch 11 end
01:04:32   duration: 1.38 mins
01:04:32   speed: 0.63 batch / sec
01:04:32   ETA: 0.00 secs
01:04:32   max GPU memory: 47438.6 MiB
01:04:32   ------------------------------
01:04:32   average binary cross entropy: 0.497147
01:04:32   Save checkpoint to model_epoch_12.pth
01:04:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:04:32   Evaluate on valid
01:04:48   ------------------------------
01:04:48   ap: 0.995641
01:04:48   auroc: 0.99413
01:04:48   hits@1: 0.102196
01:04:48   hits@10: 0.387247
01:04:48   hits@100: 0.698902
01:04:48   hits@20: 0.477196
01:04:48   hits@3: 0.224662
01:04:48   hits@50: 0.607686
01:04:48   mr: 673.888
01:04:48   mrr: 0.195066
01:04:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:04:48   Epoch 12 begin
01:06:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:06:11   Epoch 12 end
01:06:11   duration: 1.65 mins
01:06:11   speed: 0.53 batch / sec
01:06:11   ETA: 1.65 mins
01:06:11   max GPU memory: 47438.6 MiB
01:06:11   ------------------------------
01:06:11   average binary cross entropy: 0.499218
01:06:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:06:11   Epoch 13 begin
01:06:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:06:52   binary cross entropy: 0.477337
01:07:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:07:34   Epoch 13 end
01:07:34   duration: 1.38 mins
01:07:34   speed: 0.63 batch / sec
01:07:34   ETA: 0.00 secs
01:07:34   max GPU memory: 47438.6 MiB
01:07:34   ------------------------------
01:07:34   average binary cross entropy: 0.500783
01:07:34   Save checkpoint to model_epoch_14.pth
01:07:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:07:34   Evaluate on valid
01:07:50   ------------------------------
01:07:50   ap: 0.993947
01:07:50   auroc: 0.991942
01:07:50   hits@1: 0.120355
01:07:50   hits@10: 0.399071
01:07:50   hits@100: 0.708193
01:07:50   hits@20: 0.48522
01:07:50   hits@3: 0.251267
01:07:50   hits@50: 0.61022
01:07:50   mr: 665.718
01:07:50   mrr: 0.215434
01:07:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:07:50   Epoch 14 begin
01:09:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:09:13   Epoch 14 end
01:09:13   duration: 1.65 mins
01:09:13   speed: 0.53 batch / sec
01:09:13   ETA: 0.00 secs
01:09:13   max GPU memory: 47438.6 MiB
01:09:13   ------------------------------
01:09:13   average binary cross entropy: 0.491957
01:09:13   Save checkpoint to model_epoch_15.pth
01:09:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:09:13   Evaluate on valid
01:09:29   ------------------------------
01:09:29   ap: 0.99476
01:09:29   auroc: 0.993541
01:09:29   hits@1: 0.111486
01:09:29   hits@10: 0.393581
01:09:29   hits@100: 0.703547
01:09:29   hits@20: 0.490709
01:09:29   hits@3: 0.231841
01:09:29   hits@50: 0.611909
01:09:29   mr: 638.945
01:09:29   mrr: 0.205078
01:09:29   Load checkpoint from model_epoch_14.pth
01:09:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:09:29   Evaluate on valid
01:09:45   ------------------------------
01:09:45   ap: 0.993454
01:09:45   auroc: 0.991654
01:09:45   hits@1: 0.120355
01:09:45   hits@10: 0.399071
01:09:45   hits@100: 0.708193
01:09:45   hits@20: 0.48522
01:09:45   hits@3: 0.251267
01:09:45   hits@50: 0.61022
01:09:45   mr: 665.718
01:09:45   mrr: 0.215434
01:09:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:09:45   Evaluate on test
01:10:15   ------------------------------
01:10:15   ap: 0.99323
01:10:15   auroc: 0.990874
01:10:15   hits@1: 0.114524
01:10:15   hits@10: 0.403028
01:10:15   hits@100: 0.726854
01:10:15   hits@20: 0.490127
01:10:15   hits@3: 0.243528
01:10:15   hits@50: 0.626371
01:10:15   mr: 617.908
01:10:15   mrr: 0.211835
