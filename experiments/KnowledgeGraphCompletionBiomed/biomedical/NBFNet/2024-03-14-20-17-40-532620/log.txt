20:17:40   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-14-20-17-40-532620
20:17:40   Input Seed: 1237
20:17:40   Set Seed: 1237
20:17:40   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
20:17:40   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
20:17:41   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 416172
)
20:17:41   #train: 9617, #valid: 3447, #test: 6887
20:17:41   Preprocess training set
20:17:42   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(409285, 416172)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(396221, 405838)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(405838, 409285)}}
20:17:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:17:42   Epoch 0 begin
20:17:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:17:45   binary cross entropy: 0.687183
20:20:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:20:38   binary cross entropy: 0.598132
20:22:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:22:04   Epoch 0 end
20:22:04   duration: 4.37 mins
20:22:04   speed: 0.58 batch / sec
20:22:04   ETA: 4.37 mins
20:22:04   max GPU memory: 47436.9 MiB
20:22:04   ------------------------------
20:22:04   average binary cross entropy: 0.581363
20:22:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:22:04   Epoch 1 begin
20:23:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:23:30   binary cross entropy: 0.548371
20:26:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:26:22   binary cross entropy: 0.530252
20:26:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:26:22   Epoch 1 end
20:26:22   duration: 4.31 mins
20:26:22   speed: 0.58 batch / sec
20:26:22   ETA: 0.00 secs
20:26:22   max GPU memory: 47436.9 MiB
20:26:22   ------------------------------
20:26:22   average binary cross entropy: 0.539321
20:26:22   Save checkpoint to model_epoch_2.pth
20:26:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:26:23   Evaluate on valid
20:27:09   ------------------------------
20:27:09   ap: 0.988544
20:27:09   auroc: 0.985169
20:27:09   hits@1: 0.269655
20:27:09   hits@10: 0.449811
20:27:09   hits@100: 0.637946
20:27:09   hits@20: 0.504787
20:27:09   hits@3: 0.340006
20:27:09   hits@50: 0.582536
20:27:09   mr: 793.291
20:27:09   mrr: 0.326805
20:27:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:27:09   Epoch 2 begin
20:29:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:30:00   binary cross entropy: 0.559868
20:31:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:31:29   Epoch 2 end
20:31:29   duration: 5.11 mins
20:31:29   speed: 0.49 batch / sec
20:31:29   ETA: 5.11 mins
20:31:29   max GPU memory: 47459.7 MiB
20:31:29   ------------------------------
20:31:29   average binary cross entropy: 0.526057
20:31:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:31:29   Epoch 3 begin
20:32:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:32:53   binary cross entropy: 0.544869
20:35:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:35:46   binary cross entropy: 0.531999
20:35:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:35:50   Epoch 3 end
20:35:50   duration: 4.35 mins
20:35:50   speed: 0.58 batch / sec
20:35:50   ETA: 0.00 secs
20:35:50   max GPU memory: 47459.7 MiB
20:35:50   ------------------------------
20:35:50   average binary cross entropy: 0.520982
20:35:50   Save checkpoint to model_epoch_4.pth
20:35:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:35:50   Evaluate on valid
20:36:37   ------------------------------
20:36:37   ap: 0.991588
20:36:37   auroc: 0.987936
20:36:37   hits@1: 0.288077
20:36:37   hits@10: 0.45924
20:36:37   hits@100: 0.648245
20:36:37   hits@20: 0.519002
20:36:37   hits@3: 0.361184
20:36:37   hits@50: 0.591674
20:36:37   mr: 762.85
20:36:37   mrr: 0.345748
20:36:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:36:37   Epoch 4 begin
20:39:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:39:23   binary cross entropy: 0.539577
20:40:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:40:55   Epoch 4 end
20:40:55   duration: 5.09 mins
20:40:55   speed: 0.49 batch / sec
20:40:55   ETA: 5.09 mins
20:40:55   max GPU memory: 47459.7 MiB
20:40:55   ------------------------------
20:40:55   average binary cross entropy: 0.521569
20:40:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:40:55   Epoch 5 begin
20:42:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:42:15   binary cross entropy: 0.478316
20:45:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:45:09   binary cross entropy: 0.520163
20:45:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:45:16   Epoch 5 end
20:45:16   duration: 4.35 mins
20:45:16   speed: 0.58 batch / sec
20:45:16   ETA: 0.00 secs
20:45:16   max GPU memory: 47459.7 MiB
20:45:16   ------------------------------
20:45:16   average binary cross entropy: 0.513625
20:45:16   Save checkpoint to model_epoch_6.pth
20:45:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:45:16   Evaluate on valid
20:46:03   ------------------------------
20:46:03   ap: 0.989334
20:46:03   auroc: 0.985749
20:46:03   hits@1: 0.292283
20:46:03   hits@10: 0.46011
20:46:03   hits@100: 0.646649
20:46:03   hits@20: 0.51407
20:46:03   hits@3: 0.361909
20:46:03   hits@50: 0.589498
20:46:03   mr: 753.229
20:46:03   mrr: 0.347163
20:46:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:46:03   Epoch 6 begin
20:48:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:48:46   binary cross entropy: 0.537917
20:50:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:50:21   Epoch 6 end
20:50:21   duration: 5.08 mins
20:50:21   speed: 0.49 batch / sec
20:50:21   ETA: 5.08 mins
20:50:21   max GPU memory: 47459.7 MiB
20:50:21   ------------------------------
20:50:21   average binary cross entropy: 0.512226
20:50:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:50:21   Epoch 7 begin
20:51:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:51:37   binary cross entropy: 0.51687
20:54:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:54:32   binary cross entropy: 0.490459
20:54:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:54:44   Epoch 7 end
20:54:44   duration: 4.37 mins
20:54:44   speed: 0.58 batch / sec
20:54:44   ETA: 0.00 secs
20:54:44   max GPU memory: 47459.7 MiB
20:54:44   ------------------------------
20:54:44   average binary cross entropy: 0.51081
20:54:44   Save checkpoint to model_epoch_8.pth
20:54:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:54:44   Evaluate on valid
20:55:31   ------------------------------
20:55:31   ap: 0.982256
20:55:31   auroc: 0.973965
20:55:31   hits@1: 0.288367
20:55:31   hits@10: 0.463011
20:55:31   hits@100: 0.64955
20:55:31   hits@20: 0.518422
20:55:31   hits@3: 0.364955
20:55:31   hits@50: 0.592689
20:55:31   mr: 744.522
20:55:31   mrr: 0.347064
20:55:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:55:31   Epoch 8 begin
20:58:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:58:11   binary cross entropy: 0.539002
20:59:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:59:50   Epoch 8 end
20:59:50   duration: 5.10 mins
20:59:50   speed: 0.49 batch / sec
20:59:50   ETA: 5.10 mins
20:59:50   max GPU memory: 47459.7 MiB
20:59:50   ------------------------------
20:59:50   average binary cross entropy: 0.506198
20:59:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:59:50   Epoch 9 begin
21:01:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:01:02   binary cross entropy: 0.471791
21:03:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:03:55   binary cross entropy: 0.582292
21:04:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:04:09   Epoch 9 end
21:04:09   duration: 4.33 mins
21:04:09   speed: 0.58 batch / sec
21:04:09   ETA: 0.00 secs
21:04:09   max GPU memory: 47459.7 MiB
21:04:09   ------------------------------
21:04:09   average binary cross entropy: 0.510215
21:04:09   Save checkpoint to model_epoch_10.pth
21:04:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:04:10   Evaluate on valid
21:04:56   ------------------------------
21:04:56   ap: 0.986609
21:04:56   auroc: 0.980068
21:04:56   hits@1: 0.291413
21:04:56   hits@10: 0.463301
21:04:56   hits@100: 0.656948
21:04:56   hits@20: 0.519872
21:04:56   hits@3: 0.368871
21:04:56   hits@50: 0.597041
21:04:56   mr: 755.547
21:04:56   mrr: 0.34987
21:04:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:04:56   Epoch 10 begin
21:07:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:07:33   binary cross entropy: 0.52067
21:09:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:09:16   Epoch 10 end
21:09:16   duration: 5.11 mins
21:09:16   speed: 0.49 batch / sec
21:09:16   ETA: 5.11 mins
21:09:16   max GPU memory: 47459.7 MiB
21:09:16   ------------------------------
21:09:16   average binary cross entropy: 0.509941
21:09:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:09:16   Epoch 11 begin
21:10:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:10:25   binary cross entropy: 0.522757
21:13:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:13:16   binary cross entropy: 0.448348
21:13:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:13:34   Epoch 11 end
21:13:34   duration: 4.30 mins
21:13:34   speed: 0.59 batch / sec
21:13:34   ETA: 0.00 secs
21:13:34   max GPU memory: 47459.7 MiB
21:13:34   ------------------------------
21:13:34   average binary cross entropy: 0.501207
21:13:34   Save checkpoint to model_epoch_12.pth
21:13:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:13:34   Evaluate on valid
21:14:21   ------------------------------
21:14:21   ap: 0.975626
21:14:21   auroc: 0.9652
21:14:21   hits@1: 0.289527
21:14:21   hits@10: 0.464897
21:14:21   hits@100: 0.652161
21:14:21   hits@20: 0.520162
21:14:21   hits@3: 0.368436
21:14:21   hits@50: 0.5953
21:14:21   mr: 760.227
21:14:21   mrr: 0.348711
21:14:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:14:21   Epoch 12 begin
21:16:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:16:54   binary cross entropy: 0.503076
21:18:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:18:41   Epoch 12 end
21:18:41   duration: 5.12 mins
21:18:41   speed: 0.49 batch / sec
21:18:41   ETA: 5.12 mins
21:18:41   max GPU memory: 47459.7 MiB
21:18:41   ------------------------------
21:18:41   average binary cross entropy: 0.502251
21:18:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:18:41   Epoch 13 begin
21:19:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:19:47   binary cross entropy: 0.45746
21:22:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:22:39   binary cross entropy: 0.586256
21:23:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:23:00   Epoch 13 end
21:23:00   duration: 4.31 mins
21:23:00   speed: 0.58 batch / sec
21:23:00   ETA: 0.00 secs
21:23:00   max GPU memory: 47459.7 MiB
21:23:00   ------------------------------
21:23:00   average binary cross entropy: 0.49973
21:23:00   Save checkpoint to model_epoch_14.pth
21:23:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:23:00   Evaluate on valid
21:23:47   ------------------------------
21:23:47   ap: 0.979913
21:23:47   auroc: 0.970358
21:23:47   hits@1: 0.299681
21:23:47   hits@10: 0.468233
21:23:47   hits@100: 0.656078
21:23:47   hits@20: 0.524659
21:23:47   hits@3: 0.375834
21:23:47   hits@50: 0.600522
21:23:47   mr: 745.425
21:23:47   mrr: 0.357419
21:23:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:23:48   Epoch 14 begin
21:26:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:26:18   binary cross entropy: 0.472668
21:28:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:28:06   Epoch 14 end
21:28:06   duration: 5.11 mins
21:28:06   speed: 0.49 batch / sec
21:28:06   ETA: 0.00 secs
21:28:06   max GPU memory: 47459.7 MiB
21:28:06   ------------------------------
21:28:06   average binary cross entropy: 0.503182
21:28:06   Save checkpoint to model_epoch_15.pth
21:28:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:28:07   Evaluate on valid
21:28:53   ------------------------------
21:28:53   ap: 0.981323
21:28:53   auroc: 0.973114
21:28:53   hits@1: 0.293444
21:28:53   hits@10: 0.466348
21:28:53   hits@100: 0.658254
21:28:53   hits@20: 0.521178
21:28:53   hits@3: 0.367566
21:28:53   hits@50: 0.598201
21:28:53   mr: 737.878
21:28:53   mrr: 0.350795
21:28:53   Load checkpoint from model_epoch_14.pth
21:28:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:28:54   Evaluate on valid
21:29:40   ------------------------------
21:29:40   ap: 0.979571
21:29:40   auroc: 0.970132
21:29:40   hits@1: 0.299681
21:29:40   hits@10: 0.468233
21:29:40   hits@100: 0.656078
21:29:40   hits@20: 0.524659
21:29:40   hits@3: 0.375834
21:29:40   hits@50: 0.600522
21:29:40   mr: 745.425
21:29:40   mrr: 0.357419
21:29:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:29:40   Evaluate on test
21:31:14   ------------------------------
21:31:14   ap: 0.980408
21:31:14   auroc: 0.971337
21:31:14   hits@1: 0.299332
21:31:14   hits@10: 0.467911
21:31:14   hits@100: 0.657543
21:31:14   hits@20: 0.524684
21:31:14   hits@3: 0.368012
21:31:14   hits@50: 0.599535
21:31:14   mr: 741.243
21:31:14   mrr: 0.354365
