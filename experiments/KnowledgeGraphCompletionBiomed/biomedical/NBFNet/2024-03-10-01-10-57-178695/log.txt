01:10:57   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-10-01-10-57-178695
01:10:57   Input Seed: 1238
01:10:57   Set Seed: 1238
01:10:57   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
01:10:57   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
01:10:57   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 393442
)
01:10:57   #train: 3274, #valid: 1184, #test: 2279
01:10:57   Preprocess training set
01:10:58   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(391163, 393442)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(386705, 389979)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(389979, 391163)}}
01:10:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:10:58   Epoch 0 begin
01:11:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:11:04   binary cross entropy: 0.713286
01:12:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:12:25   Epoch 0 end
01:12:25   duration: 1.45 mins
01:12:25   speed: 0.60 batch / sec
01:12:25   ETA: 1.45 mins
01:12:25   max GPU memory: 47417.3 MiB
01:12:25   ------------------------------
01:12:25   average binary cross entropy: 0.57449
01:12:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:12:25   Epoch 1 begin
01:13:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:43   binary cross entropy: 0.543123
01:13:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:47   Epoch 1 end
01:13:47   duration: 1.37 mins
01:13:47   speed: 0.63 batch / sec
01:13:47   ETA: 0.00 secs
01:13:47   max GPU memory: 47417.3 MiB
01:13:47   ------------------------------
01:13:47   average binary cross entropy: 0.53758
01:13:47   Save checkpoint to model_epoch_2.pth
01:13:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:47   Evaluate on valid
01:14:03   ------------------------------
01:14:03   ap: 0.992862
01:14:03   auroc: 0.992474
01:14:03   hits@1: 0.0675676
01:14:03   hits@10: 0.347128
01:14:03   hits@100: 0.678632
01:14:03   hits@20: 0.440456
01:14:03   hits@3: 0.166807
01:14:03   hits@50: 0.579392
01:14:03   mr: 705.054
01:14:03   mrr: 0.153014
01:14:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:14:03   Epoch 2 begin
01:15:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:15:25   Epoch 2 end
01:15:25   duration: 1.63 mins
01:15:25   speed: 0.53 batch / sec
01:15:25   ETA: 1.63 mins
01:15:25   max GPU memory: 47438.6 MiB
01:15:25   ------------------------------
01:15:25   average binary cross entropy: 0.525765
01:15:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:15:25   Epoch 3 begin
01:16:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:37   binary cross entropy: 0.457104
01:16:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:47   Epoch 3 end
01:16:47   duration: 1.37 mins
01:16:47   speed: 0.63 batch / sec
01:16:47   ETA: 0.00 secs
01:16:47   max GPU memory: 47438.6 MiB
01:16:47   ------------------------------
01:16:47   average binary cross entropy: 0.51728
01:16:47   Save checkpoint to model_epoch_4.pth
01:16:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:47   Evaluate on valid
01:17:03   ------------------------------
01:17:03   ap: 0.991911
01:17:03   auroc: 0.990299
01:17:03   hits@1: 0.0869932
01:17:03   hits@10: 0.353885
01:17:03   hits@100: 0.690456
01:17:03   hits@20: 0.438345
01:17:03   hits@3: 0.199324
01:17:03   hits@50: 0.590794
01:17:03   mr: 678.721
01:17:03   mrr: 0.175152
01:17:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:17:03   Epoch 4 begin
01:18:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:18:25   Epoch 4 end
01:18:25   duration: 1.64 mins
01:18:25   speed: 0.53 batch / sec
01:18:25   ETA: 1.64 mins
01:18:25   max GPU memory: 47438.6 MiB
01:18:25   ------------------------------
01:18:25   average binary cross entropy: 0.517892
01:18:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:18:25   Epoch 5 begin
01:19:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:19:31   binary cross entropy: 0.531063
01:19:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:19:47   Epoch 5 end
01:19:47   duration: 1.36 mins
01:19:47   speed: 0.64 batch / sec
01:19:47   ETA: 0.00 secs
01:19:47   max GPU memory: 47438.6 MiB
01:19:47   ------------------------------
01:19:47   average binary cross entropy: 0.515515
01:19:47   Save checkpoint to model_epoch_6.pth
01:19:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:19:47   Evaluate on valid
01:20:03   ------------------------------
01:20:03   ap: 0.994991
01:20:03   auroc: 0.99424
01:20:03   hits@1: 0.0912162
01:20:03   hits@10: 0.369932
01:20:03   hits@100: 0.691301
01:20:03   hits@20: 0.459037
01:20:03   hits@3: 0.216216
01:20:03   hits@50: 0.595861
01:20:03   mr: 664.894
01:20:03   mrr: 0.185053
01:20:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:20:03   Epoch 6 begin
01:21:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:21:25   Epoch 6 end
01:21:25   duration: 1.63 mins
01:21:25   speed: 0.53 batch / sec
01:21:25   ETA: 1.63 mins
01:21:25   max GPU memory: 47438.6 MiB
01:21:25   ------------------------------
01:21:25   average binary cross entropy: 0.520169
01:21:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:21:25   Epoch 7 begin
01:22:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:22:24   binary cross entropy: 0.449071
01:22:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:22:47   Epoch 7 end
01:22:47   duration: 1.36 mins
01:22:47   speed: 0.64 batch / sec
01:22:47   ETA: 0.00 secs
01:22:47   max GPU memory: 47438.6 MiB
01:22:47   ------------------------------
01:22:47   average binary cross entropy: 0.501757
01:22:47   Save checkpoint to model_epoch_8.pth
01:22:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:22:47   Evaluate on valid
01:23:03   ------------------------------
01:23:03   ap: 0.994584
01:23:03   auroc: 0.994232
01:23:03   hits@1: 0.0988176
01:23:03   hits@10: 0.374578
01:23:03   hits@100: 0.697213
01:23:03   hits@20: 0.466216
01:23:03   hits@3: 0.212838
01:23:03   hits@50: 0.597973
01:23:03   mr: 671.436
01:23:03   mrr: 0.18931
01:23:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:23:03   Epoch 8 begin
01:24:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:24:24   Epoch 8 end
01:24:24   duration: 1.63 mins
01:24:24   speed: 0.53 batch / sec
01:24:24   ETA: 1.63 mins
01:24:24   max GPU memory: 47438.6 MiB
01:24:24   ------------------------------
01:24:24   average binary cross entropy: 0.507766
01:24:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:24:24   Epoch 9 begin
01:25:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:25:17   binary cross entropy: 0.501326
01:25:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:25:46   Epoch 9 end
01:25:46   duration: 1.36 mins
01:25:46   speed: 0.64 batch / sec
01:25:46   ETA: 0.00 secs
01:25:46   max GPU memory: 47438.6 MiB
01:25:46   ------------------------------
01:25:46   average binary cross entropy: 0.494069
01:25:46   Save checkpoint to model_epoch_10.pth
01:25:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:25:47   Evaluate on valid
01:26:03   ------------------------------
01:26:03   ap: 0.992065
01:26:03   auroc: 0.990724
01:26:03   hits@1: 0.0996622
01:26:03   hits@10: 0.385557
01:26:03   hits@100: 0.700591
01:26:03   hits@20: 0.469172
01:26:03   hits@3: 0.22424
01:26:03   hits@50: 0.60473
01:26:03   mr: 671.868
01:26:03   mrr: 0.193621
01:26:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:26:03   Epoch 10 begin
01:27:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:27:25   Epoch 10 end
01:27:25   duration: 1.64 mins
01:27:25   speed: 0.53 batch / sec
01:27:25   ETA: 1.64 mins
01:27:25   max GPU memory: 47438.6 MiB
01:27:25   ------------------------------
01:27:25   average binary cross entropy: 0.501711
01:27:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:27:25   Epoch 11 begin
01:28:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:11   binary cross entropy: 0.539793
01:28:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:47   Epoch 11 end
01:28:47   duration: 1.37 mins
01:28:47   speed: 0.63 batch / sec
01:28:47   ETA: 0.00 secs
01:28:47   max GPU memory: 47438.6 MiB
01:28:47   ------------------------------
01:28:47   average binary cross entropy: 0.500431
01:28:47   Save checkpoint to model_epoch_12.pth
01:28:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:47   Evaluate on valid
01:29:03   ------------------------------
01:29:03   ap: 0.991402
01:29:03   auroc: 0.989098
01:29:03   hits@1: 0.117821
01:29:03   hits@10: 0.391047
01:29:03   hits@100: 0.705236
01:29:03   hits@20: 0.475084
01:29:03   hits@3: 0.224662
01:29:03   hits@50: 0.606841
01:29:03   mr: 686.033
01:29:03   mrr: 0.205161
01:29:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:29:03   Epoch 12 begin
01:30:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:30:25   Epoch 12 end
01:30:25   duration: 1.63 mins
01:30:25   speed: 0.53 batch / sec
01:30:25   ETA: 1.63 mins
01:30:25   max GPU memory: 47438.6 MiB
01:30:25   ------------------------------
01:30:25   average binary cross entropy: 0.505318
01:30:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:30:25   Epoch 13 begin
01:31:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:31:05   binary cross entropy: 0.443751
01:31:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:31:46   Epoch 13 end
01:31:46   duration: 1.36 mins
01:31:46   speed: 0.64 batch / sec
01:31:46   ETA: 0.00 secs
01:31:46   max GPU memory: 47438.6 MiB
01:31:46   ------------------------------
01:31:46   average binary cross entropy: 0.505271
01:31:46   Save checkpoint to model_epoch_14.pth
01:31:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:31:47   Evaluate on valid
01:32:02   ------------------------------
01:32:02   ap: 0.988204
01:32:02   auroc: 0.986346
01:32:02   hits@1: 0.11022
01:32:02   hits@10: 0.397382
01:32:02   hits@100: 0.701858
01:32:02   hits@20: 0.481419
01:32:02   hits@3: 0.23902
01:32:02   hits@50: 0.606419
01:32:02   mr: 661.315
01:32:02   mrr: 0.206308
01:32:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:32:02   Epoch 14 begin
01:33:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:24   Epoch 14 end
01:33:24   duration: 1.63 mins
01:33:24   speed: 0.53 batch / sec
01:33:24   ETA: 0.00 secs
01:33:24   max GPU memory: 47438.6 MiB
01:33:24   ------------------------------
01:33:24   average binary cross entropy: 0.488861
01:33:24   Save checkpoint to model_epoch_15.pth
01:33:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:24   Evaluate on valid
01:33:40   ------------------------------
01:33:40   ap: 0.989782
01:33:40   auroc: 0.989057
01:33:40   hits@1: 0.127534
01:33:40   hits@10: 0.399916
01:33:40   hits@100: 0.702703
01:33:40   hits@20: 0.485642
01:33:40   hits@3: 0.239443
01:33:40   hits@50: 0.607686
01:33:40   mr: 648.367
01:33:40   mrr: 0.216472
01:33:40   Load checkpoint from model_epoch_15.pth
01:33:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:40   Evaluate on valid
01:33:56   ------------------------------
01:33:56   ap: 0.991034
01:33:56   auroc: 0.989671
01:33:56   hits@1: 0.127534
01:33:56   hits@10: 0.399916
01:33:56   hits@100: 0.702703
01:33:56   hits@20: 0.485642
01:33:56   hits@3: 0.239443
01:33:56   hits@50: 0.607686
01:33:56   mr: 648.367
01:33:56   mrr: 0.216472
01:33:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:56   Evaluate on test
01:34:26   ------------------------------
01:34:26   ap: 0.989031
01:34:26   auroc: 0.987984
01:34:26   hits@1: 0.0947784
01:34:26   hits@10: 0.393594
01:34:26   hits@100: 0.723563
01:34:26   hits@20: 0.489908
01:34:26   hits@3: 0.22839
01:34:26   hits@50: 0.626371
01:34:26   mr: 621.026
01:34:26   mrr: 0.195047
