12:15:28   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-10-12-15-27-993055
12:15:28   Input Seed: 1235
12:15:28   Set Seed: 1235
12:15:28   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
12:15:28   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
12:15:29   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 401604
)
12:15:29   #train: 5540, #valid: 2004, #test: 3909
12:15:29   Preprocess training set
12:15:31   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(397695, 401604)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(390151, 395691)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(395691, 397695)}}
12:15:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:15:31   Epoch 0 begin
12:15:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:15:40   binary cross entropy: 0.718949
12:18:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:18:01   Epoch 0 end
12:18:01   duration: 2.49 mins
12:18:01   speed: 0.58 batch / sec
12:18:01   ETA: 2.49 mins
12:18:01   max GPU memory: 47426.7 MiB
12:18:01   ------------------------------
12:18:01   average binary cross entropy: 0.541488
12:18:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:18:01   Epoch 1 begin
12:18:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:18:24   binary cross entropy: 0.516952
12:20:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:20:22   Epoch 1 end
12:20:22   duration: 2.35 mins
12:20:22   speed: 0.62 batch / sec
12:20:22   ETA: 0.00 secs
12:20:22   max GPU memory: 47426.7 MiB
12:20:22   ------------------------------
12:20:22   average binary cross entropy: 0.470984
12:20:22   Save checkpoint to model_epoch_2.pth
12:20:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:20:23   Evaluate on valid
12:20:49   ------------------------------
12:20:49   ap: 0.993147
12:20:49   auroc: 0.992634
12:20:49   hits@1: 0.282186
12:20:49   hits@10: 0.555888
12:20:49   hits@100: 0.756737
12:20:49   hits@20: 0.613523
12:20:49   hits@3: 0.418912
12:20:49   hits@50: 0.692864
12:20:49   mr: 621.942
12:20:49   mrr: 0.375491
12:20:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:20:49   Epoch 2 begin
12:21:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:21:34   binary cross entropy: 0.550075
12:23:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:23:12   Epoch 2 end
12:23:12   duration: 2.82 mins
12:23:12   speed: 0.51 batch / sec
12:23:12   ETA: 2.82 mins
12:23:12   max GPU memory: 47449.8 MiB
12:23:12   ------------------------------
12:23:12   average binary cross entropy: 0.453307
12:23:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:23:12   Epoch 3 begin
12:24:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:24:17   binary cross entropy: 0.416685
12:25:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:25:34   Epoch 3 end
12:25:34   duration: 2.37 mins
12:25:34   speed: 0.61 batch / sec
12:25:34   ETA: 0.00 secs
12:25:34   max GPU memory: 47449.8 MiB
12:25:34   ------------------------------
12:25:34   average binary cross entropy: 0.441332
12:25:34   Save checkpoint to model_epoch_4.pth
12:25:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:25:34   Evaluate on valid
12:26:01   ------------------------------
12:26:01   ap: 0.997535
12:26:01   auroc: 0.996988
12:26:01   hits@1: 0.324102
12:26:01   hits@10: 0.568613
12:26:01   hits@100: 0.763723
12:26:01   hits@20: 0.625998
12:26:01   hits@3: 0.446607
12:26:01   hits@50: 0.705339
12:26:01   mr: 586.753
12:26:01   mrr: 0.407729
12:26:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:26:01   Epoch 4 begin
12:27:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:27:28   binary cross entropy: 0.478443
12:28:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:28:23   Epoch 4 end
12:28:23   duration: 2.82 mins
12:28:23   speed: 0.51 batch / sec
12:28:23   ETA: 2.82 mins
12:28:23   max GPU memory: 47449.8 MiB
12:28:23   ------------------------------
12:28:23   average binary cross entropy: 0.437387
12:28:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:28:23   Epoch 5 begin
12:30:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:30:11   binary cross entropy: 0.427939
12:30:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:30:45   Epoch 5 end
12:30:45   duration: 2.37 mins
12:30:45   speed: 0.61 batch / sec
12:30:45   ETA: 0.00 secs
12:30:45   max GPU memory: 47449.8 MiB
12:30:45   ------------------------------
12:30:45   average binary cross entropy: 0.438522
12:30:45   Save checkpoint to model_epoch_6.pth
12:30:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:30:45   Evaluate on valid
12:31:12   ------------------------------
12:31:12   ap: 0.996057
12:31:12   auroc: 0.995612
12:31:12   hits@1: 0.321357
12:31:12   hits@10: 0.568114
12:31:12   hits@100: 0.764471
12:31:12   hits@20: 0.627744
12:31:12   hits@3: 0.442864
12:31:12   hits@50: 0.706088
12:31:12   mr: 566.579
12:31:12   mrr: 0.405227
12:31:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:31:12   Epoch 6 begin
12:33:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:33:21   binary cross entropy: 0.363021
12:33:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:33:34   Epoch 6 end
12:33:34   duration: 2.81 mins
12:33:34   speed: 0.52 batch / sec
12:33:34   ETA: 2.81 mins
12:33:34   max GPU memory: 47449.8 MiB
12:33:34   ------------------------------
12:33:34   average binary cross entropy: 0.44014
12:33:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:33:34   Epoch 7 begin
12:35:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:35:56   Epoch 7 end
12:35:56   duration: 2.37 mins
12:35:56   speed: 0.61 batch / sec
12:35:56   ETA: 0.00 secs
12:35:56   max GPU memory: 47449.8 MiB
12:35:56   ------------------------------
12:35:56   average binary cross entropy: 0.437913
12:35:56   Save checkpoint to model_epoch_8.pth
12:35:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:35:56   Evaluate on valid
12:36:23   ------------------------------
12:36:23   ap: 0.997335
12:36:23   auroc: 0.996496
12:36:23   hits@1: 0.316866
12:36:23   hits@10: 0.566118
12:36:23   hits@100: 0.763224
12:36:23   hits@20: 0.62475
12:36:23   hits@3: 0.444611
12:36:23   hits@50: 0.701846
12:36:23   mr: 583.909
12:36:23   mrr: 0.402782
12:36:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:36:23   Epoch 8 begin
12:36:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:36:31   binary cross entropy: 0.399873
12:38:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:38:45   Epoch 8 end
12:38:45   duration: 2.83 mins
12:38:45   speed: 0.51 batch / sec
12:38:45   ETA: 2.83 mins
12:38:45   max GPU memory: 47449.8 MiB
12:38:45   ------------------------------
12:38:45   average binary cross entropy: 0.437538
12:38:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:38:45   Epoch 9 begin
12:39:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:39:15   binary cross entropy: 0.446683
12:41:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:41:09   Epoch 9 end
12:41:09   duration: 2.38 mins
12:41:09   speed: 0.61 batch / sec
12:41:09   ETA: 0.00 secs
12:41:09   max GPU memory: 47449.8 MiB
12:41:09   ------------------------------
12:41:09   average binary cross entropy: 0.422656
12:41:09   Save checkpoint to model_epoch_10.pth
12:41:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:41:09   Evaluate on valid
12:41:35   ------------------------------
12:41:35   ap: 0.995621
12:41:35   auroc: 0.994394
12:41:35   hits@1: 0.322854
12:41:35   hits@10: 0.574102
12:41:35   hits@100: 0.767216
12:41:35   hits@20: 0.62999
12:41:35   hits@3: 0.447106
12:41:35   hits@50: 0.704591
12:41:35   mr: 556.892
12:41:35   mrr: 0.408529
12:41:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:41:35   Epoch 10 begin
12:42:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:42:26   binary cross entropy: 0.375661
12:43:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:43:57   Epoch 10 end
12:43:57   duration: 2.81 mins
12:43:57   speed: 0.52 batch / sec
12:43:57   ETA: 2.81 mins
12:43:57   max GPU memory: 47449.8 MiB
12:43:57   ------------------------------
12:43:57   average binary cross entropy: 0.419428
12:43:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:43:57   Epoch 11 begin
12:45:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:45:10   binary cross entropy: 0.35034
12:46:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:46:19   Epoch 11 end
12:46:19   duration: 2.37 mins
12:46:19   speed: 0.61 batch / sec
12:46:19   ETA: 0.00 secs
12:46:19   max GPU memory: 47449.8 MiB
12:46:19   ------------------------------
12:46:19   average binary cross entropy: 0.416386
12:46:19   Save checkpoint to model_epoch_12.pth
12:46:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:46:20   Evaluate on valid
12:46:46   ------------------------------
12:46:46   ap: 0.996245
12:46:46   auroc: 0.994852
12:46:46   hits@1: 0.34007
12:46:46   hits@10: 0.5751
12:46:46   hits@100: 0.77021
12:46:46   hits@20: 0.630738
12:46:46   hits@3: 0.452096
12:46:46   hits@50: 0.706836
12:46:46   mr: 562.317
12:46:46   mrr: 0.418661
12:46:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:46:46   Epoch 12 begin
12:48:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:48:20   binary cross entropy: 0.370243
12:49:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:49:08   Epoch 12 end
12:49:08   duration: 2.81 mins
12:49:08   speed: 0.52 batch / sec
12:49:08   ETA: 2.81 mins
12:49:08   max GPU memory: 47449.8 MiB
12:49:08   ------------------------------
12:49:08   average binary cross entropy: 0.412983
12:49:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:49:08   Epoch 13 begin
12:51:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:51:03   binary cross entropy: 0.358415
12:51:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:51:30   Epoch 13 end
12:51:30   duration: 2.37 mins
12:51:30   speed: 0.61 batch / sec
12:51:30   ETA: 0.00 secs
12:51:30   max GPU memory: 47449.8 MiB
12:51:30   ------------------------------
12:51:30   average binary cross entropy: 0.41625
12:51:30   Save checkpoint to model_epoch_14.pth
12:51:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:51:31   Evaluate on valid
12:51:57   ------------------------------
12:51:57   ap: 0.996404
12:51:57   auroc: 0.995898
12:51:57   hits@1: 0.33508
12:51:57   hits@10: 0.572854
12:51:57   hits@100: 0.766717
12:51:57   hits@20: 0.627744
12:51:57   hits@3: 0.453842
12:51:57   hits@50: 0.707585
12:51:57   mr: 599.196
12:51:57   mrr: 0.416004
12:51:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:51:57   Epoch 14 begin
12:54:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:54:13   binary cross entropy: 0.414694
12:54:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:54:19   Epoch 14 end
12:54:19   duration: 2.82 mins
12:54:19   speed: 0.51 batch / sec
12:54:19   ETA: 0.00 secs
12:54:19   max GPU memory: 47449.8 MiB
12:54:19   ------------------------------
12:54:19   average binary cross entropy: 0.409408
12:54:19   Save checkpoint to model_epoch_15.pth
12:54:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:54:20   Evaluate on valid
12:54:46   ------------------------------
12:54:46   ap: 0.994682
12:54:46   auroc: 0.992935
12:54:46   hits@1: 0.334082
12:54:46   hits@10: 0.57984
12:54:46   hits@100: 0.767216
12:54:46   hits@20: 0.632236
12:54:46   hits@3: 0.447355
12:54:46   hits@50: 0.705589
12:54:46   mr: 573.424
12:54:46   mrr: 0.414958
12:54:46   Load checkpoint from model_epoch_12.pth
12:54:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:54:46   Evaluate on valid
12:55:13   ------------------------------
12:55:13   ap: 0.995821
12:55:13   auroc: 0.994652
12:55:13   hits@1: 0.34007
12:55:13   hits@10: 0.5751
12:55:13   hits@100: 0.77021
12:55:13   hits@20: 0.630738
12:55:13   hits@3: 0.452096
12:55:13   hits@50: 0.706836
12:55:13   mr: 562.317
12:55:13   mrr: 0.418661
12:55:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
12:55:13   Evaluate on test
12:56:04   ------------------------------
12:56:04   ap: 0.995219
12:56:04   auroc: 0.993267
12:56:04   hits@1: 0.340624
12:56:04   hits@10: 0.584804
12:56:04   hits@100: 0.783576
12:56:04   hits@20: 0.644922
12:56:04   hits@3: 0.452162
12:56:04   hits@50: 0.724994
12:56:04   mr: 552.094
12:56:04   mrr: 0.421914
