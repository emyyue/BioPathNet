04:57:41   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-22-04-57-41-138904
04:57:41   Input Seed: 1236
04:57:41   Set Seed: 1236
04:57:41   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
04:57:41   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
04:57:41   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 417079
)
04:57:41   #train: 9878, #valid: 3533, #test: 7049
04:57:41   Preprocess training set
04:57:42   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(410030, 417079)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(396619, 406497)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(406497, 410030)}}
04:57:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:57:42   Epoch 0 begin
04:57:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:57:45   binary cross entropy: 0.70415
05:00:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:00:34   binary cross entropy: 0.654958
05:02:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:02:06   Epoch 0 end
05:02:06   duration: 4.40 mins
05:02:06   speed: 0.59 batch / sec
05:02:06   ETA: 4.40 mins
05:02:06   max GPU memory: 47437.2 MiB
05:02:06   ------------------------------
05:02:06   average binary cross entropy: 0.589012
05:02:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:02:06   Epoch 1 begin
05:03:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:03:24   binary cross entropy: 0.57842
05:06:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:06:14   binary cross entropy: 0.495346
05:06:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:06:29   Epoch 1 end
05:06:29   duration: 4.38 mins
05:06:29   speed: 0.59 batch / sec
05:06:29   ETA: 0.00 secs
05:06:29   max GPU memory: 47437.2 MiB
05:06:29   ------------------------------
05:06:29   average binary cross entropy: 0.541615
05:06:29   Save checkpoint to model_epoch_2.pth
05:06:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:06:29   Evaluate on valid
05:07:16   ------------------------------
05:07:16   ap: 0.980245
05:07:16   auroc: 0.975188
05:07:16   hits@1: 0.248656
05:07:16   hits@10: 0.443391
05:07:16   hits@100: 0.638834
05:07:16   hits@20: 0.501415
05:07:16   hits@3: 0.33272
05:07:16   hits@50: 0.579677
05:07:16   mr: 810.405
05:07:16   mrr: 0.312492
05:07:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:07:16   Epoch 2 begin
05:09:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:09:50   binary cross entropy: 0.61258
05:11:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:11:37   Epoch 2 end
05:11:37   duration: 5.15 mins
05:11:37   speed: 0.50 batch / sec
05:11:37   ETA: 5.15 mins
05:11:37   max GPU memory: 47460.1 MiB
05:11:37   ------------------------------
05:11:37   average binary cross entropy: 0.530716
05:11:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:11:37   Epoch 3 begin
05:12:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:12:38   binary cross entropy: 0.512835
05:15:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:15:27   binary cross entropy: 0.574892
05:15:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:15:59   Epoch 3 end
05:15:59   duration: 4.35 mins
05:15:59   speed: 0.59 batch / sec
05:15:59   ETA: 0.00 secs
05:15:59   max GPU memory: 47460.1 MiB
05:15:59   ------------------------------
05:15:59   average binary cross entropy: 0.52182
05:15:59   Save checkpoint to model_epoch_4.pth
05:15:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:15:59   Evaluate on valid
05:16:46   ------------------------------
05:16:46   ap: 0.969594
05:16:46   auroc: 0.958401
05:16:46   hits@1: 0.260402
05:16:46   hits@10: 0.443532
05:16:46   hits@100: 0.633173
05:16:46   hits@20: 0.504246
05:16:46   hits@3: 0.341778
05:16:46   hits@50: 0.575573
05:16:46   mr: 797.456
05:16:46   mrr: 0.321754
05:16:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:16:46   Epoch 4 begin
05:19:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:19:03   binary cross entropy: 0.54022
05:21:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:21:07   Epoch 4 end
05:21:07   duration: 5.14 mins
05:21:07   speed: 0.50 batch / sec
05:21:07   ETA: 5.14 mins
05:21:07   max GPU memory: 47460.1 MiB
05:21:07   ------------------------------
05:21:07   average binary cross entropy: 0.522111
05:21:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:21:07   Epoch 5 begin
05:21:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:21:52   binary cross entropy: 0.697882
05:24:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:24:41   binary cross entropy: 0.497214
05:25:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:25:29   Epoch 5 end
05:25:29   duration: 4.37 mins
05:25:29   speed: 0.59 batch / sec
05:25:29   ETA: 0.00 secs
05:25:29   max GPU memory: 47460.1 MiB
05:25:29   ------------------------------
05:25:29   average binary cross entropy: 0.512354
05:25:29   Save checkpoint to model_epoch_6.pth
05:25:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:25:29   Evaluate on valid
05:26:16   ------------------------------
05:26:16   ap: 0.974672
05:26:16   auroc: 0.962811
05:26:16   hits@1: 0.279791
05:26:16   hits@10: 0.46193
05:26:16   hits@100: 0.651429
05:26:16   hits@20: 0.516417
05:26:16   hits@3: 0.352958
05:26:16   hits@50: 0.597226
05:26:16   mr: 761.857
05:26:16   mrr: 0.33796
05:26:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:26:16   Epoch 6 begin
05:28:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:28:16   binary cross entropy: 0.491714
05:30:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:30:38   Epoch 6 end
05:30:38   duration: 5.14 mins
05:30:38   speed: 0.50 batch / sec
05:30:38   ETA: 5.14 mins
05:30:38   max GPU memory: 47460.1 MiB
05:30:38   ------------------------------
05:30:38   average binary cross entropy: 0.511835
05:30:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:30:38   Epoch 7 begin
05:31:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:31:05   binary cross entropy: 0.461561
05:33:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:33:54   binary cross entropy: 0.515203
05:34:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:34:59   Epoch 7 end
05:34:59   duration: 4.35 mins
05:34:59   speed: 0.59 batch / sec
05:34:59   ETA: 0.00 secs
05:34:59   max GPU memory: 47460.1 MiB
05:34:59   ------------------------------
05:34:59   average binary cross entropy: 0.511499
05:34:59   Save checkpoint to model_epoch_8.pth
05:34:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:34:59   Evaluate on valid
05:35:46   ------------------------------
05:35:46   ap: 0.983877
05:35:46   auroc: 0.977407
05:35:46   hits@1: 0.281064
05:35:46   hits@10: 0.456836
05:35:46   hits@100: 0.652703
05:35:46   hits@20: 0.515851
05:35:46   hits@3: 0.355647
05:35:46   hits@50: 0.592556
05:35:46   mr: 770.188
05:35:46   mrr: 0.339774
05:35:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:35:46   Epoch 8 begin
05:37:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:37:29   binary cross entropy: 0.494982
05:40:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:40:07   Epoch 8 end
05:40:07   duration: 5.14 mins
05:40:07   speed: 0.50 batch / sec
05:40:07   ETA: 5.14 mins
05:40:07   max GPU memory: 47460.1 MiB
05:40:07   ------------------------------
05:40:07   average binary cross entropy: 0.50962
05:40:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:40:07   Epoch 9 begin
05:40:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:40:17   binary cross entropy: 0.567821
05:43:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:43:06   binary cross entropy: 0.474393
05:44:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:44:28   Epoch 9 end
05:44:28   duration: 4.35 mins
05:44:28   speed: 0.59 batch / sec
05:44:28   ETA: 0.00 secs
05:44:28   max GPU memory: 47460.1 MiB
05:44:28   ------------------------------
05:44:28   average binary cross entropy: 0.508626
05:44:28   Save checkpoint to model_epoch_10.pth
05:44:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:44:28   Evaluate on valid
05:45:16   ------------------------------
05:45:16   ap: 0.972558
05:45:16   auroc: 0.961243
05:45:16   hits@1: 0.28998
05:45:16   hits@10: 0.467733
05:45:16   hits@100: 0.655675
05:45:16   hits@20: 0.5242
05:45:16   hits@3: 0.365553
05:45:16   hits@50: 0.596802
05:45:16   mr: 739.529
05:45:16   mrr: 0.348243
05:45:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:45:16   Epoch 10 begin
05:46:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:46:42   binary cross entropy: 0.482965
05:49:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:49:31   binary cross entropy: 0.541131
05:49:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:49:37   Epoch 10 end
05:49:37   duration: 5.14 mins
05:49:37   speed: 0.50 batch / sec
05:49:37   ETA: 5.14 mins
05:49:37   max GPU memory: 47460.1 MiB
05:49:37   ------------------------------
05:49:37   average binary cross entropy: 0.512159
05:49:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:49:37   Epoch 11 begin
05:52:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:52:19   binary cross entropy: 0.472428
05:53:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:53:58   Epoch 11 end
05:53:58   duration: 4.35 mins
05:53:58   speed: 0.59 batch / sec
05:53:58   ETA: 0.00 secs
05:53:58   max GPU memory: 47460.1 MiB
05:53:58   ------------------------------
05:53:58   average binary cross entropy: 0.504141
05:53:58   Save checkpoint to model_epoch_12.pth
05:53:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:53:58   Evaluate on valid
05:54:45   ------------------------------
05:54:45   ap: 0.982365
05:54:45   auroc: 0.974944
05:54:45   hits@1: 0.286442
05:54:45   hits@10: 0.461647
05:54:45   hits@100: 0.656241
05:54:45   hits@20: 0.521794
05:54:45   hits@3: 0.359043
05:54:45   hits@50: 0.599066
05:54:45   mr: 727.078
05:54:45   mrr: 0.344265
05:54:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:54:45   Epoch 12 begin
05:55:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:55:55   binary cross entropy: 0.471867
05:58:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:58:44   binary cross entropy: 0.464112
05:59:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:59:06   Epoch 12 end
05:59:06   duration: 5.14 mins
05:59:06   speed: 0.50 batch / sec
05:59:06   ETA: 5.14 mins
05:59:06   max GPU memory: 47460.1 MiB
05:59:06   ------------------------------
05:59:06   average binary cross entropy: 0.504499
05:59:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
05:59:06   Epoch 13 begin
06:01:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:01:32   binary cross entropy: 0.510116
06:03:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:03:28   Epoch 13 end
06:03:28   duration: 4.35 mins
06:03:28   speed: 0.59 batch / sec
06:03:28   ETA: 0.00 secs
06:03:28   max GPU memory: 47460.1 MiB
06:03:28   ------------------------------
06:03:28   average binary cross entropy: 0.495219
06:03:28   Save checkpoint to model_epoch_14.pth
06:03:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:03:28   Evaluate on valid
06:04:15   ------------------------------
06:04:15   ap: 0.975531
06:04:15   auroc: 0.966149
06:04:15   hits@1: 0.288565
06:04:15   hits@10: 0.46377
06:04:15   hits@100: 0.658789
06:04:15   hits@20: 0.52505
06:04:15   hits@3: 0.36711
06:04:15   hits@50: 0.598641
06:04:15   mr: 720.691
06:04:15   mrr: 0.348117
06:04:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:04:15   Epoch 14 begin
06:05:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:05:07   binary cross entropy: 0.534045
06:07:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:07:56   binary cross entropy: 0.503938
06:08:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:08:36   Epoch 14 end
06:08:36   duration: 5.14 mins
06:08:36   speed: 0.50 batch / sec
06:08:36   ETA: 0.00 secs
06:08:36   max GPU memory: 47460.1 MiB
06:08:36   ------------------------------
06:08:36   average binary cross entropy: 0.502545
06:08:36   Save checkpoint to model_epoch_15.pth
06:08:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:08:36   Evaluate on valid
06:09:23   ------------------------------
06:09:23   ap: 0.982339
06:09:23   auroc: 0.975163
06:09:23   hits@1: 0.282763
06:09:23   hits@10: 0.46377
06:09:23   hits@100: 0.660204
06:09:23   hits@20: 0.525191
06:09:23   hits@3: 0.363147
06:09:23   hits@50: 0.597651
06:09:23   mr: 706.719
06:09:23   mrr: 0.343776
06:09:23   Load checkpoint from model_epoch_10.pth
06:09:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:09:24   Evaluate on valid
06:10:11   ------------------------------
06:10:11   ap: 0.972511
06:10:11   auroc: 0.960947
06:10:11   hits@1: 0.28998
06:10:11   hits@10: 0.467733
06:10:11   hits@100: 0.655675
06:10:11   hits@20: 0.5242
06:10:11   hits@3: 0.365553
06:10:11   hits@50: 0.596802
06:10:11   mr: 739.529
06:10:11   mrr: 0.348243
06:10:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
06:10:11   Evaluate on test
06:11:45   ------------------------------
06:11:45   ap: 0.973184
06:11:45   auroc: 0.962778
06:11:45   hits@1: 0.2877
06:11:45   hits@10: 0.468506
06:11:45   hits@100: 0.656902
06:11:45   hits@20: 0.524472
06:11:45   hits@3: 0.36452
06:11:45   hits@50: 0.602284
06:11:45   mr: 753.349
06:11:45   mrr: 0.346643
