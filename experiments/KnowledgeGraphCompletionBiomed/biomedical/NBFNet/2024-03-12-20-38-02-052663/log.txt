20:38:02   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-12-20-38-02-052663
20:38:02   Input Seed: 1236
20:38:02   Set Seed: 1236
20:38:02   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
20:38:02   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
20:38:03   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 413118
)
20:38:03   #train: 8770, #valid: 3172, #test: 6254
20:38:03   Preprocess training set
20:38:03   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(406864, 413118)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(394922, 403692)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(403692, 406864)}}
20:38:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:38:03   Epoch 0 begin
20:38:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:38:06   binary cross entropy: 0.700175
20:40:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:40:55   binary cross entropy: 0.506775
20:41:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:41:56   Epoch 0 end
20:41:56   duration: 3.87 mins
20:41:56   speed: 0.59 batch / sec
20:41:56   ETA: 3.87 mins
20:41:56   max GPU memory: 47433.5 MiB
20:41:56   ------------------------------
20:41:56   average binary cross entropy: 0.578133
20:41:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:41:56   Epoch 1 begin
20:43:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:43:42   binary cross entropy: 0.451413
20:45:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:45:47   Epoch 1 end
20:45:47   duration: 3.86 mins
20:45:47   speed: 0.60 batch / sec
20:45:47   ETA: 0.00 secs
20:45:47   max GPU memory: 47433.5 MiB
20:45:47   ------------------------------
20:45:47   average binary cross entropy: 0.52696
20:45:47   Save checkpoint to model_epoch_2.pth
20:45:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:45:47   Evaluate on valid
20:46:31   ------------------------------
20:46:31   ap: 0.958108
20:46:31   auroc: 0.934669
20:46:31   hits@1: 0.272541
20:46:31   hits@10: 0.479823
20:46:31   hits@100: 0.667087
20:46:31   hits@20: 0.536885
20:46:31   hits@3: 0.366015
20:46:31   hits@50: 0.613335
20:46:31   mr: 795.203
20:46:31   mrr: 0.341222
20:46:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:46:31   Epoch 2 begin
20:47:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:47:13   binary cross entropy: 0.484297
20:50:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:50:02   binary cross entropy: 0.504182
20:50:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:50:22   Epoch 2 end
20:50:22   duration: 4.58 mins
20:50:22   speed: 0.50 batch / sec
20:50:22   ETA: 4.58 mins
20:50:22   max GPU memory: 47456.1 MiB
20:50:22   ------------------------------
20:50:22   average binary cross entropy: 0.525627
20:50:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:50:22   Epoch 3 begin
20:52:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:52:49   binary cross entropy: 0.479672
20:54:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:54:13   Epoch 3 end
20:54:13   duration: 3.86 mins
20:54:13   speed: 0.60 batch / sec
20:54:13   ETA: 0.00 secs
20:54:13   max GPU memory: 47456.1 MiB
20:54:13   ------------------------------
20:54:13   average binary cross entropy: 0.510815
20:54:13   Save checkpoint to model_epoch_4.pth
20:54:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:54:14   Evaluate on valid
20:54:59   ------------------------------
20:54:59   ap: 0.964372
20:54:59   auroc: 0.945697
20:54:59   hits@1: 0.286255
20:54:59   hits@10: 0.484552
20:54:59   hits@100: 0.673392
20:54:59   hits@20: 0.540984
20:54:59   hits@3: 0.369483
20:54:59   hits@50: 0.616015
20:54:59   mr: 742.412
20:54:59   mrr: 0.350503
20:54:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:54:59   Epoch 4 begin
20:56:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:56:21   binary cross entropy: 0.52004
20:58:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:58:50   Epoch 4 end
20:58:50   duration: 4.60 mins
20:58:50   speed: 0.50 batch / sec
20:58:50   ETA: 4.60 mins
20:58:50   max GPU memory: 47456.1 MiB
20:58:50   ------------------------------
20:58:50   average binary cross entropy: 0.503463
20:58:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:58:50   Epoch 5 begin
20:59:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:59:08   binary cross entropy: 0.474167
21:01:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:01:57   binary cross entropy: 0.535754
21:02:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:02:41   Epoch 5 end
21:02:41   duration: 3.85 mins
21:02:41   speed: 0.60 batch / sec
21:02:41   ETA: 0.00 secs
21:02:41   max GPU memory: 47456.1 MiB
21:02:41   ------------------------------
21:02:41   average binary cross entropy: 0.493421
21:02:41   Save checkpoint to model_epoch_6.pth
21:02:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:02:41   Evaluate on valid
21:03:24   ------------------------------
21:03:24   ap: 0.974136
21:03:24   auroc: 0.961779
21:03:24   hits@1: 0.308953
21:03:24   hits@10: 0.499842
21:03:24   hits@100: 0.683008
21:03:24   hits@20: 0.557377
21:03:24   hits@3: 0.388714
21:03:24   hits@50: 0.629098
21:03:24   mr: 700.394
21:03:24   mrr: 0.371331
21:03:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:03:24   Epoch 6 begin
21:05:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:05:27   binary cross entropy: 0.49383
21:07:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:07:16   Epoch 6 end
21:07:16   duration: 4.58 mins
21:07:16   speed: 0.50 batch / sec
21:07:16   ETA: 4.58 mins
21:07:16   max GPU memory: 47456.1 MiB
21:07:16   ------------------------------
21:07:16   average binary cross entropy: 0.499342
21:07:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:07:16   Epoch 7 begin
21:08:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:08:15   binary cross entropy: 0.577922
21:11:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:11:04   binary cross entropy: 0.544531
21:11:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:11:07   Epoch 7 end
21:11:07   duration: 3.86 mins
21:11:07   speed: 0.60 batch / sec
21:11:07   ETA: 0.00 secs
21:11:07   max GPU memory: 47456.1 MiB
21:11:07   ------------------------------
21:11:07   average binary cross entropy: 0.492872
21:11:07   Save checkpoint to model_epoch_8.pth
21:11:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:11:08   Evaluate on valid
21:11:51   ------------------------------
21:11:51   ap: 0.971112
21:11:51   auroc: 0.957475
21:11:51   hits@1: 0.309741
21:11:51   hits@10: 0.501576
21:11:51   hits@100: 0.684269
21:11:51   hits@20: 0.553909
21:11:51   hits@3: 0.391866
21:11:51   hits@50: 0.629887
21:11:51   mr: 711.474
21:11:51   mrr: 0.371881
21:11:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:11:51   Epoch 8 begin
21:14:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:14:34   binary cross entropy: 0.492999
21:15:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:15:43   Epoch 8 end
21:15:43   duration: 4.59 mins
21:15:43   speed: 0.50 batch / sec
21:15:43   ETA: 4.59 mins
21:15:43   max GPU memory: 47456.1 MiB
21:15:43   ------------------------------
21:15:43   average binary cross entropy: 0.492609
21:15:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:15:43   Epoch 9 begin
21:17:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:17:22   binary cross entropy: 0.489923
21:19:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:19:34   Epoch 9 end
21:19:34   duration: 3.85 mins
21:19:34   speed: 0.60 batch / sec
21:19:34   ETA: 0.00 secs
21:19:34   max GPU memory: 47456.1 MiB
21:19:34   ------------------------------
21:19:34   average binary cross entropy: 0.48397
21:19:34   Save checkpoint to model_epoch_10.pth
21:19:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:19:34   Evaluate on valid
21:20:18   ------------------------------
21:20:18   ap: 0.973117
21:20:18   auroc: 0.958914
21:20:18   hits@1: 0.320776
21:20:18   hits@10: 0.500315
21:20:18   hits@100: 0.690574
21:20:18   hits@20: 0.559584
21:20:18   hits@3: 0.398644
21:20:18   hits@50: 0.635088
21:20:18   mr: 684.585
21:20:18   mrr: 0.380488
21:20:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:20:18   Epoch 10 begin
21:20:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:20:53   binary cross entropy: 0.467754
21:23:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:23:41   binary cross entropy: 0.559834
21:24:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:24:09   Epoch 10 end
21:24:09   duration: 4.58 mins
21:24:09   speed: 0.50 batch / sec
21:24:09   ETA: 4.58 mins
21:24:09   max GPU memory: 47456.1 MiB
21:24:09   ------------------------------
21:24:09   average binary cross entropy: 0.481806
21:24:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:24:09   Epoch 11 begin
21:26:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:26:29   binary cross entropy: 0.520627
21:28:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:28:00   Epoch 11 end
21:28:00   duration: 3.85 mins
21:28:00   speed: 0.60 batch / sec
21:28:00   ETA: 0.00 secs
21:28:00   max GPU memory: 47456.1 MiB
21:28:00   ------------------------------
21:28:00   average binary cross entropy: 0.482769
21:28:00   Save checkpoint to model_epoch_12.pth
21:28:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:28:00   Evaluate on valid
21:28:44   ------------------------------
21:28:44   ap: 0.979737
21:28:44   auroc: 0.970303
21:28:44   hits@1: 0.322667
21:28:44   hits@10: 0.507409
21:28:44   hits@100: 0.692623
21:28:44   hits@20: 0.564628
21:28:44   hits@3: 0.403846
21:28:44   hits@50: 0.637295
21:28:44   mr: 673.847
21:28:44   mrr: 0.383501
21:28:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:28:44   Epoch 12 begin
21:29:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:29:59   binary cross entropy: 0.468455
21:32:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:32:34   Epoch 12 end
21:32:34   duration: 4.58 mins
21:32:34   speed: 0.50 batch / sec
21:32:34   ETA: 4.58 mins
21:32:34   max GPU memory: 47456.1 MiB
21:32:34   ------------------------------
21:32:34   average binary cross entropy: 0.491338
21:32:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:32:34   Epoch 13 begin
21:32:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:32:46   binary cross entropy: 0.450575
21:35:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:35:35   binary cross entropy: 0.52138
21:36:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:36:26   Epoch 13 end
21:36:26   duration: 3.86 mins
21:36:26   speed: 0.60 batch / sec
21:36:26   ETA: 0.00 secs
21:36:26   max GPU memory: 47456.1 MiB
21:36:26   ------------------------------
21:36:26   average binary cross entropy: 0.485757
21:36:26   Save checkpoint to model_epoch_14.pth
21:36:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:36:26   Evaluate on valid
21:37:10   ------------------------------
21:37:10   ap: 0.971209
21:37:10   auroc: 0.956597
21:37:10   hits@1: 0.330076
21:37:10   hits@10: 0.509143
21:37:10   hits@100: 0.69152
21:37:10   hits@20: 0.565416
21:37:10   hits@3: 0.402427
21:37:10   hits@50: 0.639502
21:37:10   mr: 681.75
21:37:10   mrr: 0.388232
21:37:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:37:10   Epoch 14 begin
21:39:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:39:06   binary cross entropy: 0.455834
21:41:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:41:00   Epoch 14 end
21:41:00   duration: 4.58 mins
21:41:00   speed: 0.50 batch / sec
21:41:00   ETA: 0.00 secs
21:41:00   max GPU memory: 47456.1 MiB
21:41:00   ------------------------------
21:41:00   average binary cross entropy: 0.482686
21:41:00   Save checkpoint to model_epoch_15.pth
21:41:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:41:01   Evaluate on valid
21:41:44   ------------------------------
21:41:44   ap: 0.985685
21:41:44   auroc: 0.980144
21:41:44   hits@1: 0.325504
21:41:44   hits@10: 0.505675
21:41:44   hits@100: 0.691362
21:41:44   hits@20: 0.56116
21:41:44   hits@3: 0.401324
21:41:44   hits@50: 0.636665
21:41:44   mr: 660.937
21:41:44   mrr: 0.383774
21:41:44   Load checkpoint from model_epoch_14.pth
21:41:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:41:44   Evaluate on valid
21:42:28   ------------------------------
21:42:28   ap: 0.97135
21:42:28   auroc: 0.957119
21:42:28   hits@1: 0.330076
21:42:28   hits@10: 0.509143
21:42:28   hits@100: 0.69152
21:42:28   hits@20: 0.565416
21:42:28   hits@3: 0.402427
21:42:28   hits@50: 0.639502
21:42:28   mr: 681.75
21:42:28   mrr: 0.388232
21:42:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
21:42:28   Evaluate on test
21:43:53   ------------------------------
21:43:53   ap: 0.972502
21:43:53   auroc: 0.959152
21:43:53   hits@1: 0.329709
21:43:53   hits@10: 0.508155
21:43:53   hits@100: 0.696514
21:43:53   hits@20: 0.568436
21:43:53   hits@3: 0.403262
21:43:53   hits@50: 0.641669
21:43:53   mr: 685.127
21:43:53   mrr: 0.387914
