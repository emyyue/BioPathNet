20:00:24   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-11-20-00-24-698378
20:00:24   Input Seed: 1238
20:00:24   Set Seed: 1238
20:00:24   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
20:00:24   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr040/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
20:00:25   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 407064
)
20:00:25   #train: 7038, #valid: 2568, #test: 5029
20:00:25   Preprocess training set
20:00:25   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr040/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(402035, 407064)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr040/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(392429, 399467)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr040/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(399467, 402035)}}
20:00:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:00:25   Epoch 0 begin
20:00:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:00:31   binary cross entropy: 0.706216
20:03:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:03:16   binary cross entropy: 0.446595
20:03:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:03:30   Epoch 0 end
20:03:30   duration: 3.08 mins
20:03:30   speed: 0.59 batch / sec
20:03:30   ETA: 3.08 mins
20:03:30   max GPU memory: 47427.8 MiB
20:03:30   ------------------------------
20:03:30   average binary cross entropy: 0.522448
20:03:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:03:30   Epoch 1 begin
20:06:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:06:01   binary cross entropy: 0.401535
20:06:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:06:33   Epoch 1 end
20:06:33   duration: 3.04 mins
20:06:33   speed: 0.60 batch / sec
20:06:33   ETA: 0.00 secs
20:06:33   max GPU memory: 47427.8 MiB
20:06:33   ------------------------------
20:06:33   average binary cross entropy: 0.448828
20:06:33   Save checkpoint to model_epoch_2.pth
20:06:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:06:33   Evaluate on valid
20:07:07   ------------------------------
20:07:07   ap: 0.99369
20:07:07   auroc: 0.993376
20:07:07   hits@1: 0.356114
20:07:07   hits@10: 0.584112
20:07:07   hits@100: 0.784463
20:07:07   hits@20: 0.642134
20:07:07   hits@3: 0.457944
20:07:07   hits@50: 0.726636
20:07:07   mr: 542.423
20:07:07   mrr: 0.430508
20:07:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:07:07   Epoch 2 begin
20:09:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:09:21   binary cross entropy: 0.493675
20:10:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:10:09   Epoch 2 end
20:10:09   duration: 3.61 mins
20:10:09   speed: 0.51 batch / sec
20:10:09   ETA: 3.61 mins
20:10:09   max GPU memory: 47451.0 MiB
20:10:09   ------------------------------
20:10:09   average binary cross entropy: 0.44519
20:10:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:10:09   Epoch 3 begin
20:12:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:12:06   binary cross entropy: 0.374583
20:13:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:13:10   Epoch 3 end
20:13:10   duration: 3.02 mins
20:13:10   speed: 0.61 batch / sec
20:13:10   ETA: 0.00 secs
20:13:10   max GPU memory: 47451.0 MiB
20:13:10   ------------------------------
20:13:10   average binary cross entropy: 0.431733
20:13:10   Save checkpoint to model_epoch_4.pth
20:13:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:13:10   Evaluate on valid
20:13:45   ------------------------------
20:13:45   ap: 0.990038
20:13:45   auroc: 0.988589
20:13:45   hits@1: 0.342679
20:13:45   hits@10: 0.586449
20:13:45   hits@100: 0.797313
20:13:45   hits@20: 0.647586
20:13:45   hits@3: 0.457555
20:13:45   hits@50: 0.73345
20:13:45   mr: 477.063
20:13:45   mrr: 0.423297
20:13:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:13:45   Epoch 4 begin
20:15:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:15:26   binary cross entropy: 0.382407
20:16:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:16:46   Epoch 4 end
20:16:46   duration: 3.60 mins
20:16:46   speed: 0.51 batch / sec
20:16:46   ETA: 3.60 mins
20:16:46   max GPU memory: 47451.0 MiB
20:16:46   ------------------------------
20:16:46   average binary cross entropy: 0.424998
20:16:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:16:46   Epoch 5 begin
20:18:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:18:10   binary cross entropy: 0.405147
20:19:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:19:49   Epoch 5 end
20:19:49   duration: 3.05 mins
20:19:49   speed: 0.60 batch / sec
20:19:49   ETA: 0.00 secs
20:19:49   max GPU memory: 47451.0 MiB
20:19:49   ------------------------------
20:19:49   average binary cross entropy: 0.422535
20:19:49   Save checkpoint to model_epoch_6.pth
20:19:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:19:50   Evaluate on valid
20:20:24   ------------------------------
20:20:24   ap: 0.989549
20:20:24   auroc: 0.986447
20:20:24   hits@1: 0.360981
20:20:24   hits@10: 0.598326
20:20:24   hits@100: 0.798287
20:20:24   hits@20: 0.655179
20:20:24   hits@3: 0.475273
20:20:24   hits@50: 0.736565
20:20:24   mr: 465.969
20:20:24   mrr: 0.442042
20:20:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:20:24   Epoch 6 begin
20:21:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:21:31   binary cross entropy: 0.44343
20:23:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:23:25   Epoch 6 end
20:23:25   duration: 3.59 mins
20:23:25   speed: 0.51 batch / sec
20:23:25   ETA: 3.59 mins
20:23:25   max GPU memory: 47451.0 MiB
20:23:25   ------------------------------
20:23:25   average binary cross entropy: 0.417697
20:23:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:23:25   Epoch 7 begin
20:24:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:24:16   binary cross entropy: 0.334793
20:26:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:26:27   Epoch 7 end
20:26:27   duration: 3.04 mins
20:26:27   speed: 0.60 batch / sec
20:26:27   ETA: 0.00 secs
20:26:27   max GPU memory: 47451.0 MiB
20:26:27   ------------------------------
20:26:27   average binary cross entropy: 0.416141
20:26:27   Save checkpoint to model_epoch_8.pth
20:26:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:26:27   Evaluate on valid
20:27:01   ------------------------------
20:27:01   ap: 0.991336
20:27:01   auroc: 0.989789
20:27:01   hits@1: 0.372469
20:27:01   hits@10: 0.585864
20:27:01   hits@100: 0.788551
20:27:01   hits@20: 0.649533
20:27:01   hits@3: 0.479751
20:27:01   hits@50: 0.728388
20:27:01   mr: 464.356
20:27:01   mrr: 0.445522
20:27:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:27:01   Epoch 8 begin
20:27:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:27:36   binary cross entropy: 0.398086
20:30:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:30:03   Epoch 8 end
20:30:03   duration: 3.60 mins
20:30:03   speed: 0.51 batch / sec
20:30:03   ETA: 3.60 mins
20:30:03   max GPU memory: 47451.0 MiB
20:30:03   ------------------------------
20:30:03   average binary cross entropy: 0.413331
20:30:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:30:03   Epoch 9 begin
20:30:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:30:21   binary cross entropy: 0.40937
20:33:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:33:04   Epoch 9 end
20:33:04   duration: 3.02 mins
20:33:04   speed: 0.61 batch / sec
20:33:04   ETA: 0.00 secs
20:33:04   max GPU memory: 47451.0 MiB
20:33:04   ------------------------------
20:33:04   average binary cross entropy: 0.41788
20:33:04   Save checkpoint to model_epoch_10.pth
20:33:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:33:05   Evaluate on valid
20:33:39   ------------------------------
20:33:39   ap: 0.989749
20:33:39   auroc: 0.987435
20:33:39   hits@1: 0.388824
20:33:39   hits@10: 0.600273
20:33:39   hits@100: 0.797897
20:33:39   hits@20: 0.656737
20:33:39   hits@3: 0.488512
20:33:39   hits@50: 0.739486
20:33:39   mr: 448.023
20:33:39   mrr: 0.459864
20:33:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:33:39   Epoch 10 begin
20:33:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:33:40   binary cross entropy: 0.376721
20:36:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:36:25   binary cross entropy: 0.40934
20:36:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:36:39   Epoch 10 end
20:36:39   duration: 3.59 mins
20:36:39   speed: 0.51 batch / sec
20:36:39   ETA: 3.59 mins
20:36:39   max GPU memory: 47451.0 MiB
20:36:39   ------------------------------
20:36:39   average binary cross entropy: 0.41148
20:36:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:36:39   Epoch 11 begin
20:39:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:39:09   binary cross entropy: 0.428808
20:39:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:39:41   Epoch 11 end
20:39:41   duration: 3.02 mins
20:39:41   speed: 0.61 batch / sec
20:39:41   ETA: 0.00 secs
20:39:41   max GPU memory: 47451.0 MiB
20:39:41   ------------------------------
20:39:41   average binary cross entropy: 0.403703
20:39:41   Save checkpoint to model_epoch_12.pth
20:39:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:39:41   Evaluate on valid
20:40:15   ------------------------------
20:40:15   ap: 0.992917
20:40:15   auroc: 0.990902
20:40:15   hits@1: 0.386293
20:40:15   hits@10: 0.59852
20:40:15   hits@100: 0.798092
20:40:15   hits@20: 0.659657
20:40:15   hits@3: 0.484229
20:40:15   hits@50: 0.739875
20:40:15   mr: 428.871
20:40:15   mrr: 0.456178
20:40:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:40:15   Epoch 12 begin
20:42:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:42:28   binary cross entropy: 0.40833
20:43:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:43:16   Epoch 12 end
20:43:16   duration: 3.59 mins
20:43:16   speed: 0.51 batch / sec
20:43:16   ETA: 3.59 mins
20:43:16   max GPU memory: 47451.0 MiB
20:43:16   ------------------------------
20:43:16   average binary cross entropy: 0.401786
20:43:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:43:16   Epoch 13 begin
20:45:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:45:13   binary cross entropy: 0.407409
20:46:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:46:18   Epoch 13 end
20:46:18   duration: 3.04 mins
20:46:18   speed: 0.60 batch / sec
20:46:18   ETA: 0.00 secs
20:46:18   max GPU memory: 47451.0 MiB
20:46:18   ------------------------------
20:46:18   average binary cross entropy: 0.400399
20:46:18   Save checkpoint to model_epoch_14.pth
20:46:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:46:18   Evaluate on valid
20:46:52   ------------------------------
20:46:52   ap: 0.989956
20:46:52   auroc: 0.987524
20:46:52   hits@1: 0.381425
20:46:52   hits@10: 0.604751
20:46:52   hits@100: 0.79926
20:46:52   hits@20: 0.668614
20:46:52   hits@3: 0.488318
20:46:52   hits@50: 0.741822
20:46:52   mr: 440.909
20:46:52   mrr: 0.456653
20:46:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:46:52   Epoch 14 begin
20:48:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:48:33   binary cross entropy: 0.295889
20:49:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:49:53   Epoch 14 end
20:49:53   duration: 3.59 mins
20:49:53   speed: 0.51 batch / sec
20:49:53   ETA: 0.00 secs
20:49:53   max GPU memory: 47451.0 MiB
20:49:53   ------------------------------
20:49:53   average binary cross entropy: 0.400054
20:49:53   Save checkpoint to model_epoch_15.pth
20:49:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:49:54   Evaluate on valid
20:50:28   ------------------------------
20:50:28   ap: 0.989686
20:50:28   auroc: 0.987276
20:50:28   hits@1: 0.386877
20:50:28   hits@10: 0.602804
20:50:28   hits@100: 0.800818
20:50:28   hits@20: 0.659852
20:50:28   hits@3: 0.485592
20:50:28   hits@50: 0.742212
20:50:28   mr: 450.178
20:50:28   mrr: 0.458619
20:50:28   Load checkpoint from model_epoch_10.pth
20:50:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:50:28   Evaluate on valid
20:51:02   ------------------------------
20:51:02   ap: 0.989558
20:51:02   auroc: 0.987296
20:51:02   hits@1: 0.388824
20:51:02   hits@10: 0.600273
20:51:02   hits@100: 0.797897
20:51:02   hits@20: 0.656737
20:51:02   hits@3: 0.488512
20:51:02   hits@50: 0.739486
20:51:02   mr: 448.023
20:51:02   mrr: 0.459864
20:51:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:51:02   Evaluate on test
20:52:09   ------------------------------
20:52:09   ap: 0.990585
20:52:09   auroc: 0.98894
20:52:09   hits@1: 0.393418
20:52:09   hits@10: 0.606681
20:52:09   hits@100: 0.814078
20:52:09   hits@20: 0.668622
20:52:09   hits@3: 0.490058
20:52:09   hits@50: 0.75353
20:52:09   mr: 430.552
20:52:09   mrr: 0.464447
