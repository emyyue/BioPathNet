19:00:22   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-14-19-00-22-786165
19:00:22   Input Seed: 1234
19:00:22   Set Seed: 1234
19:00:22   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
19:00:22   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
19:00:23   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 416172
)
19:00:23   #train: 9617, #valid: 3447, #test: 6887
19:00:23   Preprocess training set
19:00:24   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(409285, 416172)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(396221, 405838)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr020/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(405838, 409285)}}
19:00:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:00:24   Epoch 0 begin
19:00:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:00:27   binary cross entropy: 0.719466
19:03:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:03:23   binary cross entropy: 0.591487
19:04:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:04:49   Epoch 0 end
19:04:49   duration: 4.43 mins
19:04:49   speed: 0.57 batch / sec
19:04:49   ETA: 4.43 mins
19:04:49   max GPU memory: 47439.1 MiB
19:04:49   ------------------------------
19:04:49   average binary cross entropy: 0.582565
19:04:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:04:49   Epoch 1 begin
19:06:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:06:17   binary cross entropy: 0.610583
19:09:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:09:12   binary cross entropy: 0.553435
19:09:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:09:13   Epoch 1 end
19:09:13   duration: 4.39 mins
19:09:13   speed: 0.57 batch / sec
19:09:13   ETA: 0.00 secs
19:09:13   max GPU memory: 47439.1 MiB
19:09:13   ------------------------------
19:09:13   average binary cross entropy: 0.537725
19:09:13   Save checkpoint to model_epoch_2.pth
19:09:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:09:13   Evaluate on valid
19:10:00   ------------------------------
19:10:00   ap: 0.97571
19:10:00   auroc: 0.965259
19:10:00   hits@1: 0.263272
19:10:00   hits@10: 0.442414
19:10:00   hits@100: 0.630693
19:10:00   hits@20: 0.496809
19:10:00   hits@3: 0.346678
19:10:00   hits@50: 0.574268
19:10:00   mr: 803.94
19:10:00   mrr: 0.323924
19:10:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:10:00   Epoch 2 begin
19:12:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:12:53   binary cross entropy: 0.53574
19:14:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:14:23   Epoch 2 end
19:14:23   duration: 5.17 mins
19:14:23   speed: 0.49 batch / sec
19:14:23   ETA: 5.17 mins
19:14:23   max GPU memory: 47462.3 MiB
19:14:23   ------------------------------
19:14:23   average binary cross entropy: 0.523383
19:14:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:14:23   Epoch 3 begin
19:15:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:15:48   binary cross entropy: 0.534721
19:18:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:18:43   binary cross entropy: 0.487302
19:18:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:18:47   Epoch 3 end
19:18:47   duration: 4.41 mins
19:18:47   speed: 0.57 batch / sec
19:18:47   ETA: 0.00 secs
19:18:48   max GPU memory: 47462.3 MiB
19:18:48   ------------------------------
19:18:48   average binary cross entropy: 0.519854
19:18:48   Save checkpoint to model_epoch_4.pth
19:18:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:18:48   Evaluate on valid
19:19:36   ------------------------------
19:19:36   ap: 0.976861
19:19:36   auroc: 0.965853
19:19:36   hits@1: 0.276907
19:19:36   hits@10: 0.45924
19:19:36   hits@100: 0.642153
19:19:36   hits@20: 0.515376
19:19:36   hits@3: 0.360168
19:19:36   hits@50: 0.584856
19:19:36   mr: 791.057
19:19:36   mrr: 0.338256
19:19:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:19:36   Epoch 4 begin
19:22:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:22:24   binary cross entropy: 0.494843
19:23:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:23:57   Epoch 4 end
19:23:57   duration: 5.16 mins
19:23:57   speed: 0.49 batch / sec
19:23:57   ETA: 5.16 mins
19:23:57   max GPU memory: 47462.3 MiB
19:23:57   ------------------------------
19:23:57   average binary cross entropy: 0.517665
19:23:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:23:57   Epoch 5 begin
19:25:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:25:17   binary cross entropy: 0.528184
19:28:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:28:14   binary cross entropy: 0.566179
19:28:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:28:21   Epoch 5 end
19:28:21   duration: 4.40 mins
19:28:21   speed: 0.57 batch / sec
19:28:21   ETA: 0.00 secs
19:28:21   max GPU memory: 47462.3 MiB
19:28:21   ------------------------------
19:28:21   average binary cross entropy: 0.512956
19:28:21   Save checkpoint to model_epoch_6.pth
19:28:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:28:21   Evaluate on valid
19:29:09   ------------------------------
19:29:09   ap: 0.968679
19:29:09   auroc: 0.955978
19:29:09   hits@1: 0.287061
19:29:09   hits@10: 0.459965
19:29:09   hits@100: 0.647375
19:29:09   hits@20: 0.51291
19:29:09   hits@3: 0.366115
19:29:09   hits@50: 0.590949
19:29:09   mr: 769.247
19:29:09   mrr: 0.345157
19:29:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:29:09   Epoch 6 begin
19:31:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:31:57   binary cross entropy: 0.536477
19:33:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:33:35   Epoch 6 end
19:33:35   duration: 5.23 mins
19:33:35   speed: 0.48 batch / sec
19:33:35   ETA: 5.23 mins
19:33:35   max GPU memory: 47462.3 MiB
19:33:35   ------------------------------
19:33:35   average binary cross entropy: 0.511728
19:33:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:33:35   Epoch 7 begin
19:34:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:34:52   binary cross entropy: 0.504944
19:37:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:37:51   binary cross entropy: 0.434235
19:38:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:38:03   Epoch 7 end
19:38:03   duration: 4.46 mins
19:38:03   speed: 0.56 batch / sec
19:38:03   ETA: 0.00 secs
19:38:03   max GPU memory: 47462.3 MiB
19:38:03   ------------------------------
19:38:03   average binary cross entropy: 0.510387
19:38:03   Save checkpoint to model_epoch_8.pth
19:38:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:38:03   Evaluate on valid
19:38:50   ------------------------------
19:38:50   ap: 0.966054
19:38:50   auroc: 0.948522
19:38:50   hits@1: 0.293589
19:38:50   hits@10: 0.466202
19:38:50   hits@100: 0.653032
19:38:50   hits@20: 0.518132
19:38:50   hits@3: 0.371192
19:38:50   hits@50: 0.595735
19:38:50   mr: 752.725
19:38:50   mrr: 0.351427
19:38:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:38:50   Epoch 8 begin
19:41:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:41:35   binary cross entropy: 0.422974
19:43:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:43:17   Epoch 8 end
19:43:17   duration: 5.25 mins
19:43:17   speed: 0.48 batch / sec
19:43:17   ETA: 5.25 mins
19:43:17   max GPU memory: 47462.3 MiB
19:43:17   ------------------------------
19:43:17   average binary cross entropy: 0.504898
19:43:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:43:17   Epoch 9 begin
19:44:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:44:32   binary cross entropy: 0.5354
19:47:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:47:27   binary cross entropy: 0.514253
19:47:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:47:42   Epoch 9 end
19:47:42   duration: 4.41 mins
19:47:42   speed: 0.57 batch / sec
19:47:42   ETA: 0.00 secs
19:47:42   max GPU memory: 47462.3 MiB
19:47:42   ------------------------------
19:47:42   average binary cross entropy: 0.508865
19:47:42   Save checkpoint to model_epoch_10.pth
19:47:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:47:42   Evaluate on valid
19:48:29   ------------------------------
19:48:29   ap: 0.972228
19:48:29   auroc: 0.959454
19:48:29   hits@1: 0.301276
19:48:29   hits@10: 0.468088
19:48:29   hits@100: 0.656658
19:48:29   hits@20: 0.522773
19:48:29   hits@3: 0.374529
19:48:29   hits@50: 0.599217
19:48:29   mr: 748.079
19:48:29   mrr: 0.357487
19:48:29   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:48:29   Epoch 10 begin
19:51:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:51:10   binary cross entropy: 0.563653
19:52:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:52:55   Epoch 10 end
19:52:55   duration: 5.23 mins
19:52:55   speed: 0.48 batch / sec
19:52:55   ETA: 5.23 mins
19:52:55   max GPU memory: 47462.3 MiB
19:52:55   ------------------------------
19:52:55   average binary cross entropy: 0.504411
19:52:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:52:55   Epoch 11 begin
19:54:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:54:07   binary cross entropy: 0.578809
19:57:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:57:05   binary cross entropy: 0.49393
19:57:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:57:23   Epoch 11 end
19:57:23   duration: 4.47 mins
19:57:23   speed: 0.56 batch / sec
19:57:23   ETA: 0.00 secs
19:57:23   max GPU memory: 47462.3 MiB
19:57:23   ------------------------------
19:57:23   average binary cross entropy: 0.506813
19:57:23   Save checkpoint to model_epoch_12.pth
19:57:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:57:24   Evaluate on valid
19:58:10   ------------------------------
19:58:10   ap: 0.967234
19:58:10   auroc: 0.949812
19:58:10   hits@1: 0.293299
19:58:10   hits@10: 0.467363
19:58:10   hits@100: 0.657238
19:58:10   hits@20: 0.522048
19:58:10   hits@3: 0.369452
19:58:10   hits@50: 0.596896
19:58:10   mr: 736.264
19:58:10   mrr: 0.351472
19:58:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
19:58:10   Epoch 12 begin
20:00:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:00:46   binary cross entropy: 0.52868
20:02:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:02:33   Epoch 12 end
20:02:33   duration: 5.16 mins
20:02:33   speed: 0.49 batch / sec
20:02:33   ETA: 5.16 mins
20:02:33   max GPU memory: 47462.3 MiB
20:02:33   ------------------------------
20:02:33   average binary cross entropy: 0.499995
20:02:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:02:33   Epoch 13 begin
20:03:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:03:39   binary cross entropy: 0.446374
20:06:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:06:35   binary cross entropy: 0.553074
20:06:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:06:57   Epoch 13 end
20:06:57   duration: 4.40 mins
20:06:57   speed: 0.57 batch / sec
20:06:57   ETA: 0.00 secs
20:06:57   max GPU memory: 47462.3 MiB
20:06:57   ------------------------------
20:06:57   average binary cross entropy: 0.500366
20:06:57   Save checkpoint to model_epoch_14.pth
20:06:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:06:57   Evaluate on valid
20:07:44   ------------------------------
20:07:44   ap: 0.965529
20:07:44   auroc: 0.945861
20:07:44   hits@1: 0.304468
20:07:44   hits@10: 0.469829
20:07:44   hits@100: 0.655498
20:07:44   hits@20: 0.524079
20:07:44   hits@3: 0.375834
20:07:44   hits@50: 0.599797
20:07:44   mr: 734.483
20:07:44   mrr: 0.359759
20:07:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:07:44   Epoch 14 begin
20:10:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:10:16   binary cross entropy: 0.47771
20:12:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:12:05   Epoch 14 end
20:12:05   duration: 5.14 mins
20:12:05   speed: 0.49 batch / sec
20:12:05   ETA: 0.00 secs
20:12:05   max GPU memory: 47462.3 MiB
20:12:05   ------------------------------
20:12:05   average binary cross entropy: 0.496711
20:12:05   Save checkpoint to model_epoch_15.pth
20:12:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:12:05   Evaluate on valid
20:12:53   ------------------------------
20:12:53   ap: 0.962606
20:12:53   auroc: 0.941843
20:12:53   hits@1: 0.303597
20:12:53   hits@10: 0.470699
20:12:53   hits@100: 0.661735
20:12:53   hits@20: 0.528285
20:12:53   hits@3: 0.373803
20:12:53   hits@50: 0.605164
20:12:53   mr: 718.132
20:12:53   mrr: 0.358902
20:12:53   Load checkpoint from model_epoch_14.pth
20:12:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:12:53   Evaluate on valid
20:13:40   ------------------------------
20:13:40   ap: 0.965325
20:13:40   auroc: 0.945686
20:13:40   hits@1: 0.304468
20:13:40   hits@10: 0.469829
20:13:40   hits@100: 0.655498
20:13:40   hits@20: 0.524079
20:13:40   hits@3: 0.375834
20:13:40   hits@50: 0.599797
20:13:40   mr: 734.483
20:13:40   mrr: 0.359759
20:13:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
20:13:40   Evaluate on test
20:15:14   ------------------------------
20:15:14   ap: 0.965624
20:15:14   auroc: 0.946342
20:15:14   hits@1: 0.297517
20:15:14   hits@10: 0.464716
20:15:14   hits@100: 0.655946
20:15:14   hits@20: 0.521272
20:15:14   hits@3: 0.36852
20:15:14   hits@50: 0.597285
20:15:14   mr: 738.052
20:15:14   mrr: 0.352889
