16:12:22   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-26-16-12-22-056211
16:12:27   Input Seed: 1237
16:12:27   Set Seed: 1237
16:12:27   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
16:12:27   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
16:12:28   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 401604
)
16:12:28   #train: 5540, #valid: 2004, #test: 3909
16:12:28   Preprocess training set
16:12:28   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(397695, 401604)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(390151, 395691)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr050/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(395691, 397695)}}
16:12:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:12:28   Epoch 0 begin
16:12:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:12:32   binary cross entropy: 0.681811
16:14:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:14:53   Epoch 0 end
16:14:53   duration: 2.42 mins
16:14:53   speed: 0.60 batch / sec
16:14:53   ETA: 2.42 mins
16:14:53   max GPU memory: 47423.0 MiB
16:14:53   ------------------------------
16:14:53   average binary cross entropy: 0.528957
16:14:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:14:53   Epoch 1 begin
16:15:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:15:16   binary cross entropy: 0.523335
16:17:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:17:15   Epoch 1 end
16:17:15   duration: 2.36 mins
16:17:15   speed: 0.61 batch / sec
16:17:15   ETA: 0.00 secs
16:17:15   max GPU memory: 47423.0 MiB
16:17:15   ------------------------------
16:17:15   average binary cross entropy: 0.471757
16:17:15   Save checkpoint to model_epoch_2.pth
16:17:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:17:15   Evaluate on valid
16:17:42   ------------------------------
16:17:42   ap: 0.992705
16:17:42   auroc: 0.991655
16:17:42   hits@1: 0.286427
16:17:42   hits@10: 0.553892
16:17:42   hits@100: 0.75524
16:17:42   hits@20: 0.618513
16:17:42   hits@3: 0.413174
16:17:42   hits@50: 0.699601
16:17:42   mr: 607.128
16:17:42   mrr: 0.375968
16:17:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:17:42   Epoch 2 begin
16:18:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:18:27   binary cross entropy: 0.430686
16:20:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:20:04   Epoch 2 end
16:20:04   duration: 2.82 mins
16:20:04   speed: 0.51 batch / sec
16:20:04   ETA: 2.82 mins
16:20:04   max GPU memory: 47445.8 MiB
16:20:04   ------------------------------
16:20:04   average binary cross entropy: 0.455627
16:20:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:20:04   Epoch 3 begin
16:21:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:21:10   binary cross entropy: 0.433825
16:22:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:26   Epoch 3 end
16:22:26   duration: 2.37 mins
16:22:26   speed: 0.61 batch / sec
16:22:26   ETA: 0.00 secs
16:22:26   max GPU memory: 47445.8 MiB
16:22:26   ------------------------------
16:22:26   average binary cross entropy: 0.445625
16:22:26   Save checkpoint to model_epoch_4.pth
16:22:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:26   Evaluate on valid
16:22:53   ------------------------------
16:22:53   ap: 0.995624
16:22:53   auroc: 0.994833
16:22:53   hits@1: 0.308383
16:22:53   hits@10: 0.566367
16:22:53   hits@100: 0.75998
16:22:53   hits@20: 0.623752
16:22:53   hits@3: 0.425898
16:22:53   hits@50: 0.700848
16:22:53   mr: 624.075
16:22:53   mrr: 0.391543
16:22:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:22:53   Epoch 4 begin
16:24:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:24:20   binary cross entropy: 0.424892
16:25:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:25:14   Epoch 4 end
16:25:14   duration: 2.80 mins
16:25:14   speed: 0.52 batch / sec
16:25:14   ETA: 2.80 mins
16:25:14   max GPU memory: 47445.8 MiB
16:25:14   ------------------------------
16:25:14   average binary cross entropy: 0.438128
16:25:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:25:14   Epoch 5 begin
16:27:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:27:02   binary cross entropy: 0.471989
16:27:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:27:36   Epoch 5 end
16:27:36   duration: 2.36 mins
16:27:36   speed: 0.61 batch / sec
16:27:36   ETA: 0.00 secs
16:27:36   max GPU memory: 47445.8 MiB
16:27:36   ------------------------------
16:27:36   average binary cross entropy: 0.428946
16:27:36   Save checkpoint to model_epoch_6.pth
16:27:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:27:36   Evaluate on valid
16:28:03   ------------------------------
16:28:03   ap: 0.996575
16:28:03   auroc: 0.995892
16:28:03   hits@1: 0.317116
16:28:03   hits@10: 0.567864
16:28:03   hits@100: 0.768713
16:28:03   hits@20: 0.621008
16:28:03   hits@3: 0.430389
16:28:03   hits@50: 0.707086
16:28:03   mr: 579.383
16:28:03   mrr: 0.399669
16:28:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:28:03   Epoch 6 begin
16:30:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:30:12   binary cross entropy: 0.354812
16:30:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:30:25   Epoch 6 end
16:30:25   duration: 2.81 mins
16:30:25   speed: 0.52 batch / sec
16:30:25   ETA: 2.81 mins
16:30:25   max GPU memory: 47445.8 MiB
16:30:25   ------------------------------
16:30:25   average binary cross entropy: 0.429805
16:30:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:30:25   Epoch 7 begin
16:32:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:32:46   Epoch 7 end
16:32:46   duration: 2.36 mins
16:32:46   speed: 0.61 batch / sec
16:32:46   ETA: 0.00 secs
16:32:46   max GPU memory: 47445.8 MiB
16:32:46   ------------------------------
16:32:46   average binary cross entropy: 0.42788
16:32:46   Save checkpoint to model_epoch_8.pth
16:32:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:32:46   Evaluate on valid
16:33:13   ------------------------------
16:33:13   ap: 0.995716
16:33:13   auroc: 0.994379
16:33:13   hits@1: 0.324601
16:33:13   hits@10: 0.568862
16:33:13   hits@100: 0.767465
16:33:13   hits@20: 0.626747
16:33:13   hits@3: 0.440868
16:33:13   hits@50: 0.707086
16:33:13   mr: 574.554
16:33:13   mrr: 0.406173
16:33:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:33:13   Epoch 8 begin
16:33:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:33:21   binary cross entropy: 0.432157
16:35:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:35:34   Epoch 8 end
16:35:34   duration: 2.80 mins
16:35:34   speed: 0.52 batch / sec
16:35:34   ETA: 2.80 mins
16:35:34   max GPU memory: 47445.8 MiB
16:35:34   ------------------------------
16:35:34   average binary cross entropy: 0.42832
16:35:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:35:34   Epoch 9 begin
16:36:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:36:04   binary cross entropy: 0.454206
16:37:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:56   Epoch 9 end
16:37:56   duration: 2.36 mins
16:37:56   speed: 0.61 batch / sec
16:37:56   ETA: 0.00 secs
16:37:56   max GPU memory: 47445.8 MiB
16:37:56   ------------------------------
16:37:56   average binary cross entropy: 0.419974
16:37:56   Save checkpoint to model_epoch_10.pth
16:37:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:37:56   Evaluate on valid
16:38:23   ------------------------------
16:38:23   ap: 0.99463
16:38:23   auroc: 0.993305
16:38:23   hits@1: 0.329341
16:38:23   hits@10: 0.575599
16:38:23   hits@100: 0.772455
16:38:23   hits@20: 0.629741
16:38:23   hits@3: 0.442365
16:38:23   hits@50: 0.712325
16:38:23   mr: 574.781
16:38:23   mrr: 0.411021
16:38:23   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:38:23   Epoch 10 begin
16:39:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:39:14   binary cross entropy: 0.361557
16:40:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:40:44   Epoch 10 end
16:40:44   duration: 2.81 mins
16:40:44   speed: 0.52 batch / sec
16:40:44   ETA: 2.81 mins
16:40:44   max GPU memory: 47445.8 MiB
16:40:44   ------------------------------
16:40:44   average binary cross entropy: 0.419511
16:40:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:40:44   Epoch 11 begin
16:41:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:41:57   binary cross entropy: 0.358364
16:43:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:43:07   Epoch 11 end
16:43:07   duration: 2.37 mins
16:43:07   speed: 0.61 batch / sec
16:43:07   ETA: 0.00 secs
16:43:07   max GPU memory: 47445.8 MiB
16:43:07   ------------------------------
16:43:07   average binary cross entropy: 0.417185
16:43:07   Save checkpoint to model_epoch_12.pth
16:43:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:43:07   Evaluate on valid
16:43:34   ------------------------------
16:43:34   ap: 0.995487
16:43:34   auroc: 0.994439
16:43:34   hits@1: 0.333084
16:43:34   hits@10: 0.571108
16:43:34   hits@100: 0.772705
16:43:34   hits@20: 0.630738
16:43:34   hits@3: 0.449351
16:43:34   hits@50: 0.713323
16:43:34   mr: 570.967
16:43:34   mrr: 0.414671
16:43:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:43:34   Epoch 12 begin
16:45:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:08   binary cross entropy: 0.317218
16:45:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:56   Epoch 12 end
16:45:57   duration: 2.84 mins
16:45:57   speed: 0.51 batch / sec
16:45:57   ETA: 2.84 mins
16:45:57   max GPU memory: 47445.8 MiB
16:45:57   ------------------------------
16:45:57   average binary cross entropy: 0.412537
16:45:57   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:45:57   Epoch 13 begin
16:47:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:47:52   binary cross entropy: 0.388108
16:48:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:48:19   Epoch 13 end
16:48:19   duration: 2.37 mins
16:48:19   speed: 0.61 batch / sec
16:48:19   ETA: 0.00 secs
16:48:19   max GPU memory: 47445.8 MiB
16:48:19   ------------------------------
16:48:19   average binary cross entropy: 0.41686
16:48:19   Save checkpoint to model_epoch_14.pth
16:48:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:48:19   Evaluate on valid
16:48:46   ------------------------------
16:48:46   ap: 0.996469
16:48:46   auroc: 0.996209
16:48:46   hits@1: 0.334581
16:48:46   hits@10: 0.578842
16:48:46   hits@100: 0.771457
16:48:46   hits@20: 0.626497
16:48:46   hits@3: 0.456337
16:48:46   hits@50: 0.708832
16:48:46   mr: 578.205
16:48:46   mrr: 0.417131
16:48:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:48:46   Epoch 14 begin
16:51:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:01   binary cross entropy: 0.412562
16:51:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:07   Epoch 14 end
16:51:07   duration: 2.80 mins
16:51:07   speed: 0.52 batch / sec
16:51:07   ETA: 0.00 secs
16:51:07   max GPU memory: 47445.8 MiB
16:51:07   ------------------------------
16:51:07   average binary cross entropy: 0.410138
16:51:07   Save checkpoint to model_epoch_15.pth
16:51:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:07   Evaluate on valid
16:51:34   ------------------------------
16:51:34   ap: 0.994554
16:51:34   auroc: 0.99354
16:51:34   hits@1: 0.337824
16:51:34   hits@10: 0.576597
16:51:34   hits@100: 0.77021
16:51:34   hits@20: 0.629491
16:51:34   hits@3: 0.454591
16:51:34   hits@50: 0.712325
16:51:34   mr: 566.037
16:51:34   mrr: 0.419119
16:51:34   Load checkpoint from model_epoch_15.pth
16:51:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:51:34   Evaluate on valid
16:52:00   ------------------------------
16:52:00   ap: 0.994554
16:52:00   auroc: 0.993442
16:52:00   hits@1: 0.337824
16:52:00   hits@10: 0.576597
16:52:00   hits@100: 0.77021
16:52:00   hits@20: 0.629491
16:52:00   hits@3: 0.454591
16:52:00   hits@50: 0.712325
16:52:00   mr: 566.037
16:52:00   mrr: 0.419119
16:52:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
16:52:00   Evaluate on test
16:52:52   ------------------------------
16:52:52   ap: 0.994562
16:52:52   auroc: 0.993029
16:52:52   hits@1: 0.34638
16:52:52   hits@10: 0.587362
16:52:52   hits@100: 0.786135
16:52:52   hits@20: 0.646969
16:52:52   hits@3: 0.460987
16:52:52   hits@50: 0.725889
16:52:52   mr: 560.012
16:52:52   mrr: 0.427127
