01:11:07   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-10-01-11-04-678604
01:11:07   Input Seed: 1235
01:11:07   Set Seed: 1235
01:11:07   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
01:11:07   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
01:11:08   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 393442
)
01:11:08   #train: 3274, #valid: 1184, #test: 2279
01:11:08   Preprocess training set
01:11:08   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(391163, 393442)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(386705, 389979)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr060/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(389979, 391163)}}
01:11:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:11:08   Epoch 0 begin
01:11:12   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:11:12   binary cross entropy: 0.722962
01:12:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:12:33   Epoch 0 end
01:12:33   duration: 1.40 mins
01:12:33   speed: 0.62 batch / sec
01:12:33   ETA: 1.40 mins
01:12:33   max GPU memory: 47415.8 MiB
01:12:33   ------------------------------
01:12:33   average binary cross entropy: 0.588405
01:12:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:12:33   Epoch 1 begin
01:13:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:52   binary cross entropy: 0.526459
01:13:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:55   Epoch 1 end
01:13:55   duration: 1.38 mins
01:13:55   speed: 0.63 batch / sec
01:13:55   ETA: 0.00 secs
01:13:55   max GPU memory: 47415.8 MiB
01:13:55   ------------------------------
01:13:55   average binary cross entropy: 0.527638
01:13:55   Save checkpoint to model_epoch_2.pth
01:13:55   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:13:55   Evaluate on valid
01:14:11   ------------------------------
01:14:11   ap: 0.992156
01:14:11   auroc: 0.990474
01:14:11   hits@1: 0.0709459
01:14:11   hits@10: 0.341639
01:14:11   hits@100: 0.694679
01:14:11   hits@20: 0.445524
01:14:11   hits@3: 0.170608
01:14:11   hits@50: 0.600084
01:14:11   mr: 686.331
01:14:11   mrr: 0.155994
01:14:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:14:11   Epoch 2 begin
01:15:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:15:34   Epoch 2 end
01:15:34   duration: 1.65 mins
01:15:34   speed: 0.52 batch / sec
01:15:34   ETA: 1.65 mins
01:15:34   max GPU memory: 47439.6 MiB
01:15:34   ------------------------------
01:15:34   average binary cross entropy: 0.527609
01:15:34   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:15:34   Epoch 3 begin
01:16:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:48   binary cross entropy: 0.496549
01:16:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:58   Epoch 3 end
01:16:58   duration: 1.39 mins
01:16:58   speed: 0.62 batch / sec
01:16:58   ETA: 0.00 secs
01:16:58   max GPU memory: 47439.6 MiB
01:16:58   ------------------------------
01:16:58   average binary cross entropy: 0.518645
01:16:58   Save checkpoint to model_epoch_4.pth
01:16:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:16:58   Evaluate on valid
01:17:15   ------------------------------
01:17:15   ap: 0.990159
01:17:15   auroc: 0.987446
01:17:15   hits@1: 0.112331
01:17:15   hits@10: 0.384713
01:17:15   hits@100: 0.701858
01:17:15   hits@20: 0.470439
01:17:15   hits@3: 0.237753
01:17:15   hits@50: 0.597973
01:17:15   mr: 683.655
01:17:15   mrr: 0.204742
01:17:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:17:15   Epoch 4 begin
01:18:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:18:38   Epoch 4 end
01:18:38   duration: 1.67 mins
01:18:38   speed: 0.52 batch / sec
01:18:38   ETA: 1.67 mins
01:18:38   max GPU memory: 47439.6 MiB
01:18:38   ------------------------------
01:18:38   average binary cross entropy: 0.516127
01:18:38   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:18:38   Epoch 5 begin
01:19:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:19:44   binary cross entropy: 0.546479
01:20:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:20:01   Epoch 5 end
01:20:01   duration: 1.39 mins
01:20:01   speed: 0.63 batch / sec
01:20:01   ETA: 0.00 secs
01:20:01   max GPU memory: 47439.6 MiB
01:20:01   ------------------------------
01:20:01   average binary cross entropy: 0.512685
01:20:01   Save checkpoint to model_epoch_6.pth
01:20:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:20:01   Evaluate on valid
01:20:17   ------------------------------
01:20:17   ap: 0.99513
01:20:17   auroc: 0.994144
01:20:17   hits@1: 0.11402
01:20:17   hits@10: 0.387247
01:20:17   hits@100: 0.701858
01:20:17   hits@20: 0.47973
01:20:17   hits@3: 0.233953
01:20:17   hits@50: 0.603041
01:20:17   mr: 681.114
01:20:17   mrr: 0.206317
01:20:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:20:17   Epoch 6 begin
01:21:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:21:40   Epoch 6 end
01:21:40   duration: 1.66 mins
01:21:40   speed: 0.52 batch / sec
01:21:40   ETA: 1.66 mins
01:21:40   max GPU memory: 47439.6 MiB
01:21:40   ------------------------------
01:21:40   average binary cross entropy: 0.511589
01:21:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:21:40   Epoch 7 begin
01:22:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:22:41   binary cross entropy: 0.456273
01:23:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:23:04   Epoch 7 end
01:23:04   duration: 1.39 mins
01:23:04   speed: 0.63 batch / sec
01:23:04   ETA: 0.00 secs
01:23:04   max GPU memory: 47439.6 MiB
01:23:04   ------------------------------
01:23:04   average binary cross entropy: 0.502282
01:23:04   Save checkpoint to model_epoch_8.pth
01:23:04   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:23:04   Evaluate on valid
01:23:20   ------------------------------
01:23:20   ap: 0.991345
01:23:20   auroc: 0.989986
01:23:20   hits@1: 0.100929
01:23:20   hits@10: 0.380912
01:23:20   hits@100: 0.703547
01:23:20   hits@20: 0.478041
01:23:20   hits@3: 0.22973
01:23:20   hits@50: 0.612753
01:23:20   mr: 669.564
01:23:20   mrr: 0.196134
01:23:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:23:20   Epoch 8 begin
01:24:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:24:43   Epoch 8 end
01:24:43   duration: 1.65 mins
01:24:43   speed: 0.52 batch / sec
01:24:43   ETA: 1.65 mins
01:24:43   max GPU memory: 47439.6 MiB
01:24:43   ------------------------------
01:24:43   average binary cross entropy: 0.500032
01:24:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:24:43   Epoch 9 begin
01:25:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:25:36   binary cross entropy: 0.493632
01:26:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:26:06   Epoch 9 end
01:26:06   duration: 1.39 mins
01:26:06   speed: 0.63 batch / sec
01:26:06   ETA: 0.00 secs
01:26:06   max GPU memory: 47439.6 MiB
01:26:06   ------------------------------
01:26:06   average binary cross entropy: 0.493562
01:26:06   Save checkpoint to model_epoch_10.pth
01:26:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:26:06   Evaluate on valid
01:26:22   ------------------------------
01:26:22   ap: 0.992671
01:26:22   auroc: 0.990933
01:26:22   hits@1: 0.120355
01:26:22   hits@10: 0.387247
01:26:22   hits@100: 0.709459
01:26:22   hits@20: 0.481419
01:26:22   hits@3: 0.234375
01:26:22   hits@50: 0.614865
01:26:22   mr: 659.641
01:26:22   mrr: 0.210033
01:26:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:26:22   Epoch 10 begin
01:27:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:27:45   Epoch 10 end
01:27:45   duration: 1.65 mins
01:27:45   speed: 0.52 batch / sec
01:27:45   ETA: 1.65 mins
01:27:45   max GPU memory: 47439.6 MiB
01:27:45   ------------------------------
01:27:45   average binary cross entropy: 0.497697
01:27:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:27:45   Epoch 11 begin
01:28:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:28:32   binary cross entropy: 0.550562
01:29:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:29:08   Epoch 11 end
01:29:08   duration: 1.39 mins
01:29:08   speed: 0.62 batch / sec
01:29:08   ETA: 0.00 secs
01:29:08   max GPU memory: 47439.6 MiB
01:29:08   ------------------------------
01:29:08   average binary cross entropy: 0.502815
01:29:08   Save checkpoint to model_epoch_12.pth
01:29:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:29:08   Evaluate on valid
01:29:24   ------------------------------
01:29:24   ap: 0.994016
01:29:24   auroc: 0.992395
01:29:24   hits@1: 0.11951
01:29:24   hits@10: 0.396537
01:29:24   hits@100: 0.708615
01:29:24   hits@20: 0.486486
01:29:24   hits@3: 0.236486
01:29:24   hits@50: 0.61402
01:29:24   mr: 665.689
01:29:24   mrr: 0.209803
01:29:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:29:24   Epoch 12 begin
01:30:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:30:47   Epoch 12 end
01:30:47   duration: 1.65 mins
01:30:47   speed: 0.53 batch / sec
01:30:47   ETA: 1.65 mins
01:30:47   max GPU memory: 47439.6 MiB
01:30:47   ------------------------------
01:30:47   average binary cross entropy: 0.496207
01:30:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:30:47   Epoch 13 begin
01:31:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:31:28   binary cross entropy: 0.431634
01:32:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:32:10   Epoch 13 end
01:32:10   duration: 1.39 mins
01:32:10   speed: 0.62 batch / sec
01:32:10   ETA: 0.00 secs
01:32:10   max GPU memory: 47439.6 MiB
01:32:10   ------------------------------
01:32:10   average binary cross entropy: 0.502148
01:32:10   Save checkpoint to model_epoch_14.pth
01:32:11   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:32:11   Evaluate on valid
01:32:26   ------------------------------
01:32:26   ap: 0.992995
01:32:26   auroc: 0.991633
01:32:26   hits@1: 0.124578
01:32:26   hits@10: 0.402872
01:32:26   hits@100: 0.710726
01:32:26   hits@20: 0.485642
01:32:26   hits@3: 0.247044
01:32:26   hits@50: 0.616132
01:32:26   mr: 654.007
01:32:26   mrr: 0.216748
01:32:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:32:26   Epoch 14 begin
01:33:49   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:49   Epoch 14 end
01:33:49   duration: 1.65 mins
01:33:49   speed: 0.52 batch / sec
01:33:49   ETA: 0.00 secs
01:33:49   max GPU memory: 47439.6 MiB
01:33:50   ------------------------------
01:33:50   average binary cross entropy: 0.488019
01:33:50   Save checkpoint to model_epoch_15.pth
01:33:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:33:50   Evaluate on valid
01:34:05   ------------------------------
01:34:05   ap: 0.994653
01:34:05   auroc: 0.993887
01:34:05   hits@1: 0.130068
01:34:05   hits@10: 0.402872
01:34:05   hits@100: 0.706926
01:34:05   hits@20: 0.496199
01:34:05   hits@3: 0.258446
01:34:05   hits@50: 0.619932
01:34:05   mr: 645.188
01:34:05   mrr: 0.223441
01:34:05   Load checkpoint from model_epoch_15.pth
01:34:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:34:05   Evaluate on valid
01:34:21   ------------------------------
01:34:21   ap: 0.993885
01:34:21   auroc: 0.993369
01:34:21   hits@1: 0.130068
01:34:21   hits@10: 0.402872
01:34:21   hits@100: 0.706926
01:34:21   hits@20: 0.496199
01:34:21   hits@3: 0.258446
01:34:21   hits@50: 0.619932
01:34:21   mr: 645.188
01:34:21   mrr: 0.223441
01:34:21   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
01:34:21   Evaluate on test
01:34:51   ------------------------------
01:34:51   ap: 0.994245
01:34:51   auroc: 0.993769
01:34:51   hits@1: 0.112549
01:34:51   hits@10: 0.405441
01:34:51   hits@100: 0.727073
01:34:51   hits@20: 0.496928
01:34:51   hits@3: 0.238482
01:34:51   hits@50: 0.623738
01:34:51   mr: 634.834
01:34:51   mrr: 0.208927
