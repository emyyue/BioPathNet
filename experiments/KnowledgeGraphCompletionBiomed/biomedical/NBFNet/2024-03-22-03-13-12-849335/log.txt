03:13:12   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-22-03-13-12-849335
03:13:12   Input Seed: 1235
03:13:12   Set Seed: 1235
03:13:12   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
03:13:12   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
03:13:13   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 417079
)
03:13:13   #train: 9878, #valid: 3533, #test: 7049
03:13:13   Preprocess training set
03:13:14   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(410030, 417079)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(396619, 406497)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr000/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(406497, 410030)}}
03:13:14   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:13:14   Epoch 0 begin
03:13:16   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:13:16   binary cross entropy: 0.713803
03:16:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:16:07   binary cross entropy: 0.672565
03:17:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:17:37   Epoch 0 end
03:17:37   duration: 4.39 mins
03:17:37   speed: 0.59 batch / sec
03:17:37   ETA: 4.39 mins
03:17:37   max GPU memory: 47436.8 MiB
03:17:37   ------------------------------
03:17:37   average binary cross entropy: 0.591979
03:17:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:17:37   Epoch 1 begin
03:18:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:18:55   binary cross entropy: 0.543525
03:21:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:21:45   binary cross entropy: 0.558783
03:21:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:21:59   Epoch 1 end
03:21:59   duration: 4.37 mins
03:21:59   speed: 0.59 batch / sec
03:21:59   ETA: 0.00 secs
03:21:59   max GPU memory: 47436.8 MiB
03:21:59   ------------------------------
03:21:59   average binary cross entropy: 0.538538
03:21:59   Save checkpoint to model_epoch_2.pth
03:21:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:21:59   Evaluate on valid
03:22:47   ------------------------------
03:22:47   ap: 0.979897
03:22:47   auroc: 0.968533
03:22:47   hits@1: 0.244834
03:22:47   hits@10: 0.43957
03:22:47   hits@100: 0.633314
03:22:47   hits@20: 0.498443
03:22:47   hits@3: 0.332154
03:22:47   hits@50: 0.57062
03:22:47   mr: 836.966
03:22:47   mrr: 0.310103
03:22:47   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:22:47   Epoch 2 begin
03:25:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:25:20   binary cross entropy: 0.589024
03:27:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:27:07   Epoch 2 end
03:27:07   duration: 5.14 mins
03:27:07   speed: 0.50 batch / sec
03:27:07   ETA: 5.14 mins
03:27:07   max GPU memory: 47460.0 MiB
03:27:07   ------------------------------
03:27:07   average binary cross entropy: 0.527147
03:27:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:27:07   Epoch 3 begin
03:28:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:28:08   binary cross entropy: 0.445904
03:30:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:30:57   binary cross entropy: 0.55868
03:31:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:31:28   Epoch 3 end
03:31:28   duration: 4.35 mins
03:31:28   speed: 0.59 batch / sec
03:31:28   ETA: 0.00 secs
03:31:28   max GPU memory: 47460.0 MiB
03:31:28   ------------------------------
03:31:28   average binary cross entropy: 0.520873
03:31:28   Save checkpoint to model_epoch_4.pth
03:31:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:31:28   Evaluate on valid
03:32:15   ------------------------------
03:32:15   ap: 0.974637
03:32:15   auroc: 0.961087
03:32:15   hits@1: 0.269035
03:32:15   hits@10: 0.460232
03:32:15   hits@100: 0.646759
03:32:15   hits@20: 0.516558
03:32:15   hits@3: 0.35126
03:32:15   hits@50: 0.59298
03:32:15   mr: 779.003
03:32:15   mrr: 0.331839
03:32:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:32:15   Epoch 4 begin
03:34:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:34:32   binary cross entropy: 0.528751
03:36:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:36:36   Epoch 4 end
03:36:36   duration: 5.13 mins
03:36:36   speed: 0.50 batch / sec
03:36:36   ETA: 5.13 mins
03:36:36   max GPU memory: 47460.0 MiB
03:36:36   ------------------------------
03:36:36   average binary cross entropy: 0.524867
03:36:36   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:36:36   Epoch 5 begin
03:37:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:37:20   binary cross entropy: 0.613555
03:40:07   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:40:08   binary cross entropy: 0.538164
03:40:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:40:56   Epoch 5 end
03:40:56   duration: 4.34 mins
03:40:56   speed: 0.59 batch / sec
03:40:56   ETA: 0.00 secs
03:40:56   max GPU memory: 47460.0 MiB
03:40:56   ------------------------------
03:40:56   average binary cross entropy: 0.515552
03:40:56   Save checkpoint to model_epoch_6.pth
03:40:56   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:40:56   Evaluate on valid
03:41:44   ------------------------------
03:41:44   ap: 0.989694
03:41:44   auroc: 0.985859
03:41:44   hits@1: 0.271299
03:41:44   hits@10: 0.453014
03:41:44   hits@100: 0.647042
03:41:44   hits@20: 0.51302
03:41:44   hits@3: 0.345882
03:41:44   hits@50: 0.591565
03:41:44   mr: 756.409
03:41:44   mrr: 0.33082
03:41:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:41:44   Epoch 6 begin
03:43:43   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:43:44   binary cross entropy: 0.499809
03:46:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:46:05   Epoch 6 end
03:46:05   duration: 5.14 mins
03:46:05   speed: 0.50 batch / sec
03:46:05   ETA: 5.14 mins
03:46:05   max GPU memory: 47460.0 MiB
03:46:05   ------------------------------
03:46:05   average binary cross entropy: 0.513807
03:46:05   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:46:05   Epoch 7 begin
03:46:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:46:32   binary cross entropy: 0.474222
03:49:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:49:21   binary cross entropy: 0.57299
03:50:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:50:26   Epoch 7 end
03:50:26   duration: 4.34 mins
03:50:26   speed: 0.59 batch / sec
03:50:26   ETA: 0.00 secs
03:50:26   max GPU memory: 47460.0 MiB
03:50:26   ------------------------------
03:50:26   average binary cross entropy: 0.511269
03:50:26   Save checkpoint to model_epoch_8.pth
03:50:26   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:50:26   Evaluate on valid
03:51:13   ------------------------------
03:51:13   ap: 0.990445
03:51:13   auroc: 0.985016
03:51:13   hits@1: 0.288282
03:51:13   hits@10: 0.465893
03:51:13   hits@100: 0.65709
03:51:13   hits@20: 0.523776
03:51:13   hits@3: 0.36711
03:51:13   hits@50: 0.599491
03:51:13   mr: 730.52
03:51:13   mrr: 0.348255
03:51:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:51:13   Epoch 8 begin
03:52:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:52:56   binary cross entropy: 0.605386
03:55:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:55:33   Epoch 8 end
03:55:33   duration: 5.13 mins
03:55:33   speed: 0.50 batch / sec
03:55:33   ETA: 5.13 mins
03:55:33   max GPU memory: 47460.0 MiB
03:55:33   ------------------------------
03:55:33   average binary cross entropy: 0.510108
03:55:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:55:33   Epoch 9 begin
03:55:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:55:43   binary cross entropy: 0.540093
03:58:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:58:32   binary cross entropy: 0.466295
03:59:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:59:54   Epoch 9 end
03:59:54   duration: 4.34 mins
03:59:54   speed: 0.59 batch / sec
03:59:54   ETA: 0.00 secs
03:59:54   max GPU memory: 47460.0 MiB
03:59:54   ------------------------------
03:59:54   average binary cross entropy: 0.508027
03:59:54   Save checkpoint to model_epoch_10.pth
03:59:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
03:59:54   Evaluate on valid
04:00:41   ------------------------------
04:00:41   ap: 0.987715
04:00:41   auroc: 0.982212
04:00:41   hits@1: 0.300028
04:00:41   hits@10: 0.469573
04:00:41   hits@100: 0.659355
04:00:41   hits@20: 0.525616
04:00:41   hits@3: 0.373762
04:00:41   hits@50: 0.601189
04:00:41   mr: 718.23
04:00:41   mrr: 0.356164
04:00:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:00:41   Epoch 10 begin
04:02:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:02:07   binary cross entropy: 0.516731
04:04:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:04:56   binary cross entropy: 0.520493
04:05:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:05:01   Epoch 10 end
04:05:01   duration: 5.13 mins
04:05:01   speed: 0.50 batch / sec
04:05:01   ETA: 5.13 mins
04:05:01   max GPU memory: 47460.0 MiB
04:05:01   ------------------------------
04:05:01   average binary cross entropy: 0.510368
04:05:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:05:01   Epoch 11 begin
04:07:42   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:07:44   binary cross entropy: 0.414893
04:09:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:09:22   Epoch 11 end
04:09:22   duration: 4.34 mins
04:09:22   speed: 0.59 batch / sec
04:09:22   ETA: 0.00 secs
04:09:22   max GPU memory: 47460.0 MiB
04:09:22   ------------------------------
04:09:22   average binary cross entropy: 0.506385
04:09:22   Save checkpoint to model_epoch_12.pth
04:09:22   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:09:22   Evaluate on valid
04:10:09   ------------------------------
04:10:09   ap: 0.991585
04:10:09   auroc: 0.98843
04:10:09   hits@1: 0.292528
04:10:09   hits@10: 0.46929
04:10:09   hits@100: 0.65893
04:10:09   hits@20: 0.525191
04:10:09   hits@3: 0.371639
04:10:09   hits@50: 0.602321
04:10:09   mr: 717.692
04:10:09   mrr: 0.351558
04:10:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:10:09   Epoch 12 begin
04:11:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:11:18   binary cross entropy: 0.563225
04:14:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:14:07   binary cross entropy: 0.445639
04:14:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:14:30   Epoch 12 end
04:14:30   duration: 5.13 mins
04:14:30   speed: 0.50 batch / sec
04:14:30   ETA: 5.13 mins
04:14:30   max GPU memory: 47460.0 MiB
04:14:30   ------------------------------
04:14:30   average binary cross entropy: 0.501284
04:14:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:14:30   Epoch 13 begin
04:16:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:16:55   binary cross entropy: 0.559966
04:18:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:18:51   Epoch 13 end
04:18:51   duration: 4.34 mins
04:18:51   speed: 0.59 batch / sec
04:18:51   ETA: 0.00 secs
04:18:51   max GPU memory: 47460.0 MiB
04:18:51   ------------------------------
04:18:51   average binary cross entropy: 0.499286
04:18:51   Save checkpoint to model_epoch_14.pth
04:18:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:18:52   Evaluate on valid
04:19:39   ------------------------------
04:19:39   ap: 0.991896
04:19:39   auroc: 0.989092
04:19:39   hits@1: 0.28899
04:19:39   hits@10: 0.46745
04:19:39   hits@100: 0.659355
04:19:39   hits@20: 0.529154
04:19:39   hits@3: 0.367252
04:19:39   hits@50: 0.60317
04:19:39   mr: 723.434
04:19:39   mrr: 0.348383
04:19:39   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:19:39   Epoch 14 begin
04:20:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:20:31   binary cross entropy: 0.512283
04:23:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:23:21   binary cross entropy: 0.51207
04:24:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:24:00   Epoch 14 end
04:24:00   duration: 5.17 mins
04:24:00   speed: 0.50 batch / sec
04:24:00   ETA: 0.00 secs
04:24:00   max GPU memory: 47460.0 MiB
04:24:00   ------------------------------
04:24:00   average binary cross entropy: 0.50472
04:24:00   Save checkpoint to model_epoch_15.pth
04:24:01   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:24:01   Evaluate on valid
04:24:47   ------------------------------
04:24:47   ap: 0.984386
04:24:47   auroc: 0.977364
04:24:47   hits@1: 0.292386
04:24:47   hits@10: 0.470846
04:24:47   hits@100: 0.658081
04:24:47   hits@20: 0.527031
04:24:47   hits@3: 0.372346
04:24:47   hits@50: 0.604585
04:24:47   mr: 719.917
04:24:47   mrr: 0.351612
04:24:47   Load checkpoint from model_epoch_10.pth
04:24:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:24:48   Evaluate on valid
04:25:35   ------------------------------
04:25:35   ap: 0.988088
04:25:35   auroc: 0.982578
04:25:35   hits@1: 0.300028
04:25:35   hits@10: 0.469573
04:25:35   hits@100: 0.659355
04:25:35   hits@20: 0.525616
04:25:35   hits@3: 0.373762
04:25:35   hits@50: 0.601189
04:25:35   mr: 718.23
04:25:35   mrr: 0.356164
04:25:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
04:25:35   Evaluate on test
04:27:09   ------------------------------
04:27:09   ap: 0.990202
04:27:09   auroc: 0.986007
04:27:09   hits@1: 0.292666
04:27:09   hits@10: 0.467017
04:27:09   hits@100: 0.660874
04:27:09   hits@20: 0.524826
04:27:09   hits@3: 0.366009
04:27:09   hits@50: 0.606469
04:27:09   mr: 733.133
04:27:09   mrr: 0.350399
