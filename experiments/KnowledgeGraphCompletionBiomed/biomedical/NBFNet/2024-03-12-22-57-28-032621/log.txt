22:57:28   Working directory: /home/icb/svitlana.oleshko/NBFNet/experiments/KnowledgeGraphCompletionBiomed/biomedical/NBFNet/2024-03-12-22-57-28-032621
22:57:28   Input Seed: 1237
22:57:28   Set Seed: 1237
22:57:28   Config file: config/knowledge_graph/synleth/synleth_trans_5layers_threshold_09.yaml
22:57:28   {'dataset': {'class': 'biomedical',
             'include_factgraph': True,
             'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/'},
 'engine': {'batch_size': 64, 'gpus': [0]},
 'metric': 'mrr',
 'optimizer': {'class': 'Adam', 'lr': 0.005},
 'output_dir': '/home/icb/svitlana.oleshko/NBFNet/experiments',
 'task': {'adversarial_temperature': 0.5,
          'class': 'KnowledgeGraphCompletionBiomed',
          'conditional_probability': True,
          'criterion': 'bce',
          'full_batch_eval': True,
          'heterogeneous_evaluation': True,
          'heterogeneous_negative': True,
          'model': {'aggregate_func': 'pna',
                    'class': 'NBFNet',
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'train': {'num_epoch': 15}}
22:57:29   biomedical(
  #entity: 42547
  #relation: 32
  #triplet: 413118
)
22:57:29   #train: 8770, #valid: 3172, #test: 6254
22:57:29   Preprocess training set
22:57:31   {'batch_size': 64,
 'class': 'core.Engine',
 'gpus': [0],
 'gradient_interval': 1,
 'log_interval': 100,
 'logger': 'logging',
 'num_worker': 0,
 'optimizer': {'amsgrad': False,
               'betas': (0.9, 0.999),
               'capturable': False,
               'class': 'optim.Adam',
               'differentiable': False,
               'eps': 1e-08,
               'foreach': None,
               'fused': None,
               'lr': 0.005,
               'maximize': False,
               'weight_decay': 0},
 'scheduler': None,
 'task': {'adversarial_temperature': 0.5,
          'class': 'tasks.KnowledgeGraphCompletionBiomed',
          'criterion': 'bce',
          'fact_ratio': None,
          'filtered_ranking': True,
          'full_batch_eval': True,
          'margin': 6,
          'metric': ('mr', 'mrr', 'hits@1', 'hits@3', 'hits@10', 'hits@100',
                     'hits@20', 'hits@50', 'auroc', 'ap'),
          'model': {'activation': 'relu',
                    'aggregate_func': 'pna',
                    'class': 'model.NBFNet',
                    'concat_hidden': False,
                    'dependent': True,
                    'hidden_dims': [32, 32, 32, 32, 32],
                    'input_dim': 32,
                    'layer_norm': True,
                    'message_func': 'distmult',
                    'num_beam': 10,
                    'num_mlp_layer': 2,
                    'num_relation': tensor(32),
                    'path_topk': 10,
                    'remove_one_hop': False,
                    'short_cut': True,
                    'symmetric': True},
          'num_negative': 64,
          'sample_weight': False,
          'strict_negative': True},
 'test_set': {'class': 'dataset.Subset',
              'dataset': {'class': 'datasets.biomedical',
                          'fact_as_train': False,
                          'files': None,
                          'include_factgraph': True,
                          'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                          'verbose': 1},
              'indices': range(406864, 413118)},
 'train_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(394922, 403692)},
 'valid_set': {'class': 'dataset.Subset',
               'dataset': {'class': 'datasets.biomedical',
                           'fact_as_train': False,
                           'files': None,
                           'include_factgraph': True,
                           'path': '/home/icb/svitlana.oleshko/KR4SL_thr030/data/transductive_noRev_thr/',
                           'verbose': 1},
               'indices': range(403692, 406864)}}
22:57:31   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:57:31   Epoch 0 begin
22:57:40   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
22:57:40   binary cross entropy: 0.687348
23:00:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:00:27   binary cross entropy: 0.491868
23:01:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:01:27   Epoch 0 end
23:01:27   duration: 3.92 mins
23:01:27   speed: 0.59 batch / sec
23:01:27   ETA: 3.92 mins
23:01:27   max GPU memory: 47432.0 MiB
23:01:27   ------------------------------
23:01:27   average binary cross entropy: 0.567667
23:01:27   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:01:27   Epoch 1 begin
23:03:13   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:03:14   binary cross entropy: 0.499068
23:05:18   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:05:18   Epoch 1 end
23:05:18   duration: 3.85 mins
23:05:18   speed: 0.60 batch / sec
23:05:18   ETA: 0.00 secs
23:05:18   max GPU memory: 47432.0 MiB
23:05:19   ------------------------------
23:05:19   average binary cross entropy: 0.520352
23:05:19   Save checkpoint to model_epoch_2.pth
23:05:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:05:19   Evaluate on valid
23:06:02   ------------------------------
23:06:02   ap: 0.981277
23:06:02   auroc: 0.974769
23:06:02   hits@1: 0.287201
23:06:02   hits@10: 0.480927
23:06:02   hits@100: 0.672762
23:06:02   hits@20: 0.540668
23:06:02   hits@3: 0.366173
23:06:02   hits@50: 0.6157
23:06:02   mr: 752.55
23:06:02   mrr: 0.349338
23:06:02   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:06:02   Epoch 2 begin
23:06:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:06:45   binary cross entropy: 0.474983
23:09:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:33   binary cross entropy: 0.495981
23:09:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:53   Epoch 2 end
23:09:53   duration: 4.59 mins
23:09:53   speed: 0.50 batch / sec
23:09:53   ETA: 4.59 mins
23:09:53   max GPU memory: 47456.2 MiB
23:09:53   ------------------------------
23:09:53   average binary cross entropy: 0.513141
23:09:53   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:09:53   Epoch 3 begin
23:12:20   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:12:21   binary cross entropy: 0.467704
23:13:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:45   Epoch 3 end
23:13:45   duration: 3.86 mins
23:13:45   speed: 0.60 batch / sec
23:13:45   ETA: 0.00 secs
23:13:45   max GPU memory: 47456.2 MiB
23:13:45   ------------------------------
23:13:45   average binary cross entropy: 0.499214
23:13:45   Save checkpoint to model_epoch_4.pth
23:13:45   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:13:45   Evaluate on valid
23:14:28   ------------------------------
23:14:28   ap: 0.981473
23:14:28   auroc: 0.972686
23:14:28   hits@1: 0.282314
23:14:28   hits@10: 0.486602
23:14:28   hits@100: 0.67954
23:14:28   hits@20: 0.543506
23:14:28   hits@3: 0.367749
23:14:28   hits@50: 0.622163
23:14:28   mr: 711.63
23:14:28   mrr: 0.347805
23:14:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:14:28   Epoch 4 begin
23:15:50   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:15:51   binary cross entropy: 0.521743
23:18:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:18:19   Epoch 4 end
23:18:19   duration: 4.57 mins
23:18:19   speed: 0.50 batch / sec
23:18:19   ETA: 4.57 mins
23:18:19   max GPU memory: 47456.2 MiB
23:18:19   ------------------------------
23:18:19   average binary cross entropy: 0.494516
23:18:19   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:18:19   Epoch 5 begin
23:18:37   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:18:38   binary cross entropy: 0.445075
23:21:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:21:26   binary cross entropy: 0.450016
23:22:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:22:10   Epoch 5 end
23:22:10   duration: 3.85 mins
23:22:10   speed: 0.60 batch / sec
23:22:10   ETA: 0.00 secs
23:22:10   max GPU memory: 47456.2 MiB
23:22:10   ------------------------------
23:22:10   average binary cross entropy: 0.493107
23:22:10   Save checkpoint to model_epoch_6.pth
23:22:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:22:10   Evaluate on valid
23:22:52   ------------------------------
23:22:52   ap: 0.987816
23:22:52   auroc: 0.984261
23:22:52   hits@1: 0.315889
23:22:52   hits@10: 0.501576
23:22:52   hits@100: 0.686633
23:22:52   hits@20: 0.554067
23:22:52   hits@3: 0.396122
23:22:52   hits@50: 0.629887
23:22:52   mr: 680.177
23:22:52   mrr: 0.376729
23:22:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:22:52   Epoch 6 begin
23:24:54   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:24:55   binary cross entropy: 0.550032
23:26:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:26:44   Epoch 6 end
23:26:44   duration: 4.56 mins
23:26:44   speed: 0.50 batch / sec
23:26:44   ETA: 4.56 mins
23:26:44   max GPU memory: 47456.2 MiB
23:26:44   ------------------------------
23:26:44   average binary cross entropy: 0.498734
23:26:44   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:26:44   Epoch 7 begin
23:27:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:27:43   binary cross entropy: 0.529535
23:30:30   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:30:31   binary cross entropy: 0.488237
23:30:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:30:35   Epoch 7 end
23:30:35   duration: 3.85 mins
23:30:35   speed: 0.60 batch / sec
23:30:35   ETA: 0.00 secs
23:30:35   max GPU memory: 47456.2 MiB
23:30:35   ------------------------------
23:30:35   average binary cross entropy: 0.495703
23:30:35   Save checkpoint to model_epoch_8.pth
23:30:35   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:30:35   Evaluate on valid
23:31:17   ------------------------------
23:31:17   ap: 0.987895
23:31:17   auroc: 0.983635
23:31:17   hits@1: 0.307219
23:31:17   hits@10: 0.498897
23:31:17   hits@100: 0.686475
23:31:17   hits@20: 0.551545
23:31:17   hits@3: 0.388241
23:31:17   hits@50: 0.630832
23:31:17   mr: 694.646
23:31:17   mrr: 0.369141
23:31:17   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:31:17   Epoch 8 begin
23:33:58   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:34:00   binary cross entropy: 0.529319
23:35:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:35:08   Epoch 8 end
23:35:08   duration: 4.56 mins
23:35:08   speed: 0.50 batch / sec
23:35:08   ETA: 4.56 mins
23:35:08   max GPU memory: 47456.2 MiB
23:35:08   ------------------------------
23:35:08   average binary cross entropy: 0.491806
23:35:08   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:35:08   Epoch 9 begin
23:36:46   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:36:47   binary cross entropy: 0.460452
23:38:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:38:59   Epoch 9 end
23:38:59   duration: 3.85 mins
23:38:59   speed: 0.60 batch / sec
23:38:59   ETA: 0.00 secs
23:38:59   max GPU memory: 47456.2 MiB
23:38:59   ------------------------------
23:38:59   average binary cross entropy: 0.483253
23:38:59   Save checkpoint to model_epoch_10.pth
23:38:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:38:59   Evaluate on valid
23:39:41   ------------------------------
23:39:41   ap: 0.982998
23:39:41   auroc: 0.97712
23:39:41   hits@1: 0.321248
23:39:41   hits@10: 0.499842
23:39:41   hits@100: 0.694515
23:39:41   hits@20: 0.556431
23:39:41   hits@3: 0.397541
23:39:41   hits@50: 0.630517
23:39:41   mr: 684.569
23:39:41   mrr: 0.379809
23:39:41   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:39:41   Epoch 10 begin
23:40:15   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:40:16   binary cross entropy: 0.533311
23:43:03   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:43:05   binary cross entropy: 0.568577
23:43:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:43:32   Epoch 10 end
23:43:32   duration: 4.55 mins
23:43:32   speed: 0.51 batch / sec
23:43:32   ETA: 4.55 mins
23:43:32   max GPU memory: 47456.2 MiB
23:43:32   ------------------------------
23:43:32   average binary cross entropy: 0.481449
23:43:32   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:43:32   Epoch 11 begin
23:45:52   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:45:53   binary cross entropy: 0.458184
23:47:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:47:25   Epoch 11 end
23:47:25   duration: 3.88 mins
23:47:25   speed: 0.59 batch / sec
23:47:25   ETA: 0.00 secs
23:47:25   max GPU memory: 47456.2 MiB
23:47:25   ------------------------------
23:47:25   average binary cross entropy: 0.47751
23:47:25   Save checkpoint to model_epoch_12.pth
23:47:25   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:47:25   Evaluate on valid
23:48:09   ------------------------------
23:48:09   ap: 0.987132
23:48:09   auroc: 0.983306
23:48:09   hits@1: 0.324716
23:48:09   hits@10: 0.508039
23:48:09   hits@100: 0.693411
23:48:09   hits@20: 0.559111
23:48:09   hits@3: 0.402112
23:48:09   hits@50: 0.634773
23:48:09   mr: 676.222
23:48:09   mrr: 0.384473
23:48:09   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:48:09   Epoch 12 begin
23:49:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:49:25   binary cross entropy: 0.476849
23:52:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:52:00   Epoch 12 end
23:52:00   duration: 4.58 mins
23:52:00   speed: 0.50 batch / sec
23:52:00   ETA: 4.58 mins
23:52:00   max GPU memory: 47456.2 MiB
23:52:00   ------------------------------
23:52:00   average binary cross entropy: 0.484353
23:52:00   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:52:00   Epoch 13 begin
23:52:10   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:52:12   binary cross entropy: 0.480202
23:54:59   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:55:00   binary cross entropy: 0.49885
23:55:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:55:51   Epoch 13 end
23:55:51   duration: 3.85 mins
23:55:51   speed: 0.60 batch / sec
23:55:51   ETA: 0.00 secs
23:55:51   max GPU memory: 47456.2 MiB
23:55:51   ------------------------------
23:55:51   average binary cross entropy: 0.477227
23:55:51   Save checkpoint to model_epoch_14.pth
23:55:51   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:55:51   Evaluate on valid
23:56:33   ------------------------------
23:56:33   ap: 0.983795
23:56:33   auroc: 0.979364
23:56:33   hits@1: 0.331179
23:56:33   hits@10: 0.504256
23:56:33   hits@100: 0.693253
23:56:33   hits@20: 0.558323
23:56:33   hits@3: 0.407787
23:56:33   hits@50: 0.636665
23:56:33   mr: 677.652
23:56:33   mrr: 0.388873
23:56:33   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:56:33   Epoch 14 begin
23:58:28   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
23:58:29   binary cross entropy: 0.410574
00:00:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:00:24   Epoch 14 end
00:00:24   duration: 4.54 mins
00:00:24   speed: 0.51 batch / sec
00:00:24   ETA: 0.00 secs
00:00:24   max GPU memory: 47456.2 MiB
00:00:24   ------------------------------
00:00:24   average binary cross entropy: 0.474609
00:00:24   Save checkpoint to model_epoch_15.pth
00:00:24   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:00:24   Evaluate on valid
00:01:06   ------------------------------
00:01:06   ap: 0.985752
00:01:06   auroc: 0.981501
00:01:06   hits@1: 0.331494
00:01:06   hits@10: 0.509143
00:01:06   hits@100: 0.690574
00:01:06   hits@20: 0.560845
00:01:06   hits@3: 0.411885
00:01:06   hits@50: 0.635404
00:01:06   mr: 672.926
00:01:06   mrr: 0.389899
00:01:06   Load checkpoint from model_epoch_15.pth
00:01:06   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:01:06   Evaluate on valid
00:01:48   ------------------------------
00:01:48   ap: 0.985194
00:01:48   auroc: 0.981243
00:01:48   hits@1: 0.331494
00:01:48   hits@10: 0.509143
00:01:48   hits@100: 0.690574
00:01:48   hits@20: 0.560845
00:01:48   hits@3: 0.411885
00:01:48   hits@50: 0.635404
00:01:48   mr: 672.926
00:01:48   mrr: 0.389899
00:01:48   >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
00:01:48   Evaluate on test
00:03:11   ------------------------------
00:03:11   ap: 0.986304
00:03:11   auroc: 0.983133
00:03:11   hits@1: 0.333547
00:03:11   hits@10: 0.511273
00:03:11   hits@100: 0.699952
00:03:11   hits@20: 0.566677
00:03:11   hits@3: 0.408618
00:03:11   hits@50: 0.64063
00:03:11   mr: 670.261
00:03:11   mrr: 0.391566
